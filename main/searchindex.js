Search.setIndex({"docnames": ["getting-started/installation", "getting-started/tutorials/01-vector-add", "getting-started/tutorials/02-fused-softmax", "getting-started/tutorials/03-matrix-multiplication", "getting-started/tutorials/04-low-memory-dropout", "getting-started/tutorials/05-layer-norm", "getting-started/tutorials/06-fused-attention", "getting-started/tutorials/07-math-functions", "getting-started/tutorials/08-experimental-block-pointer", "getting-started/tutorials/index", "getting-started/tutorials/sg_execution_times", "index", "programming-guide/chapter-1/introduction", "programming-guide/chapter-2/related-work", "python-api/generated/triton.Config", "python-api/generated/triton.autotune", "python-api/generated/triton.heuristics", "python-api/generated/triton.jit", "python-api/generated/triton.language.abs", "python-api/generated/triton.language.arange", "python-api/generated/triton.language.argmax", "python-api/generated/triton.language.argmin", "python-api/generated/triton.language.atomic_add", "python-api/generated/triton.language.atomic_cas", "python-api/generated/triton.language.atomic_max", "python-api/generated/triton.language.atomic_min", "python-api/generated/triton.language.atomic_xchg", "python-api/generated/triton.language.broadcast_to", "python-api/generated/triton.language.cos", "python-api/generated/triton.language.dot", "python-api/generated/triton.language.exp", "python-api/generated/triton.language.load", "python-api/generated/triton.language.log", "python-api/generated/triton.language.max", "python-api/generated/triton.language.maximum", "python-api/generated/triton.language.min", "python-api/generated/triton.language.minimum", "python-api/generated/triton.language.multiple_of", "python-api/generated/triton.language.num_programs", "python-api/generated/triton.language.program_id", "python-api/generated/triton.language.rand", "python-api/generated/triton.language.randint", "python-api/generated/triton.language.randint4x", "python-api/generated/triton.language.randn", "python-api/generated/triton.language.ravel", "python-api/generated/triton.language.reduce", "python-api/generated/triton.language.reshape", "python-api/generated/triton.language.sigmoid", "python-api/generated/triton.language.sin", "python-api/generated/triton.language.softmax", "python-api/generated/triton.language.sqrt", "python-api/generated/triton.language.store", "python-api/generated/triton.language.sum", "python-api/generated/triton.language.where", "python-api/generated/triton.language.xor_sum", "python-api/generated/triton.language.zeros", "python-api/generated/triton.testing.Benchmark", "python-api/generated/triton.testing.do_bench", "python-api/generated/triton.testing.perf_report", "python-api/triton", "python-api/triton.language", "python-api/triton.testing"], "filenames": ["getting-started/installation.rst", "getting-started/tutorials/01-vector-add.rst", "getting-started/tutorials/02-fused-softmax.rst", "getting-started/tutorials/03-matrix-multiplication.rst", "getting-started/tutorials/04-low-memory-dropout.rst", "getting-started/tutorials/05-layer-norm.rst", "getting-started/tutorials/06-fused-attention.rst", "getting-started/tutorials/07-math-functions.rst", "getting-started/tutorials/08-experimental-block-pointer.rst", "getting-started/tutorials/index.rst", "getting-started/tutorials/sg_execution_times.rst", "index.rst", "programming-guide/chapter-1/introduction.rst", "programming-guide/chapter-2/related-work.rst", "python-api/generated/triton.Config.rst", "python-api/generated/triton.autotune.rst", "python-api/generated/triton.heuristics.rst", "python-api/generated/triton.jit.rst", "python-api/generated/triton.language.abs.rst", "python-api/generated/triton.language.arange.rst", "python-api/generated/triton.language.argmax.rst", "python-api/generated/triton.language.argmin.rst", "python-api/generated/triton.language.atomic_add.rst", "python-api/generated/triton.language.atomic_cas.rst", "python-api/generated/triton.language.atomic_max.rst", "python-api/generated/triton.language.atomic_min.rst", "python-api/generated/triton.language.atomic_xchg.rst", "python-api/generated/triton.language.broadcast_to.rst", "python-api/generated/triton.language.cos.rst", "python-api/generated/triton.language.dot.rst", "python-api/generated/triton.language.exp.rst", "python-api/generated/triton.language.load.rst", "python-api/generated/triton.language.log.rst", "python-api/generated/triton.language.max.rst", "python-api/generated/triton.language.maximum.rst", "python-api/generated/triton.language.min.rst", "python-api/generated/triton.language.minimum.rst", "python-api/generated/triton.language.multiple_of.rst", "python-api/generated/triton.language.num_programs.rst", "python-api/generated/triton.language.program_id.rst", "python-api/generated/triton.language.rand.rst", "python-api/generated/triton.language.randint.rst", "python-api/generated/triton.language.randint4x.rst", "python-api/generated/triton.language.randn.rst", "python-api/generated/triton.language.ravel.rst", "python-api/generated/triton.language.reduce.rst", "python-api/generated/triton.language.reshape.rst", "python-api/generated/triton.language.sigmoid.rst", "python-api/generated/triton.language.sin.rst", "python-api/generated/triton.language.softmax.rst", "python-api/generated/triton.language.sqrt.rst", "python-api/generated/triton.language.store.rst", "python-api/generated/triton.language.sum.rst", "python-api/generated/triton.language.where.rst", "python-api/generated/triton.language.xor_sum.rst", "python-api/generated/triton.language.zeros.rst", "python-api/generated/triton.testing.Benchmark.rst", "python-api/generated/triton.testing.do_bench.rst", "python-api/generated/triton.testing.perf_report.rst", "python-api/triton.rst", "python-api/triton.language.rst", "python-api/triton.testing.rst"], "titles": ["Installation", "Vector Addition", "Fused Softmax", "Matrix Multiplication", "Low-Memory Dropout", "Layer Normalization", "Fused Attention", "Libdevice (<cite>tl.math</cite>) function", "Block Pointer (Experimental)", "Tutorials", "Computation times", "Welcome to Triton\u2019s documentation!", "Introduction", "Related Work", "triton.Config", "triton.autotune", "triton.heuristics", "triton.jit", "triton.language.abs", "triton.language.arange", "triton.language.argmax", "triton.language.argmin", "triton.language.atomic_add", "triton.language.atomic_cas", "triton.language.atomic_max", "triton.language.atomic_min", "triton.language.atomic_xchg", "triton.language.broadcast_to", "triton.language.cos", "triton.language.dot", "triton.language.exp", "triton.language.load", "triton.language.log", "triton.language.max", "triton.language.maximum", "triton.language.min", "triton.language.minimum", "triton.language.multiple_of", "triton.language.num_programs", "triton.language.program_id", "triton.language.rand", "triton.language.randint", "triton.language.randint4x", "triton.language.randn", "triton.language.ravel", "triton.language.reduce", "triton.language.reshape", "triton.language.sigmoid", "triton.language.sin", "triton.language.softmax", "triton.language.sqrt", "triton.language.store", "triton.language.sum", "triton.language.where", "triton.language.xor_sum", "triton.language.zeros", "triton.testing.Benchmark", "triton.testing.do_bench", "triton.testing.perf_report", "triton", "triton.language", "triton.testing"], "terms": {"you": [0, 1, 2, 3, 4, 5, 7, 8, 9, 12, 15, 41, 53], "can": [0, 1, 2, 3, 4, 5, 7, 8, 12, 13, 15, 31, 51, 58], "latest": 0, "stabl": 0, "releas": [0, 5, 12], "triton": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13], "pip": [0, 9], "wheel": 0, "ar": [0, 1, 2, 3, 4, 5, 8, 12, 13, 14, 15, 17, 31, 37, 51, 53, 56], "avail": [0, 4, 7, 12, 13], "cpython": 0, "3": [0, 1, 2, 3, 4, 5, 6, 8, 13], "6": [0, 1, 3, 5, 8], "9": [0, 1, 2, 3, 4, 5, 8], "pypi": [0, 5], "7": [0, 1, 3, 5, 13], "And": [0, 3], "nightli": 0, "u": [0, 1, 2, 40], "pre": [0, 6, 12], "run": [0, 1, 2, 3, 4, 5, 6, 7, 8, 11, 13, 15, 17, 58], "follow": [0, 2, 3, 5, 8, 11, 12, 13], "command": 0, "git": 0, "clone": [0, 5, 6], "http": [0, 4, 5, 6, 7], "github": [0, 5], "com": [0, 5, 7], "openai": 0, "cd": [0, 9], "cmake": 0, "build": [0, 3], "time": [0, 1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 15, 41], "depend": [0, 9, 13, 53], "e": [0, 2, 3, 4, 5, 8, 9, 12, 13, 55], "note": [0, 1, 2, 3, 4, 6, 8, 13, 15, 17, 53], "llvm": [0, 13], "11": [0, 1, 3, 5, 8], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17, 31, 41, 42, 51, 53, 56], "present": 0, "your": [0, 1, 11], "system": [0, 3, 12, 13], "setup": [0, 5], "py": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10], "script": [0, 1, 2, 3, 4, 5, 6, 7, 8], "download": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], "offici": 0, "llvm11": 0, "static": [0, 12, 13], "librari": [0, 3, 12, 13], "link": 0, "against": [0, 1, 2, 3, 5, 8, 11], "test": [0, 1, 5, 6, 11], "unit": [0, 12], "pytest": [0, 6], "v": [0, 5, 6], "benchmark": [0, 6, 58], "bench": [0, 15], "m": [0, 1, 2, 3, 5, 6, 8, 12], "plot": [0, 1, 2, 3, 56], "result": [0, 1, 2, 12, 13], "dir": 0, "tmp": 0, "go": [1, 2, 3, 4, 5, 6, 7, 8, 13], "end": [1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 19], "full": [1, 2, 3, 4, 5, 6, 7, 8], "exampl": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14], "code": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 15, 16], "In": [1, 2, 3, 4, 5, 7, 8, 13], "thi": [1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 14, 15, 16, 17, 42, 56], "tutori": [1, 2, 3, 4, 5, 8, 11], "write": [1, 2, 3, 4, 5, 6, 8, 9, 11, 13], "simpl": [1, 2, 3, 4], "us": [1, 2, 3, 4, 5, 8, 12, 13, 14, 15, 16, 17, 41, 53, 56, 58], "do": [1, 2, 3, 4, 5, 6, 8, 12, 13, 15, 31, 51], "so": [1, 2, 3, 4, 5, 8, 13], "learn": [1, 2, 3, 4, 5, 8, 11, 12, 13], "about": [1, 2, 3, 4, 5, 11], "The": [1, 2, 3, 4, 5, 7, 8, 12, 13, 22, 23, 24, 25, 26, 27, 29, 38, 39, 40, 41, 42, 43, 51, 53, 58], "basic": [1, 9, 13], "program": [1, 2, 3, 4, 5, 8, 11, 12, 38, 39], "model": [1, 5, 12, 13, 15], "jit": [1, 2, 3, 4, 5, 6, 7, 8, 15, 16, 45], "decor": [1, 3, 15, 16, 17], "which": [1, 2, 3, 4, 8, 12, 13, 15, 20, 21, 31, 33, 35, 45, 51, 52, 54, 56], "defin": [1, 2, 3, 13, 31, 51], "best": [1, 12], "practic": [1, 2, 3, 12], "valid": 1, "custom": [1, 2, 3, 11], "op": [1, 2], "nativ": [1, 2, 3, 8], "refer": [1, 6, 7, 8], "implement": [1, 2, 3, 4, 5, 6, 8, 12, 13], "import": [1, 2, 3, 4, 5, 6, 7, 8, 12, 13], "torch": [1, 2, 3, 4, 5, 6, 7, 8], "languag": [1, 2, 3, 4, 5, 6, 7, 8, 11, 12], "tl": [1, 2, 3, 4, 5, 6, 8, 9, 10, 55], "def": [1, 2, 3, 4, 5, 6, 7, 8, 15, 16], "add_kernel": 1, "x_ptr": [1, 4, 7, 15, 16], "pointer": [1, 2, 4, 5, 6, 9, 10, 17, 22, 23, 24, 25, 26, 31, 51], "first": [1, 3, 4, 5, 8, 11, 13, 29, 34, 36], "input": [1, 2, 3, 4, 5, 7, 8, 13, 15, 16, 18, 20, 21, 27, 28, 29, 30, 32, 33, 34, 35, 36, 37, 44, 45, 46, 47, 48, 49, 50, 52, 54], "y_ptr": [1, 7], "second": [1, 2, 3, 4, 5, 6, 7, 8, 13, 29, 34, 36], "output_ptr": [1, 2, 4], "output": [1, 2, 3, 4, 5, 6, 7, 8], "n_element": [1, 4, 7], "size": [1, 2, 4, 5, 7, 13], "block_siz": [1, 2, 4, 5, 7, 13, 15, 16], "constexpr": [1, 2, 3, 4, 5, 6, 7, 8, 40, 41, 42, 43], "number": [1, 2, 3, 4, 5, 13, 14, 15, 38, 40, 41, 42, 43], "element": [1, 2, 3, 4, 5, 8, 18, 20, 21, 28, 30, 31, 32, 33, 34, 35, 36, 45, 47, 48, 49, 50, 51, 52, 53, 54, 56], "each": [1, 2, 3, 4, 5, 8, 12, 13, 14, 16], "should": [1, 3, 5, 8, 12, 13, 14, 20, 21, 31, 33, 35, 45, 51, 52, 54, 56], "process": [1, 12, 13], "shape": [1, 2, 3, 4, 5, 6, 8, 13, 27, 31, 46, 51, 53, 55], "valu": [1, 2, 3, 4, 6, 7, 8, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 30, 31, 32, 33, 35, 37, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 58], "There": 1, "multipl": [1, 4, 5, 8, 9, 10, 12, 13, 14, 15, 37, 41], "differ": [1, 2, 3, 4, 7, 8, 12, 13, 15, 56], "data": [1, 3, 4, 5, 6, 7, 8, 12, 13, 22, 23, 24, 25, 26, 31, 51, 53, 55], "we": [1, 2, 3, 4, 5, 7, 8, 12, 13], "identifi": 1, "here": [1, 2, 3, 5, 6, 8], "pid": [1, 3, 4, 5, 7, 8], "program_id": [1, 2, 3, 4, 5, 6, 7, 8], "axi": [1, 2, 3, 4, 5, 6, 7, 8, 20, 21, 33, 35, 38, 39, 45, 52, 54, 56], "0": [1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 13, 38, 39, 40, 43, 55], "1d": [1, 2, 3, 8], "launch": [1, 2, 3, 8, 38, 39], "grid": [1, 2, 3, 4, 5, 6, 7, 8, 38, 39], "offset": [1, 4, 5, 6, 7, 8, 40, 41, 42, 43], "from": [1, 2, 3, 4, 6, 7, 8, 12, 13, 31, 53], "initi": [1, 3, 6], "For": [1, 3, 5, 7, 8, 12, 13, 14], "instanc": [1, 2, 3, 4, 5, 12, 14, 38, 39], "had": 1, "length": [1, 6], "256": [1, 2, 3, 5, 8, 14], "64": [1, 3, 5, 6, 8], "would": [1, 2, 4], "access": [1, 8, 12, 13, 17, 31, 51], "128": [1, 2, 3, 5, 6, 8, 15], "192": 1, "list": [1, 3, 15, 16, 56, 58], "block_start": [1, 4, 7], "arang": [1, 2, 3, 4, 5, 6, 7], "creat": [1, 2, 3, 5, 8, 12], "mask": [1, 2, 3, 4, 5, 7, 8, 22, 24, 25, 26, 31, 51, 53], "guard": [1, 2], "memori": [1, 2, 3, 8, 9, 10, 12, 13, 22, 23, 24, 25, 26, 31, 51, 53], "oper": [1, 2, 3, 4, 5, 7, 9, 12, 22, 23, 24, 25, 26, 53], "out": [1, 3, 6, 8, 11, 13, 31, 51], "bound": [1, 2, 3, 8, 13, 31, 51], "load": [1, 2, 3, 4, 5, 6, 7, 13, 53], "x": [1, 2, 3, 4, 5, 7, 8, 13, 18, 28, 30, 32, 34, 36, 44, 47, 48, 49, 50, 53, 56], "y": [1, 2, 3, 5, 13, 34, 36, 53, 56], "dram": [1, 2], "ani": [1, 2, 3, 8, 13, 14, 15, 16, 56], "extra": [1, 3, 8], "case": [1, 2, 3, 12, 13, 16, 22, 23, 24, 25, 26, 31, 51], "block": [1, 2, 3, 4, 6, 9, 10, 12, 13, 15, 16, 18, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 34, 36, 40, 41, 42, 43, 44, 47, 48, 49, 50, 51, 53], "back": [1, 2, 3, 4, 6, 8], "store": [1, 2, 3, 4, 5, 6, 7, 22, 23, 24, 25, 26, 53], "let": [1, 2, 4, 5, 8, 37], "": [1, 2, 4, 5, 8, 13, 42], "also": [1, 2, 3, 4, 5, 7, 12, 13], "declar": 1, "helper": [1, 2], "function": [1, 2, 3, 4, 5, 6, 8, 9, 10, 13, 14, 15, 16, 17, 45, 56, 58], "1": [1, 2, 3, 4, 5, 6, 8, 11, 13, 16, 38, 39, 40, 43], "alloc": [1, 2, 3, 5, 8, 12], "z": [1, 2, 6, 13], "tensor": [1, 2, 3, 4, 5, 7, 8, 12, 13, 15, 20, 21, 27, 29, 31, 33, 34, 35, 36, 44, 45, 51, 52, 53, 54, 55], "2": [1, 2, 3, 4, 5, 6, 7, 8, 11, 13, 14, 16, 38, 39], "enqueu": [1, 2, 5], "abov": [1, 2, 3, 4, 8, 13, 15], "appropri": 1, "add": [1, 4, 10, 22], "need": [1, 2, 3, 4, 5, 8, 41], "prealloc": 1, "empty_lik": [1, 2, 4, 5, 6, 7], "assert": [1, 2, 3, 4, 5, 6, 7, 8], "is_cuda": [1, 7], "numel": [1, 4, 5, 7], "spmd": [1, 12, 13], "denot": [1, 5], "parallel": [1, 2, 3, 4, 5, 11, 12, 13, 14], "It": [1, 3, 4, 5, 9, 11, 13, 15, 17], "analog": 1, "cuda": [1, 2, 3, 4, 5, 6, 7, 8, 12], "either": [1, 38, 39, 53], "tupl": [1, 27, 31, 45, 51, 55], "int": [1, 12, 13, 16, 17, 27, 31, 38, 39, 51, 55], "callabl": [1, 16, 17], "metaparamet": 1, "where": [1, 3, 4, 5, 6, 8, 13, 16, 51], "lambda": [1, 2, 3, 4, 5, 6, 7, 8, 16], "meta": [1, 2, 3, 4, 5, 7, 8, 14, 15, 16], "cdiv": [1, 3, 4, 5, 6, 7, 8], "object": [1, 3, 12, 14, 15, 22, 23, 24, 25, 26], "implicitli": [1, 17, 31, 51], "convert": [1, 3, 8, 17], "its": [1, 2, 3, 8, 13, 15], "ed": [1, 3], "index": [1, 7, 8, 20, 21], "obtain": 1, "gpu": [1, 2, 4, 6, 11, 12, 13, 14, 17], "don": [1, 2], "t": [1, 2, 3, 5, 6, 13, 17], "forget": 1, "pass": [1, 7, 8, 13, 14], "paramet": [1, 3, 8, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 38, 39, 40, 41, 42, 43, 44, 45, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 58], "keyword": [1, 14], "argument": [1, 2, 3, 8, 14, 15, 16, 17, 53, 56], "1024": [1, 3, 4, 5, 6, 7, 15], "return": [1, 2, 3, 4, 5, 6, 8, 15, 19, 20, 21, 22, 23, 24, 25, 26, 29, 31, 33, 35, 38, 39, 40, 41, 42, 43, 44, 52, 53, 54, 55, 58], "handl": [1, 2, 3, 4, 13], "sinc": [1, 2, 3, 5, 8], "synchron": [1, 12], "hasn": 1, "been": [1, 12, 13], "call": [1, 3, 7, 13, 14, 17, 41], "still": [1, 2, 3, 8, 13], "asynchron": [1, 12], "point": [1, 13, 42], "now": [1, 3, 5, 6, 8], "wise": [1, 2, 5, 6, 18, 28, 30, 31, 32, 34, 36, 47, 48, 49, 50, 51], "sum": [1, 2, 5, 6, 54], "two": [1, 2, 3, 8, 13, 15, 16, 19, 29, 45], "correct": [1, 6, 7], "manual_se": [1, 2, 3, 6, 7, 8], "98432": [1, 7], "rand": [1, 4, 5, 7], "devic": [1, 2, 3, 5, 6, 7, 8], "output_torch": [1, 7], "output_triton": [1, 7], "print": [1, 3, 4, 6, 7, 8], "f": [1, 2, 3, 6, 7, 8, 13], "maximum": [1, 2, 6, 7, 20, 33], "between": [1, 7, 12], "max": [1, 2, 5, 6, 7, 24], "ab": [1, 7], "3713": 1, "3076": 1, "4940": 1, "6724": 1, "2141": 1, "9733": 1, "seem": [1, 13], "like": [1, 4, 6, 8, 12, 13, 41], "re": [1, 3], "good": [1, 13], "our": [1, 2, 3, 5, 8, 12], "increas": [1, 2, 3, 4, 5, 8], "get": [1, 2, 3, 4, 8, 10], "sens": [1, 12, 13], "how": [1, 2, 3, 5, 8, 11, 12, 16], "doe": [1, 2, 3, 8, 13], "rel": [1, 13], "pytorch": [1, 2, 4, 5], "To": [1, 4, 5, 8, 9, 12, 13, 15], "make": [1, 2, 12, 13], "thing": [1, 4], "easier": [1, 2, 12], "ha": [1, 3, 4, 8, 12, 13, 38, 39], "set": [1, 3, 4, 5, 8, 13], "built": [1, 13], "util": [1, 5, 8], "allow": [1, 2, 8, 12, 13], "concis": [1, 56], "perform": [1, 2, 4, 5, 8, 12, 13, 15, 22, 23, 24, 25, 26], "problem": [1, 8], "perf_report": [1, 2, 3, 5, 6, 56], "x_name": [1, 2, 3, 5, 6, 56], "name": [1, 2, 3, 15, 16, 56], "an": [1, 2, 3, 4, 7, 8, 12, 13, 14, 22, 23, 24, 25, 26, 40, 41, 42, 43], "x_val": [1, 2, 3, 5, 6, 56], "rang": [1, 2, 3, 5, 6, 8, 12, 13], "12": [1, 3, 5], "28": [1, 3, 5, 8], "possibl": [1, 2, 3, 13, 14], "x_log": [1, 56], "true": [1, 2, 3, 5, 6, 29, 53, 57], "logarithm": [1, 32], "line_arg": [1, 2, 3, 5, 6, 56], "provid": [1, 2, 3, 4, 5, 6, 11, 13, 15, 20, 21, 33, 35, 45, 52, 54], "whose": [1, 2, 3, 4, 13, 15, 31], "correspond": [1, 2, 3, 56], "line": [1, 2, 3, 4, 13, 56], "line_v": [1, 2, 3, 5, 6, 56], "line_nam": [1, 2, 3, 5, 6, 56], "label": [1, 2, 3, 56], "style": [1, 2, 3, 5, 6, 56], "blue": [1, 2, 3, 5, 6], "green": [1, 2, 3, 5], "ylabel": [1, 2, 3, 5, 6, 56], "gb": [1, 2, 5], "plot_nam": [1, 2, 3, 5, 6, 56], "file": [1, 2, 3, 10], "save": [1, 2, 3, 6], "arg": [1, 2, 3, 5, 6, 14, 16, 56], "y_name": [1, 2], "dtype": [1, 2, 3, 5, 6, 8, 17, 22, 23, 24, 25, 26, 31, 51, 55], "float32": [1, 2, 3, 4, 5, 6, 8, 29, 40, 43], "quantil": [1, 2, 3, 5, 57], "5": [1, 2, 3, 4, 5, 6, 8, 13], "8": [1, 2, 3, 5, 6, 8, 13, 14, 15, 55], "min_m": [1, 2, 3, 5], "max_m": [1, 2, 3, 5], "do_bench": [1, 2, 3, 5, 6], "gbp": [1, 2, 5], "1e": [1, 2, 3, 5, 6, 8], "print_data": [1, 2, 3, 5, 6], "see": [1, 2, 3, 4, 6, 8, 13], "show_plot": [1, 2, 3], "them": [1, 8], "save_path": [1, 5, 6], "path": 1, "disk": 1, "along": [1, 3, 8, 20, 21, 33, 35, 38, 39, 45, 52, 54], "raw": 1, "csv": 1, "4096": [1, 2, 3, 5, 6], "000000": 1, "8192": [1, 5, 6], "15": [1, 3, 5, 8], "999999": 1, "16384": 1, "31": 1, "32768": 1, "63": [1, 3], "999998": 1, "4": [1, 2, 3, 5, 6, 8, 13, 14, 15, 41], "65536": [1, 5], "127": 1, "999995": 1, "109": 1, "714284": 1, "131072": [1, 19], "219": [1, 3], "428568": 1, "262144": 1, "384": [1, 2, 3], "000001": [1, 2], "524288": 1, "614": 1, "400016": 1, "1048576": 1, "768": [1, 2, 3], "000002": 1, "819": [1, 2], "200021": [1, 2], "2097152": 1, "1023": 1, "999964": 1, "10": [1, 3, 4, 5, 6, 7, 8, 40, 41, 42, 43], "4194304": 1, "1228": 1, "800031": 1, "8388608": 1, "1424": 1, "695621": 1, "1404": 1, "342820": 1, "16777216": 1, "1560": 1, "380965": 1, "13": [1, 3, 5, 6, 8], "33554432": 1, "1631": 1, "601649": 1, "1624": 1, "859540": 1, "14": [1, 3, 5, 6], "67108864": 1, "1673": 1, "259578": 1, "1669": 1, "706983": 1, "134217728": 1, "1691": 1, "251649": 1, "1685": 1, "813499": 1, "total": [1, 2, 3, 4, 5, 6, 7, 8, 10], "minut": [1, 2, 3, 4, 5, 6, 7, 8], "25": [1, 3, 5, 6, 8, 10, 57], "445": [1, 10], "python": [1, 2, 3, 4, 5, 6, 7, 8, 9, 15, 16, 17], "sourc": [1, 2, 3, 4, 5, 6, 7, 8, 9, 13], "01": [1, 3, 10], "jupyt": [1, 2, 3, 4, 5, 6, 7, 8, 9], "notebook": [1, 2, 3, 4, 5, 6, 7, 8, 9], "ipynb": [1, 2, 3, 4, 5, 6, 7, 8], "galleri": [1, 2, 3, 4, 5, 6, 7, 8, 9], "gener": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 40, 41, 42, 43, 56], "sphinx": [1, 2, 3, 4, 5, 6, 7, 8, 9], "significantli": 2, "faster": [2, 5, 41], "than": [2, 3, 5, 12, 13, 19, 41, 56], "particular": [2, 3, 8], "class": [2, 5, 6, 12, 13, 14, 56], "matric": [2, 3, 8], "those": 2, "row": [2, 3, 4, 5, 6, 8], "fit": 2, "sram": [2, 3, 5, 6], "benefit": [2, 12, 13], "fusion": [2, 13], "bandwidth": 2, "reduct": [2, 5, 20, 21, 33, 35, 45, 52, 54], "elementwis": 2, "addit": [2, 9, 10, 12], "education": 2, "valuabl": 2, "won": 2, "veri": [2, 3, 4, 13], "far": 2, "consid": 2, "instead": [2, 53], "numer": [2, 5, 12], "stabil": [2, 5], "naive_softmax": 2, "subtract": [2, 5], "order": [2, 3, 8, 9, 13], "avoid": [2, 5, 15, 53], "overflow": 2, "invari": [2, 13], "shift": 2, "read": [2, 3, 9], "mn": 2, "x_max": 2, "dim": [2, 5, 6, 13], "none": [2, 3, 5, 6, 14, 15, 17, 22, 24, 25, 26, 31, 51, 56, 57], "exp": [2, 6], "denomin": [2, 5], "ret": 2, "5mn": 2, "2m": 2, "wrote": 2, "3mn": 2, "when": [2, 3, 4, 5, 8, 12, 13, 14, 15, 17, 53], "naiv": [2, 4], "r": 2, "n": [2, 3, 5, 8, 12, 43], "requir": [2, 4, 13], "obvious": 2, "wast": 2, "d": [2, 4, 6, 15, 17], "prefer": 2, "have": [2, 4, 5, 8, 12, 13, 17, 29, 53, 56], "onli": [2, 3, 4, 5, 6, 8, 12, 13, 17], "onc": [2, 12, 13], "all": [2, 3, 4, 5, 7, 9, 12, 13, 15, 20, 21, 33, 35, 37, 45, 52, 54, 56], "necessari": [2, 8], "chip": [2, 6], "byte": 2, "could": [2, 13, 31, 51], "expect": [2, 22, 23, 24, 25, 26], "theoret": 2, "speed": 2, "up": [2, 5, 8], "4x": 2, "8mn": 2, "4m": 2, "2mn": 2, "flag": 2, "aim": [2, 11], "kind": 2, "automat": [2, 3, 7, 12, 13, 14], "later": [2, 3, 13], "ideal": 2, "work": [2, 4, 6, 11, 12], "matrix": [2, 4, 8, 9, 10, 12, 13, 14, 29], "normal": [2, 6, 9, 10], "one": [2, 3, 4, 5, 8, 9, 12, 13, 31, 56], "limit": [2, 4, 8], "must": [2, 3, 8, 19, 29, 31, 45, 51, 53], "power": [2, 4, 13, 16, 19], "intern": [2, 13], "pad": [2, 3, 31], "properli": 2, "want": [2, 4, 53], "softmax_kernel": 2, "input_ptr": 2, "input_row_strid": 2, "output_row_strid": 2, "n_col": 2, "independ": [2, 5, 13], "across": [2, 4, 5, 12, 13], "row_idx": 2, "stride": [2, 3, 4, 5, 6, 8], "repres": [2, 3, 8, 13, 14], "much": [2, 3, 5, 8], "advanc": [2, 3, 12], "row_start_ptr": 2, "next": [2, 3, 8], "greater": 2, "singl": [2, 4, 12, 31, 41, 51], "col_offset": 2, "mai": [2, 8, 13, 16], "other": [2, 3, 4, 5, 8, 11, 13, 17, 29, 31, 34, 36], "float": [2, 6, 7, 12, 13], "inf": [2, 6], "row_minus_max": 2, "exponenti": [2, 30], "fast": [2, 12, 13], "approxim": 2, "think": 2, "__expf": 2, "softmax_output": 2, "output_row_start_ptr": 2, "given": [2, 3, 4, 5, 27, 38, 39, 40, 41, 42, 43, 55], "n_row": 2, "smallest": [2, 16], "column": [2, 3, 5], "next_power_of_2": [2, 5], "anoth": [2, 5, 13], "trick": 2, "ask": 2, "compil": [2, 3, 8, 11, 12, 14, 17, 37], "more": [2, 3, 4, 5, 8, 11, 12, 13, 56], "thread": [2, 12, 14], "per": [2, 4, 5], "warp": [2, 5, 14], "num_warp": [2, 3, 5, 6, 8, 14, 15], "over": [2, 4, 6, 12, 13], "distribut": [2, 4, 13], "auto": [2, 3, 13, 14, 15, 16], "tune": [2, 3, 13, 15, 16], "natur": [2, 12, 32], "wai": [2, 3, 4, 5, 8], "come": [2, 3, 13], "manual": [2, 8, 13], "heurist": [2, 5], "yourself": [2, 3], "2048": [2, 3, 5, 6], "16": [2, 3, 5, 6, 8, 13, 55], "o": [2, 4, 6], "sure": 2, "irregular": [2, 13], "verifi": [2, 13], "mechan": [2, 13], "randn": [2, 3, 4, 5, 6, 8], "1823": 2, "781": 2, "y_triton": 2, "y_torch": 2, "allclos": [2, 3, 5, 6, 8], "As": [2, 3, 4, 12, 13], "ident": 2, "assum": [2, 56], "compar": [2, 3, 4, 5, 6, 11, 13, 22, 23, 24, 25, 26], "100": [2, 6, 57], "nelement": 2, "element_s": [2, 5], "682": [2, 5], "666643": 2, "877": 2, "714274": 2, "315": 2, "076934": 2, "512": [2, 3, 4, 5, 8], "910": 2, "222190": 2, "356": 2, "173905": 2, "640": [2, 3], "975": 2, "238103": 2, "930": 2, "909084": 2, "386": 2, "415096": 2, "1068": 2, "521715": 2, "983": 2, "040025": 2, "416": 2, "542360": 2, "93": 2, "12160": 2, "1594": 2, "754129": 2, "1069": 2, "010969": 2, "587": 2, "794583": 2, "94": 2, "12288": [2, 5], "1598": 2, "438956": 2, "1021": 2, "340281": 2, "766841": 2, "95": [2, 3], "12416": 2, "1576": 2, "634933": 2, "1037": 2, "368130": 2, "586": 2, "005915": 2, "96": [2, 5], "12544": 2, "1580": 2, "346374": 2, "394416": 2, "853777": 2, "97": 2, "12672": 2, "1584": 2, "000004": 2, "1011": 2, "231926": 2, "686943": 2, "98": 2, "confirm": 2, "suspicion": 2, "notic": [2, 13], "being": [2, 4], "understand": 2, "maintain": [2, 13], "howev": [2, 8, 13], "17": [2, 3, 5, 8, 10], "320": [2, 10], "02": [2, 10], "short": 3, "high": [3, 5, 12, 13], "fp16": [3, 8], "achiev": [3, 12, 13], "cubla": [3, 8, 12], "specif": [3, 5, 8, 12], "level": [3, 12, 13], "multi": [3, 12, 13], "dimension": [3, 13, 29], "improv": [3, 4, 5], "hit": 3, "rate": 3, "kei": [3, 8, 12, 15], "most": [3, 13], "modern": [3, 11, 12, 13], "thei": [3, 12, 13, 17], "notori": [3, 12], "hard": 3, "henc": 3, "done": [3, 8, 12, 20, 21, 33, 35, 45, 52, 54], "hardwar": [3, 8, 11, 13], "vendor": 3, "themselv": 3, "part": [3, 4, 13], "g": [3, 4, 5, 8, 12, 13, 55], "unfortun": [3, 13], "often": 3, "proprietari": 3, "cannot": [3, 12, 13], "easili": 3, "accommod": [3, 8], "deep": [3, 4, 12, 13], "workload": [3, 8, 14], "fuse": [3, 5, 9, 10], "activ": 3, "effici": [3, 4, 5, 12, 42], "easi": [3, 4], "extend": [3, 4], "roughli": 3, "speak": 3, "algorithm": [3, 4, 6, 8, 12, 13], "multipli": [3, 4, 8, 13, 29], "k": [3, 4, 6, 7, 8, 12, 13], "block_size_m": [3, 5, 8], "block_size_n": [3, 5, 8], "acc": [3, 6, 12, 13], "zero": [3, 4, 5, 6, 7, 8, 15, 31], "block_size_k": [3, 8], "A": [3, 4, 8, 12, 13], "b": [3, 5, 8, 12, 13], "dot": [3, 5, 6, 8], "c": [3, 8, 12, 13], "iter": [3, 5, 8, 12, 13, 17], "doubli": 3, "nest": [3, 13], "loop": [3, 6, 8, 13, 14], "dedic": 3, "actual": [3, 5, 12, 13], "fairli": 3, "straightforward": [3, 5], "main": [3, 12, 13], "difficulti": [3, 12], "locat": [3, 22, 23, 24, 25, 26, 31, 51], "inner": [3, 8, 29], "major": [3, 8, 13], "2d": [3, 5, 8, 29], "j": [3, 13], "stride_xi": 3, "stride_xj": 3, "therefor": 3, "pseudo": [3, 4, 42], "a_ptr": [3, 8], "b_ptr": [3, 8], "mean": [3, 5, 6, 8, 13, 15, 57], "modulo": 3, "some": [3, 8], "useless": 3, "contribut": 3, "dimens": [3, 8, 20, 21, 29, 31, 33, 35, 45, 51, 52, 54], "semant": [3, 7, 8, 13], "offs_am": 3, "pid_m": [3, 8], "offs_bn": 3, "pid_n": [3, 8], "offs_k": [3, 6], "stride_am": [3, 8], "stride_ak": [3, 8], "stride_bk": [3, 8], "stride_bn": [3, 8], "updat": [3, 6, 13, 15], "mention": 3, "rememb": 3, "matter": [3, 12, 13], "affect": 3, "grid_m": 3, "grid_n": 3, "just": [3, 13, 16], "cut": 3, "One": 3, "solut": 3, "promot": [3, 8, 13], "reus": [3, 8], "super": 3, "group": [3, 8, 45], "group_m": 3, "befor": [3, 5, 14, 15, 22, 23, 24, 25, 26], "switch": 3, "id": [3, 5, 8, 39], "num_pid_m": [3, 8], "num_pid_n": [3, 8], "num_pid_in_group": [3, 8], "group_size_m": [3, 5, 8], "group_id": [3, 8], "first_pid_m": [3, 8], "If": [3, 4, 13, 41, 51, 53, 56], "isn": 3, "divis": [3, 5], "last": 3, "smaller": [3, 4], "min": [3, 5, 8, 25], "within": [3, 17, 19], "col": [3, 5, 6, 13], "matmul": [3, 6, 8, 13], "90": 3, "54": 3, "architectur": [3, 12], "220": 3, "245": 3, "tflop": 3, "a100": [3, 13], "autotun": [3, 8, 13], "consum": 3, "config": [3, 6, 8, 15], "configur": [3, 14, 15, 58], "option": [3, 15, 31, 51, 56], "try": [3, 5, 6, 7, 14], "chang": [3, 4, 8, 15, 31, 51], "trigger": [3, 15], "evalu": [3, 4, 15, 53], "num_stag": [3, 6, 8, 14, 15], "32": [3, 5, 6, 8, 14], "matmul_kernel": 3, "c_ptr": [3, 8], "variabl": [3, 8, 14], "ptr": [3, 8], "move": [3, 5, 8], "down": [3, 8, 13], "stride_cm": [3, 8], "stride_cn": [3, 8], "map": [3, 5, 8], "section": [3, 8, 13], "detail": [3, 8, 13], "direct": [3, 8], "accumul": [3, 5, 6, 8, 13], "fp32": [3, 8, 29], "higher": [3, 8], "accuraci": [3, 8, 12], "after": [3, 5, 8], "check": [3, 8, 11, 31, 51], "arbitrari": 3, "while": [3, 5, 12, 31], "leaky_relu": 3, "float16": [3, 5, 6, 8, 29, 55], "offs_cm": 3, "offs_cn": 3, "c_mask": 3, "_matmul": 3, "conveni": [3, 8], "wrapper": [3, 8], "take": [3, 4, 5, 8, 11, 15, 16], "constraint": [3, 6, 8, 13], "incompat": [3, 8, 13], "is_contigu": [3, 4, 8], "contigu": [3, 6, 8, 19, 44], "empti": [3, 5, 6, 8, 31, 51], "own": [3, 8], "triton_output": [3, 8], "torch_output": [3, 8], "atol": [3, 5, 6, 8], "rtol": [3, 5, 6, 8], "match": [3, 8, 22, 23, 24, 25, 26], "els": [3, 5, 6, 8], "9531": [3, 8], "7109": [3, 8], "6953": [3, 8], "4062": [3, 8], "3320": [3, 8], "26": [3, 5, 8], "4219": [3, 8], "8438": [3, 8], "0469": [3, 8], "4297": [3, 8], "2969": [3, 8], "5312": [3, 8], "30": [3, 8], "7500": [3, 8], "2578": [3, 8], "8516": [3, 8], "18": [3, 5, 8], "0781": [3, 8], "21": [3, 5, 8], "7656": [3, 8], "6406": [3, 8], "2031": [3, 8], "40": [3, 8], "2812": [3, 8], "6094": [3, 8], "7598": [3, 8], "2441": [3, 8], "41": [3, 8], "0000": [3, 8], "1211": [3, 8], "8281": [3, 8], "4844": [3, 8], "0312": [3, 8], "24": [3, 5, 8], "7031": [3, 8], "0234": [3, 8], "0938": [3, 8], "19": [3, 5, 8, 10], "3831": [3, 8], "5469": [3, 8], "2344": [3, 8], "2188": [3, 8], "focu": [3, 5, 13], "feel": 3, "free": 3, "arrang": 3, "wish": [3, 13], "33": 3, "perf": 3, "096000": 3, "640889": 3, "059200": 3, "23": [3, 5], "831273": 3, "39": 3, "384616": 3, "36": 3, "571428": 3, "195428": 3, "58": 3, "982401": 3, "896": 3, "73": 3, "943582": 3, "78": 3, "051553": 3, "104": 3, "857603": 3, "325090": 3, "1152": 3, "129": 3, "825388": 3, "124": 3, "415996": 3, "1280": 3, "151": 3, "703703": 3, "1408": 3, "147": 3, "345291": 3, "126": 3, "785488": 3, "1536": [3, 5], "172": 3, "631417": 3, "150": 3, "593357": 3, "1664": 3, "176": 3, "449258": 3, "173": 3, "056002": 3, "1792": 3, "167": 3, "752595": 3, "200": 3, "703997": 3, "1920": 3, "194": 3, "704219": 3, "164": 3, "571430": 3, "195": 3, "083907": 3, "188": 3, "508043": 3, "2176": 3, "189": 3, "845737": 3, "214": 3, "081356": 3, "2304": 3, "229": [3, 5], "691080": 3, "2432": 3, "203": 3, "583068": 3, "202": 3, "118452": 3, "2560": [3, 5], "224": 3, "438347": 3, "218": 3, "453323": 3, "2688": 3, "704002": 3, "199": 3, "647657": 3, "20": [3, 5, 6], "2816": 3, "213": 3, "795141": 3, "211": 3, "719459": 3, "2944": 3, "223": 3, "479969": 3, "225": 3, "502413": 3, "22": [3, 5], "3072": [3, 5], "280236": 3, "210": 3, "494802": 3, "3200": 3, "215": 3, "488222": 3, "430042": 3, "3328": 3, "208": 3, "670419": 3, "067338": 3, "3456": 3, "217": 3, "896133": 3, "080343": 3, "3584": [3, 5], "380867": 3, "209": 3, "105570": 3, "27": [3, 5], "3712": 3, "212": 3, "547541": 3, "216": 3, "697064": 3, "3840": 3, "862062": 3, "454544": 3, "29": [3, 5], "3968": 3, "585252": 3, "289686": 3, "222": 3, "214781": 3, "532790": 3, "43": [3, 10], "596": [3, 10], "03": [3, 10], "state": [4, 12, 13], "compos": [4, 12], "int32": [4, 5, 6, 19, 41, 42], "tradit": [4, 12, 13], "bit": [4, 5], "same": [4, 5, 7, 8, 12, 53, 56], "random": [4, 40, 41, 42, 43], "wa": [4, 5], "introduc": [4, 5], "srivastava2014": 4, "neural": [4, 5, 12, 13], "network": [4, 5, 12, 13], "regim": 4, "regular": [4, 13], "vector": [4, 5, 9, 10, 12, 13], "produc": [4, 5], "scalar": [4, 12, 29, 31, 40, 41, 42, 43, 45, 51, 55], "probabl": [4, 13], "p": [4, 6, 13], "otherwis": [4, 53], "copi": [4, 12, 22, 23, 24, 25, 26], "forc": 4, "well": [4, 12, 13], "even": [4, 13], "At": [4, 13], "norm": [4, 5, 10], "bad": 4, "lead": [4, 12, 13], "artifici": 4, "decreas": 4, "softmax": [4, 6, 9, 10], "temperatur": 4, "prevent": [4, 13], "frac": [4, 5], "keep": 4, "consist": 4, "regardless": [4, 53], "look": [4, 5, 8, 11, 12], "tabul": 4, "_dropout": 4, "x_keep_ptr": 4, "x_keep": 4, "below": [4, 9, 13], "crucial": 4, "describ": [4, 13], "paragraph": 4, "tolist": 4, "541": [4, 5, 10], "293429": 4, "17879": 4, "568431": 4, "08452": 4, "3986": 4, "403347": 4, "838026": 4, "719258": 4, "403344": 4, "08199": 4, "586858": 4, "13686": 4, "79719": 4, "806694": 4, "fine": 4, "awkward": 4, "deal": 4, "firstli": 4, "backpropag": 4, "secondli": 4, "manag": [4, 8, 12], "tricki": 4, "recomput": [4, 6, 12], "checkpoint": 4, "preserve_rng_st": 4, "org": [4, 6], "doc": [4, 7], "html": [4, 7], "ll": 4, "altern": 4, "footprint": 4, "less": [4, 5, 12, 13, 19], "movement": 4, "simplifi": 4, "persist": 4, "invoc": 4, "kernel": [4, 5, 8, 11, 12, 14, 15, 16], "uniformli": 4, "But": 4, "strategi": [4, 5, 13], "prng": 4, "base": [4, 7, 8, 11, 12, 13], "philox": [4, 42], "salmon2011": 4, "put": 4, "togeth": [4, 7], "_seeded_dropout": 4, "comput": [4, 5, 6, 7, 8, 11, 12, 13, 16, 18, 28, 30, 32, 34, 36, 47, 48, 49, 50], "randomli": 4, "prune": [4, 15], "seeded_dropout": 4, "never": 4, "instanti": 4, "123": 4, "output2": 4, "output3": 4, "952835": 4, "371721": 4, "408716": 4, "42142": 4, "149397": 4, "67086": 4, "214186": 4, "431969": 4, "707878": 4, "106434": 4, "743443": 4, "34172": 4, "41576": 4, "212868": 4, "817432": 4, "84284": 4, "428372": 4, "et": [4, 6, 12, 13], "voil\u00e0": 4, "appli": [4, 5, 6, 7, 12, 13, 45], "explor": [4, 12], "further": [4, 5, 13], "applic": [4, 13, 16], "pseudorandom": 4, "encourag": 4, "folder": 4, "support": [4, 5, 8, 13], "challeng": 4, "spars": [4, 12, 13], "johnson": 4, "lindenstrauss": 4, "transform": [4, 5, 13], "project": [4, 12], "fly": 4, "john": 4, "salmon": 4, "mark": [4, 6, 45, 58], "mora": 4, "ron": 4, "dror": 4, "david": 4, "shaw": 4, "2011": 4, "nitish": 4, "srivastava": 4, "geoffrei": [4, 5], "hinton": [4, 5], "alex": 4, "krizhevski": 4, "ilya": 4, "sutskev": [4, 12], "ruslan": 4, "salakhutdinov": 4, "overfit": 4, "jmlr": 4, "2014": [4, 12], "659": [4, 10], "04": [4, 10], "layernorm": 5, "ba2016": 5, "sequenti": 5, "small": 5, "batch": [5, 6], "divid": [5, 6], "standard": [5, 13], "deviat": 5, "learnabl": 5, "linear": [5, 12, 13], "weight": [5, 6], "w": [5, 13], "bias": 5, "forward": [5, 6], "express": [5, 12, 13], "text": [5, 13], "sqrt": 5, "var": [5, 13], "epsilon": 5, "constant": 5, "ad": 5, "nvidia": [5, 7, 12, 31, 51], "apex": 5, "NOT": 5, "extras_requir": 5, "has_apex": 5, "except": [5, 6], "modulenotfounderror": 5, "fals": [5, 6, 31, 49, 51, 53, 56], "_layer_norm_fwd_fus": 5, "rstd": 5, "std": [5, 6], "ep": 5, "_mean": 5, "off": [5, 8], "varianc": 5, "_var": 5, "x_hat": 5, "involv": [5, 8], "hat": 5, "jacobian": 5, "product": [5, 11, 13, 29], "vjp": 5, "nabla_": 5, "sigma": 5, "big": 5, "odot": 5, "underbrac": 5, "cdot": 5, "_": 5, "c_1": 5, "c_2": 5, "intermedi": [5, 13], "readabl": 5, "quad": 5, "gradient": 5, "step": [5, 13], "partial": 5, "certain": [5, 16], "buffer": 5, "These": [5, 8, 13], "stai": [5, 6], "l2": [5, 8], "cach": [5, 8, 12, 13, 31, 51], "reduc": 5, "diagram": 5, "omit": 5, "breviti": 5, "stage": [5, 14], "color": [5, 56], "share": [5, 12], "thu": 5, "lock": 5, "ensur": [5, 13], "final": 5, "_layer_norm_bwd_dx_fus": 5, "_layer_norm_bwd_dwdb": 5, "dx": 5, "dy": 5, "dw": 5, "db": 5, "lock_id": 5, "count": 5, "xhat": 5, "wdy": 5, "c1": 5, "c2": 5, "partial_dw": 5, "partial_db": 5, "atomic_ca": 5, "doesn": [5, 13], "atomic_xchg": 5, "final_dw": 5, "final_db": 5, "through": [5, 8, 9, 13], "sum_dw": 5, "sum_db": 5, "64kb": 5, "featur": [5, 8], "mode": [5, 6, 8], "autograd": [5, 6], "staticmethod": [5, 6], "ctx": [5, 6], "normalized_shap": 5, "bia": 5, "reshap": 5, "x_arg": 5, "max_fused_s": 5, "rais": 5, "runtimeerror": 5, "save_for_backward": [5, 6], "saved_tensor": [5, 6], "amount": [5, 8, 12], "stream": [5, 41], "_dw": 5, "_db": 5, "separ": [5, 13], "layer_norm": 5, "test_layer_norm": 5, "x_shape": 5, "w_shape": 5, "requires_grad": [5, 6], "randn_lik": [5, 6], "requires_grad_": [5, 6], "y_tri": 5, "y_ref": 5, "nn": 5, "retain_graph": [5, 6], "dx_tri": 5, "dw_tri": 5, "db_tri": 5, "grad": [5, 6], "dx_ref": 5, "dw_ref": 5, "db_ref": 5, "orang": 5, "bench_layer_norm": 5, "y_fwd": 5, "apex_layer_norm": 5, "fusedlayernorm": 5, "rep": [5, 6, 57], "500": 5, "grad_to_non": [5, 57], "1151": 5, "682243": 5, "341": 5, "333321": 5, "333333": 5, "396": 5, "387087": 5, "434": 5, "973444": 5, "431": 5, "157886": 5, "516": 5, "302536": 5, "461": 5, "954908": 5, "589": 5, "823972": 5, "491": 5, "519977": 5, "651": 5, "636359": 5, "432": 5, "241202": 5, "717": 5, "547469": 5, "4608": 5, "666681": 5, "433": 5, "694132": 5, "5120": 5, "731": 5, "428577": 5, "438": 5, "857131": 5, "5632": 5, "767": 5, "999994": 5, "453": 5, "583894": 5, "6144": 5, "814": 5, "674052": 5, "457": 5, "937878": 5, "6656": 5, "858": 5, "838688": 5, "467": 5, "087700": 5, "7168": 5, "891": 5, "357514": 5, "447": 5, "999984": 5, "7680": 5, "917": 5, "014914": 5, "437": 5, "814722": 5, "949": 5, "797080": 5, "455": 5, "111110": 5, "8704": 5, "623": 5, "570168": 5, "454": 5, "121729": 5, "9216": 5, "650": 5, "541179": 5, "465": 5, "650518": 5, "9728": 5, "674": 5, "774593": 5, "469": 5, "762575": 5, "10240": 5, "700": [5, 10], "170950": 5, "454542": 5, "10752": 5, "726": 5, "895782": 5, "464": 5, "115121": 5, "11264": 5, "750": 5, "933322": 5, "468": 5, "519908": 5, "11776": 5, "999983": 5, "471": 5, "039978": 5, "782": 5, "259969": 5, "105436": 5, "12800": 5, "787": 5, "692306": 5, "473": 5, "343610": 5, "13312": 5, "807": 5, "807869": 5, "479": 5, "711707": 5, "13824": 5, "240903": 5, "478": 5, "753261": 5, "14336": 5, "825": 5, "093519": 5, "475": 5, "226530": 5, "14848": 5, "822": 5, "983818": 5, "324815": 5, "15360": 5, "837": 5, "818175": 5, "476": 5, "279061": 5, "15872": 5, "840": 5, "900688": 5, "154717": 5, "jimmi": 5, "lei": 5, "ba": 5, "jami": 5, "ryan": 5, "kiro": 5, "arxiv": [5, 6, 12, 13], "2016": [5, 12, 13], "37": [5, 10], "05": [5, 10], "flash": 6, "dao": 6, "al": [6, 12, 13], "pdf": 6, "2205": 6, "14135v2": 6, "rabe": 6, "staat": 6, "2112": 6, "05682v2": 6, "batch4": 6, "head48": 6, "d64": 6, "fwd": 6, "n_ctx": 6, "329809": 6, "071649": 6, "887301": 6, "819328": 6, "bwd": 6, "205498": 6, "773637": 6, "132653": 6, "48": 6, "825344": 6, "_fwd_kernel": 6, "q": 6, "sm_scale": 6, "l": 6, "stride_qz": 6, "stride_qh": 6, "stride_qm": 6, "stride_qk": 6, "stride_kz": 6, "stride_kh": 6, "stride_kn": 6, "stride_kk": 6, "stride_vz": 6, "stride_vh": 6, "stride_vk": 6, "stride_vn": 6, "stride_oz": 6, "stride_oh": 6, "stride_om": 6, "stride_on": 6, "h": 6, "block_m": 6, "block_dmodel": 6, "block_n": 6, "start_m": 6, "off_hz": 6, "offs_m": 6, "offs_n": 6, "offs_d": 6, "off_q": 6, "off_k": 6, "off_v": 6, "q_ptr": 6, "k_ptr": 6, "v_ptr": 6, "m_prev": 6, "l_prev": 6, "throughout": [6, 13, 56], "start_n": 6, "qk": 6, "new": [6, 8, 27, 55], "m_curr": 6, "old": 6, "l_curr": 6, "rescal": 6, "operand": 6, "l_rcp": 6, "element_ti": [6, 22, 23, 24, 25, 26, 31, 51], "m_i": 6, "l_i": 6, "remateri": 6, "regist": 6, "l_ptr": 6, "m_ptr": 6, "off_o": 6, "out_ptr": 6, "_bwd_preprocess": 6, "newdo": 6, "delta": 6, "d_head": 6, "off_m": 6, "off_n": 6, "denom": 6, "_bwd_kernel": 6, "dq": 6, "dk": 6, "dv": 6, "num_block": 6, "off_z": 6, "off_h": 6, "head": 6, "lo": 6, "offs_qm": 6, "do_ptr": 6, "dq_ptr": 6, "quantiti": 6, "d_ptr": 6, "amd": [6, 12], "offs_m_curr": 6, "tran": 6, "dp": 6, "di": 6, "increment": [6, 8, 13], "dv_ptr": 6, "dk_ptr": 6, "_attent": 6, "lq": 6, "lk": 6, "lv": 6, "asm": 6, "ttgir": 6, "backward": 6, "zeros_lik": 6, "do_scal": 6, "parametr": [6, 12], "test_op": 6, "normal_": 6, "dout": 6, "tril": 6, "ones": 6, "transpos": 6, "half": 6, "ref_out": 6, "ref_dv": 6, "ref_dk": 6, "ref_dq": 6, "tri_out": 6, "tri_dv": 6, "tri_dk": 6, "tri_dq": 6, "flash_attn": 6, "flash_attn_interfac": 6, "flash_attn_func": 6, "has_flash": 6, "baseexcept": 6, "n_head": 6, "vari": 6, "seq": 6, "fix": [6, 56], "red": 6, "bench_flash_attent": 6, "warmup": [6, 57], "fn": [6, 17, 57], "fill_valu": 6, "cu_seqlen": 6, "cumsum": 6, "qkv": 6, "causal": 6, "post": 6, "amper": 6, "right": [6, 13, 19], "096": [6, 10], "06": [6, 10], "invok": 7, "extern": 7, "pleas": 7, "user": 7, "guid": [7, 8, 12], "regard": 7, "aggreg": 7, "type": [7, 14, 29, 53, 55], "both": [7, 13, 53], "__nv_asin": 7, "__nvasinf": 7, "calcul": [7, 8], "princip": 7, "arc": 7, "sine": [7, 48], "doubl": 7, "__nv_asinf": 7, "simpli": [7, 8, 13], "select": [7, 12, 13, 53], "underli": 7, "asin_kernel": 7, "encod": [7, 13], "4105": 7, "5430": 7, "0249": 7, "0424": 7, "5351": 7, "8149": 7, "384185791015625e": 7, "07": [7, 10], "extern_lib": 7, "usr": 7, "local": [7, 12, 13], "nvvm": 7, "bc": 7, "242": [7, 10], "friendli": 8, "optim": [8, 12, 13], "better": 8, "futur": 8, "previou": 8, "construct": [8, 12], "de": 8, "referenc": 8, "pointer_typ": 8, "element_typ": 8, "approach": [8, 12, 13], "flexibl": [8, 12], "complex": [8, 13], "structur": [8, 12, 13], "tree": 8, "unstructur": 8, "tabl": 8, "drawback": 8, "reli": [8, 13], "heavili": 8, "pattern": [8, 12], "brittl": 8, "suffer": [8, 13], "degrad": 8, "fail": 8, "adequ": 8, "addition": [8, 13], "control": [8, 12, 13, 31, 51], "special": [8, 12], "dens": [8, 13], "spatial": [8, 13], "commonli": [8, 13], "machin": [8, 12, 13], "worsen": 8, "address": [8, 12, 31], "issu": [8, 12, 13], "give": [8, 12], "start": [8, 9, 19], "demonstr": 8, "rewrit": 8, "parent": 8, "make_block_ptr": [8, 31, 51], "inform": [8, 13], "block_shap": 8, "laid": 8, "exactli": 8, "a_block_ptr": 8, "term": 8, "storag": 8, "outer": 8, "sound": 8, "redund": 8, "backend": 8, "boundary_check": [8, 31, 51], "specifi": [8, 13, 16, 22, 23, 24, 25, 26, 31, 51], "whether": [8, 12, 56], "boundari": [8, 31, 51], "With": 8, "accord": 8, "padding_opt": [8, 31, 51], "nan": [8, 31], "temporarili": 8, "due": 8, "legaci": 8, "cost": [8, 13], "guarante": 8, "alwai": [8, 13, 53], "turn": 8, "know": [8, 37], "replac": 8, "origin": [8, 13], "matmul_kernel_with_block_point": 8, "b_block_ptr": 8, "remov": 8, "c_block_ptr": 8, "801": [8, 10], "08": [8, 10], "variou": 9, "recommend": 9, "simplest": 9, "instal": [9, 11], "low": [9, 10, 13], "dropout": [9, 10], "layer": [9, 10, 12, 13], "attent": [9, 10], "libdevic": [9, 10], "math": [9, 10, 16], "experiment": [9, 10], "tutorials_python": 9, "zip": 9, "tutorials_jupyt": 9, "execut": [10, 12, 13, 14, 58], "started_tutori": 10, "mb": [10, 12], "00": 10, "09": 10, "environ": 11, "dnn": [11, 12, 13], "capabl": [11, 12], "maxim": [11, 13, 42], "throughput": 11, "instruct": [11, 12], "platform": [11, 13], "choic": 11, "dsl": [11, 12, 13], "chapter": 11, "introduct": 11, "relat": 11, "past": [12, 13], "decad": 12, "emerg": 12, "ml": 12, "art": [12, 13], "mani": [12, 13], "domain": [12, 13], "sutskever2014": 12, "vision": 12, "redmon2016": 12, "neurosci": 12, "lee2017": 12, "strength": 12, "li": 12, "hierarch": 12, "sequenc": 12, "convolut": 12, "non": 12, "rectifi": 12, "though": [12, 13], "computation": [12, 13], "expens": [12, 13, 16], "larg": [12, 13], "highli": 12, "paralleliz": 12, "particularli": [12, 13], "suit": 12, "core": [12, 13], "processor": 12, "consequ": 12, "graphic": 12, "becom": 12, "cheap": 12, "resourc": 12, "deploi": 12, "novel": 12, "research": [12, 13], "idea": 12, "field": [12, 15], "trend": 12, "acceler": 12, "sever": [12, 13], "framework": [12, 13], "purpos": [12, 13], "gpgpu": 12, "opencl": 12, "made": 12, "develop": [12, 13], "yet": [12, 13], "remain": [12, 56], "incredibli": 12, "especi": 12, "combin": [12, 45], "exist": [12, 13], "primit": [12, 17], "wors": [12, 13], "rapidli": [12, 13], "evolv": 12, "evidenc": 12, "recent": 12, "micro": 12, "tension": 12, "opportun": 12, "offer": 12, "substanti": 12, "academ": 12, "industri": 12, "interest": [12, 13], "regrett": 12, "polyhedr": 12, "machineri": [12, 13], "tiramisu": [12, 13], "baghdadi2021": [12, 13], "comprehens": [12, 13], "vasilache2018": [12, 13], "schedul": 12, "halid": [12, 13], "jrk2013": 12, "tvm": [12, 13], "chen2018": 12, "markedli": 12, "slower": [12, 13], "handwritten": 12, "cudnn": 12, "tensorrt": 12, "premis": 12, "paradigm": [12, 13], "lam1991": 12, "facilit": [12, 13], "revisit": 12, "auguin1983": 12, "propos": 12, "variant": 12, "rather": 12, "pragma": 12, "nb": 12, "kb": 12, "space": [12, 13], "programm": [12, 13], "aggress": [12, 13], "pose": 12, "partit": 12, "heavi": 12, "flow": [12, 13], "analysi": [12, 13], "techniqu": [12, 13], "target": 12, "surprisingli": 12, "broad": 12, "coalesc": 12, "swizzl": 12, "fetch": 12, "awar": 12, "Of": 12, "cours": 12, "trivial": 12, "nip": 12, "redmon": 12, "unifi": 12, "real": 12, "detect": 12, "cvpr": 12, "lee": 12, "superhuman": 12, "snemi3d": 12, "connectom": 12, "2017": 12, "baghdadi": [12, 13], "portabl": [12, 13], "cgo": [12, 13], "2021": [12, 13], "vasilach": [12, 13], "agnost": [12, 13], "abstract": [12, 13], "2018": [12, 13], "ragan": 12, "kellei": 12, "imag": [12, 13], "pipelin": [12, 13, 14], "pldi": 12, "2013": 12, "chen": 12, "autom": 12, "osdi": 12, "lam": 12, "asplo": 12, "1991": [12, 13], "auguin": 12, "opsila": 12, "simd": 12, "signal": 12, "euromicro": 12, "1983": 12, "sight": 13, "contextu": 13, "highlight": [13, 15, 16], "typic": 13, "ir": 13, "lattner2004": 13, "un": 13, "condit": [13, 53], "branch": 13, "format": 13, "difficult": 13, "analyz": 13, "runtim": 13, "behavior": [13, 15, 31, 51], "miss": 13, "accordingli": 13, "tile": 13, "wolfe1989": 13, "darte1999": 13, "interchang": 13, "allen1984": 13, "solv": 13, "ancourt1991": 13, "predict": 13, "therebi": 13, "enabl": 13, "adopt": 13, "diesel": 13, "elango2018": 13, "affin": 13, "dialect": 13, "mlir": 13, "lattner2019": 13, "vast": 13, "area": 13, "outlin": 13, "aspect": 13, "topic": 13, "reader": 13, "solid": 13, "mathemat": 13, "foundat": 13, "underneath": 13, "ampl": 13, "literatur": 13, "integ": [13, 31, 51], "known": 13, "scop": 13, "consecut": 13, "statement": 13, "surround": 13, "indic": [13, 31, 51, 53], "global": 13, "shown": 13, "inequ": 13, "polyhedra": 13, "algebra": 13, "mathcal": [13, 43], "mathbb": 13, "begin": 13, "pmatrix": 13, "geq": 13, "induc": 13, "side": 13, "effect": 13, "break": 13, "contain": [13, 22, 23, 24, 25, 26, 56], "arrai": [13, 55], "alia": 13, "word": 13, "shall": 13, "fact": 13, "travers": 13, "legal": 13, "formal": 13, "theta": 13, "mathbf": 13, "theta_": 13, "t_": 13, "vec": 13, "qquad": 13, "slowest": 13, "fastest": 13, "grow": 13, "left": [13, 19], "retriev": 13, "respect": 13, "resp": 13, "said": 13, "amen": 13, "boil": 13, "tempor": 13, "verif": 13, "preserv": 13, "phase": 13, "uncommon": 13, "ahead": 13, "grosser2012": 13, "extrem": 13, "common": 13, "inde": 13, "fulli": 13, "hint": 13, "apart": 13, "univers": 13, "method": [13, 14, 17, 56, 58], "omega": 13, "resolut": 13, "properti": 13, "sm": 13, "characterist": 13, "taken": 13, "account": 13, "procedur": 13, "sato2019": 13, "girbal2006": 13, "subscript": 13, "occur": 13, "reason": 13, "successfulli": 13, "rise": 13, "few": 13, "year": 13, "On": 13, "hand": 13, "advoc": 13, "dissert": 13, "restrict": 13, "scope": 13, "close": [13, 19], "peak": 13, "dataflow": 13, "concern": 13, "dijkstra82": 13, "design": 13, "principl": 13, "scienc": 13, "decompos": 13, "modular": 13, "push": 13, "philosophi": 13, "enforc": 13, "grammat": 13, "methodologi": 13, "visibl": 13, "definit": 13, "complet": 13, "disjoint": 13, "func": 13, "rdom": 13, "matrix_s": 13, "rvar": 13, "ki": 13, "0f": 13, "xi": 13, "xo": 13, "yo": 13, "yi": 13, "yii": 13, "xii": 13, "split": 13, "reorder": 13, "unrol": 13, "sometim": 13, "intrins": 13, "wide": 13, "mitig": 13, "mullapudi2016": 13, "wouldn": 13, "abl": 13, "figur": 13, "without": 13, "doubt": 13, "popular": 13, "eas": 13, "tend": 13, "v100": 13, "equal": [13, 19], "believ": 13, "fundament": 13, "effort": 13, "harder": 13, "engin": 13, "importantli": 13, "least": 13, "impos": 13, "entir": 13, "problemat": 13, "balanc": 13, "lattner": 13, "lifelong": 13, "2004": 13, "wolf": 13, "sc": 13, "1989": 13, "dart": 13, "pact": 13, "1999": 13, "allen": 13, "sigplan": 13, "1984": 13, "ancourt": 13, "scan": 13, "ppopp": 13, "elango": 13, "net": 13, "mapl": 13, "primer": 13, "infrastructur": 13, "moor": 13, "law": 13, "2019": 13, "grosser": 13, "polli": 13, "letter": 13, "2012": 13, "sato": 13, "scalabl": 13, "via": 13, "taco": 13, "girbal": 13, "semi": 13, "composit": 13, "hierarchi": 13, "journal": 13, "2006": 13, "dijkstra": 13, "role": 13, "scientif": 13, "thought": 13, "person": 13, "perspect": 13, "1982": 13, "mullapudi": 13, "tog": 13, "self": [14, 56], "kwarg": 14, "pre_hook": 14, "tuner": 14, "ivar": 14, "dictionari": [14, 16], "dict": [14, 15, 16], "str": [14, 15, 16, 31, 51, 56], "cooper": 14, "softwar": 14, "mostli": 14, "sm80": 14, "__init__": [14, 56], "prune_configs_bi": 15, "reset_to_zero": 15, "x_size": [15, 16], "anytim": 15, "whatev": 15, "undesir": 15, "reset": 15, "perf_model": 15, "predic": 15, "top_k": 15, "early_config_prun": 15, "earli": 15, "eg": 15, "prohibitev": 16, "ceil": 16, "log2": 16, "posit": 16, "jitfunct": 17, "version": 17, "do_not_speci": 17, "debug": 17, "bool": [17, 31, 53, 56], "data_ptr": 17, "attribut": 17, "builtin": 17, "packag": 17, "absolut": 18, "open": 19, "interv": 19, "triton_max_tensor_numel": 19, "minimum": [21, 35], "val": [22, 23, 24, 25, 26], "atom": [22, 23, 24, 25, 26], "pointerdtyp": [22, 23, 24, 25, 26], "swap": [22, 23, 24, 25, 26], "cmp": [22, 23, 24, 25, 26], "found": [22, 23, 24, 25, 26], "exchang": 26, "tri": 27, "broadcast": [27, 31, 51, 53], "desir": 27, "cosin": 28, "allow_tf32": 29, "out_dtyp": 29, "compat": 29, "bfloat16": 29, "cache_modifi": [31, 51], "eviction_polici": [31, 51], "volatil": 31, "too": [31, 51], "typecast": [31, 51], "pointertyp": [31, 51], "int1": [31, 51], "idx": [31, 51], "ptx": [31, 51], "evict": [31, 51], "polici": [31, 51], "3d": [38, 39], "current": 39, "seed": [40, 41, 42, 43], "n_round": [40, 41, 42, 43], "randint4x": 41, "four": 42, "entri": 42, "flatten": 44, "view": 44, "combine_fn": 45, "ieee_round": 49, "squar": 50, "root": 50, "unintend": 53, "nonzero": 53, "yield": 53, "xor": 54, "fill": 55, "xlabel": 56, "y_log": 56, "api": 56, "constructor": 56, "appear": 56, "log": 56, "scale": 56, "fast_flush": 57, "return_mod": 57}, "objects": {"triton": [[14, 0, 1, "", "Config"], [15, 2, 1, "", "autotune"], [16, 2, 1, "", "heuristics"], [17, 2, 1, "", "jit"]], "triton.Config": [[14, 1, 1, "", "__init__"]], "triton.language": [[18, 2, 1, "", "abs"], [19, 2, 1, "", "arange"], [20, 2, 1, "", "argmax"], [21, 2, 1, "", "argmin"], [22, 2, 1, "", "atomic_add"], [23, 2, 1, "", "atomic_cas"], [24, 2, 1, "", "atomic_max"], [25, 2, 1, "", "atomic_min"], [26, 2, 1, "", "atomic_xchg"], [27, 2, 1, "", "broadcast_to"], [28, 2, 1, "", "cos"], [29, 2, 1, "", "dot"], [30, 2, 1, "", "exp"], [31, 2, 1, "", "load"], [32, 2, 1, "", "log"], [33, 2, 1, "", "max"], [34, 2, 1, "", "maximum"], [35, 2, 1, "", "min"], [36, 2, 1, "", "minimum"], [37, 2, 1, "", "multiple_of"], [38, 2, 1, "", "num_programs"], [39, 2, 1, "", "program_id"], [40, 2, 1, "", "rand"], [41, 2, 1, "", "randint"], [42, 2, 1, "", "randint4x"], [43, 2, 1, "", "randn"], [44, 2, 1, "", "ravel"], [45, 2, 1, "", "reduce"], [46, 2, 1, "", "reshape"], [47, 2, 1, "", "sigmoid"], [48, 2, 1, "", "sin"], [49, 2, 1, "", "softmax"], [50, 2, 1, "", "sqrt"], [51, 2, 1, "", "store"], [52, 2, 1, "", "sum"], [53, 2, 1, "", "where"], [54, 2, 1, "", "xor_sum"], [55, 2, 1, "", "zeros"]], "triton.testing": [[56, 0, 1, "", "Benchmark"], [57, 2, 1, "", "do_bench"], [58, 2, 1, "", "perf_report"]], "triton.testing.Benchmark": [[56, 1, 1, "", "__init__"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:function"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "function", "Python function"]}, "titleterms": {"instal": 0, "binari": 0, "distribut": 0, "from": 0, "sourc": 0, "python": [0, 11], "packag": 0, "vector": 1, "addit": 1, "comput": [1, 2, 3, 10], "kernel": [1, 2, 3, 7], "benchmark": [1, 2, 3, 5, 56], "fuse": [2, 6], "softmax": [2, 49], "motiv": [2, 3, 5, 8, 12], "unit": [2, 3, 8], "test": [2, 3, 8, 56, 57, 58, 61], "matrix": 3, "multipl": 3, "pointer": [3, 8], "arithmet": 3, "l2": 3, "cach": 3, "optim": 3, "final": [3, 8], "result": [3, 8], "squar": 3, "perform": 3, "low": 4, "memori": [4, 60], "dropout": 4, "baselin": 4, "seed": 4, "exercis": 4, "refer": [4, 5, 12, 13], "layer": 5, "normal": 5, "backward": 5, "pass": 5, "attent": 6, "libdevic": 7, "tl": 7, "math": [7, 60], "function": 7, "asin": 7, "us": 7, "default": 7, "librari": 7, "path": 7, "custom": 7, "block": 8, "experiment": 8, "make": 8, "load": [8, 31], "store": [8, 51], "advanc": 8, "tutori": 9, "time": 10, "welcom": 11, "triton": [11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61], "": 11, "document": 11, "get": 11, "start": 11, "api": 11, "go": 11, "further": 11, "introduct": 12, "challeng": 12, "relat": 13, "work": 13, "polyhedr": 13, "compil": [13, 60], "program": [13, 60], "represent": 13, "advantag": 13, "limit": 13, "schedul": 13, "languag": [13, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 60], "config": 14, "autotun": 15, "heurist": 16, "jit": 17, "ab": 18, "arang": 19, "argmax": 20, "argmin": 21, "atomic_add": 22, "atomic_ca": 23, "atomic_max": 24, "atomic_min": 25, "atomic_xchg": 26, "broadcast_to": 27, "co": 28, "dot": 29, "exp": 30, "log": 32, "max": 33, "maximum": 34, "min": 35, "minimum": 36, "multiple_of": 37, "num_program": 38, "program_id": 39, "rand": 40, "randint": 41, "randint4x": 42, "randn": 43, "ravel": 44, "reduc": 45, "reshap": 46, "sigmoid": 47, "sin": 48, "sqrt": 50, "sum": 52, "where": 53, "xor_sum": 54, "zero": 55, "do_bench": 57, "perf_report": 58, "model": 60, "creation": 60, "op": 60, "shape": 60, "manipul": 60, "linear": 60, "algebra": 60, "index": 60, "reduct": 60, "atom": 60, "comparison": 60, "random": 60, "number": 60, "gener": 60, "hint": 60}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"Installation": [[0, "installation"]], "Binary Distributions": [[0, "binary-distributions"]], "From Source": [[0, "from-source"]], "Python Package": [[0, "python-package"]], "Vector Addition": [[1, "vector-addition"]], "Compute Kernel": [[1, "compute-kernel"], [2, "compute-kernel"], [3, "compute-kernel"]], "Benchmark": [[1, "benchmark"], [2, "benchmark"], [3, "benchmark"], [5, "benchmark"]], "Fused Softmax": [[2, "fused-softmax"]], "Motivations": [[2, "motivations"], [3, "motivations"], [5, "motivations"], [8, "motivations"], [12, "motivations"]], "Unit Test": [[2, "unit-test"], [3, "unit-test"], [8, "unit-test"]], "Matrix Multiplication": [[3, "matrix-multiplication"]], "Pointer Arithmetics": [[3, "pointer-arithmetics"]], "L2 Cache Optimizations": [[3, "l2-cache-optimizations"]], "Final Result": [[3, "final-result"], [8, "final-result"]], "Square Matrix Performance": [[3, "square-matrix-performance"]], "Low-Memory Dropout": [[4, "low-memory-dropout"]], "Baseline": [[4, "baseline"]], "Seeded dropout": [[4, "seeded-dropout"]], "Exercises": [[4, "exercises"]], "References": [[4, "references"], [5, "references"], [12, "references"], [13, "references"]], "Layer Normalization": [[5, "layer-normalization"]], "Backward pass": [[5, "backward-pass"]], "Fused Attention": [[6, "fused-attention"]], "Libdevice (tl.math) function": [[7, "libdevice-tl-math-function"]], "asin Kernel": [[7, "asin-kernel"]], "Using the default libdevice library path": [[7, "using-the-default-libdevice-library-path"]], "Customize the libdevice library path": [[7, "customize-the-libdevice-library-path"]], "Block Pointer (Experimental)": [[8, "block-pointer-experimental"]], "Make a Block Pointer": [[8, "make-a-block-pointer"]], "Load/Store a Block Pointer": [[8, "load-store-a-block-pointer"]], "Advance a Block Pointer": [[8, "advance-a-block-pointer"]], "Tutorials": [[9, "tutorials"]], "Computation times": [[10, "computation-times"]], "Welcome to Triton\u2019s documentation!": [[11, "welcome-to-triton-s-documentation"]], "Getting Started": [[11, "getting-started"]], "Python API": [[11, "python-api"]], "Going Further": [[11, "going-further"]], "Introduction": [[12, "introduction"]], "Challenges": [[12, "challenges"]], "Related Work": [[13, "related-work"]], "Polyhedral Compilation": [[13, "polyhedral-compilation"]], "Program Representation": [[13, "program-representation"]], "Advantages": [[13, "advantages"], [13, "id16"]], "Limitations": [[13, "limitations"], [13, "id17"]], "Scheduling Languages": [[13, "scheduling-languages"]], "triton.Config": [[14, "triton-config"]], "triton.autotune": [[15, "triton-autotune"]], "triton.heuristics": [[16, "triton-heuristics"]], "triton.jit": [[17, "triton-jit"]], "triton.language.abs": [[18, "triton-language-abs"]], "triton.language.arange": [[19, "triton-language-arange"]], "triton.language.argmax": [[20, "triton-language-argmax"]], "triton.language.argmin": [[21, "triton-language-argmin"]], "triton.language.atomic_add": [[22, "triton-language-atomic-add"]], "triton.language.atomic_cas": [[23, "triton-language-atomic-cas"]], "triton.language.atomic_max": [[24, "triton-language-atomic-max"]], "triton.language.atomic_min": [[25, "triton-language-atomic-min"]], "triton.language.atomic_xchg": [[26, "triton-language-atomic-xchg"]], "triton.language.broadcast_to": [[27, "triton-language-broadcast-to"]], "triton.language.cos": [[28, "triton-language-cos"]], "triton.language.dot": [[29, "triton-language-dot"]], "triton.language.exp": [[30, "triton-language-exp"]], "triton.language.load": [[31, "triton-language-load"]], "triton.language.log": [[32, "triton-language-log"]], "triton.language.max": [[33, "triton-language-max"]], "triton.language.maximum": [[34, "triton-language-maximum"]], "triton.language.min": [[35, "triton-language-min"]], "triton.language.minimum": [[36, "triton-language-minimum"]], "triton.language.multiple_of": [[37, "triton-language-multiple-of"]], "triton.language.num_programs": [[38, "triton-language-num-programs"]], "triton.language.program_id": [[39, "triton-language-program-id"]], "triton.language.rand": [[40, "triton-language-rand"]], "triton.language.randint": [[41, "triton-language-randint"]], "triton.language.randint4x": [[42, "triton-language-randint4x"]], "triton.language.randn": [[43, "triton-language-randn"]], "triton.language.ravel": [[44, "triton-language-ravel"]], "triton.language.reduce": [[45, "triton-language-reduce"]], "triton.language.reshape": [[46, "triton-language-reshape"]], "triton.language.sigmoid": [[47, "triton-language-sigmoid"]], "triton.language.sin": [[48, "triton-language-sin"]], "triton.language.softmax": [[49, "triton-language-softmax"]], "triton.language.sqrt": [[50, "triton-language-sqrt"]], "triton.language.store": [[51, "triton-language-store"]], "triton.language.sum": [[52, "triton-language-sum"]], "triton.language.where": [[53, "triton-language-where"]], "triton.language.xor_sum": [[54, "triton-language-xor-sum"]], "triton.language.zeros": [[55, "triton-language-zeros"]], "triton.testing.Benchmark": [[56, "triton-testing-benchmark"]], "triton.testing.do_bench": [[57, "triton-testing-do-bench"]], "triton.testing.perf_report": [[58, "triton-testing-perf-report"]], "triton": [[59, "triton"]], "triton.language": [[60, "triton-language"]], "Programming Model": [[60, "programming-model"]], "Creation Ops": [[60, "creation-ops"]], "Shape Manipulation Ops": [[60, "shape-manipulation-ops"]], "Linear Algebra Ops": [[60, "linear-algebra-ops"]], "Memory Ops": [[60, "memory-ops"]], "Indexing Ops": [[60, "indexing-ops"]], "Math Ops": [[60, "math-ops"]], "Reduction Ops": [[60, "reduction-ops"]], "Atomic Ops": [[60, "atomic-ops"]], "Comparison ops": [[60, "comparison-ops"]], "Random Number Generation": [[60, "random-number-generation"]], "Compiler Hint Ops": [[60, "compiler-hint-ops"]], "triton.testing": [[61, "triton-testing"]]}, "indexentries": {"config (class in triton)": [[14, "triton.Config"]], "__init__() (triton.config method)": [[14, "triton.Config.__init__"]], "autotune() (in module triton)": [[15, "triton.autotune"]], "heuristics() (in module triton)": [[16, "triton.heuristics"]], "jit() (in module triton)": [[17, "triton.jit"]], "abs() (in module triton.language)": [[18, "triton.language.abs"]], "arange() (in module triton.language)": [[19, "triton.language.arange"]], "argmax() (in module triton.language)": [[20, "triton.language.argmax"]], "argmin() (in module triton.language)": [[21, "triton.language.argmin"]], "atomic_add() (in module triton.language)": [[22, "triton.language.atomic_add"]], "atomic_cas() (in module triton.language)": [[23, "triton.language.atomic_cas"]], "atomic_max() (in module triton.language)": [[24, "triton.language.atomic_max"]], "atomic_min() (in module triton.language)": [[25, "triton.language.atomic_min"]], "atomic_xchg() (in module triton.language)": [[26, "triton.language.atomic_xchg"]], "broadcast_to() (in module triton.language)": [[27, "triton.language.broadcast_to"]], "cos() (in module triton.language)": [[28, "triton.language.cos"]], "dot() (in module triton.language)": [[29, "triton.language.dot"]], "exp() (in module triton.language)": [[30, "triton.language.exp"]], "load() (in module triton.language)": [[31, "triton.language.load"]], "log() (in module triton.language)": [[32, "triton.language.log"]], "max() (in module triton.language)": [[33, "triton.language.max"]], "maximum() (in module triton.language)": [[34, "triton.language.maximum"]], "min() (in module triton.language)": [[35, "triton.language.min"]], "minimum() (in module triton.language)": [[36, "triton.language.minimum"]], "multiple_of() (in module triton.language)": [[37, "triton.language.multiple_of"]], "num_programs() (in module triton.language)": [[38, "triton.language.num_programs"]], "program_id() (in module triton.language)": [[39, "triton.language.program_id"]], "rand() (in module triton.language)": [[40, "triton.language.rand"]], "randint() (in module triton.language)": [[41, "triton.language.randint"]], "randint4x() (in module triton.language)": [[42, "triton.language.randint4x"]], "randn() (in module triton.language)": [[43, "triton.language.randn"]], "ravel() (in module triton.language)": [[44, "triton.language.ravel"]], "reduce() (in module triton.language)": [[45, "triton.language.reduce"]], "reshape() (in module triton.language)": [[46, "triton.language.reshape"]], "sigmoid() (in module triton.language)": [[47, "triton.language.sigmoid"]], "sin() (in module triton.language)": [[48, "triton.language.sin"]], "softmax() (in module triton.language)": [[49, "triton.language.softmax"]], "sqrt() (in module triton.language)": [[50, "triton.language.sqrt"]], "store() (in module triton.language)": [[51, "triton.language.store"]], "sum() (in module triton.language)": [[52, "triton.language.sum"]], "where() (in module triton.language)": [[53, "triton.language.where"]], "xor_sum() (in module triton.language)": [[54, "triton.language.xor_sum"]], "zeros() (in module triton.language)": [[55, "triton.language.zeros"]], "benchmark (class in triton.testing)": [[56, "triton.testing.Benchmark"]], "__init__() (triton.testing.benchmark method)": [[56, "triton.testing.Benchmark.__init__"]], "do_bench() (in module triton.testing)": [[57, "triton.testing.do_bench"]], "perf_report() (in module triton.testing)": [[58, "triton.testing.perf_report"]]}})