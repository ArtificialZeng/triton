Search.setIndex({"docnames": ["getting-started/installation", "getting-started/tutorials/01-vector-add", "getting-started/tutorials/02-fused-softmax", "getting-started/tutorials/03-matrix-multiplication", "getting-started/tutorials/04-low-memory-dropout", "getting-started/tutorials/05-layer-norm", "getting-started/tutorials/06-fused-attention", "getting-started/tutorials/07-math-functions", "getting-started/tutorials/08-experimental-block-pointer", "getting-started/tutorials/index", "getting-started/tutorials/sg_execution_times", "index", "programming-guide/chapter-1/introduction", "programming-guide/chapter-2/related-work", "python-api/generated/triton.Config", "python-api/generated/triton.autotune", "python-api/generated/triton.heuristics", "python-api/generated/triton.jit", "python-api/generated/triton.language.abs", "python-api/generated/triton.language.arange", "python-api/generated/triton.language.argmax", "python-api/generated/triton.language.argmin", "python-api/generated/triton.language.associative_scan", "python-api/generated/triton.language.atomic_add", "python-api/generated/triton.language.atomic_cas", "python-api/generated/triton.language.atomic_max", "python-api/generated/triton.language.atomic_min", "python-api/generated/triton.language.atomic_xchg", "python-api/generated/triton.language.broadcast", "python-api/generated/triton.language.broadcast_to", "python-api/generated/triton.language.cat", "python-api/generated/triton.language.cos", "python-api/generated/triton.language.cumprod", "python-api/generated/triton.language.cumsum", "python-api/generated/triton.language.debug_barrier", "python-api/generated/triton.language.device_assert", "python-api/generated/triton.language.device_print", "python-api/generated/triton.language.dot", "python-api/generated/triton.language.exp", "python-api/generated/triton.language.expand_dims", "python-api/generated/triton.language.fdiv", "python-api/generated/triton.language.full", "python-api/generated/triton.language.load", "python-api/generated/triton.language.log", "python-api/generated/triton.language.max", "python-api/generated/triton.language.max_contiguous", "python-api/generated/triton.language.maximum", "python-api/generated/triton.language.min", "python-api/generated/triton.language.minimum", "python-api/generated/triton.language.multiple_of", "python-api/generated/triton.language.num_programs", "python-api/generated/triton.language.program_id", "python-api/generated/triton.language.rand", "python-api/generated/triton.language.randint", "python-api/generated/triton.language.randint4x", "python-api/generated/triton.language.randn", "python-api/generated/triton.language.ravel", "python-api/generated/triton.language.reduce", "python-api/generated/triton.language.reshape", "python-api/generated/triton.language.sigmoid", "python-api/generated/triton.language.sin", "python-api/generated/triton.language.softmax", "python-api/generated/triton.language.sqrt", "python-api/generated/triton.language.static_assert", "python-api/generated/triton.language.static_print", "python-api/generated/triton.language.static_range", "python-api/generated/triton.language.store", "python-api/generated/triton.language.sum", "python-api/generated/triton.language.trans", "python-api/generated/triton.language.umulhi", "python-api/generated/triton.language.view", "python-api/generated/triton.language.where", "python-api/generated/triton.language.xor_sum", "python-api/generated/triton.language.zeros", "python-api/generated/triton.testing.Benchmark", "python-api/generated/triton.testing.do_bench", "python-api/generated/triton.testing.perf_report", "python-api/triton", "python-api/triton.language", "python-api/triton.testing"], "filenames": ["getting-started/installation.rst", "getting-started/tutorials/01-vector-add.rst", "getting-started/tutorials/02-fused-softmax.rst", "getting-started/tutorials/03-matrix-multiplication.rst", "getting-started/tutorials/04-low-memory-dropout.rst", "getting-started/tutorials/05-layer-norm.rst", "getting-started/tutorials/06-fused-attention.rst", "getting-started/tutorials/07-math-functions.rst", "getting-started/tutorials/08-experimental-block-pointer.rst", "getting-started/tutorials/index.rst", "getting-started/tutorials/sg_execution_times.rst", "index.rst", "programming-guide/chapter-1/introduction.rst", "programming-guide/chapter-2/related-work.rst", "python-api/generated/triton.Config.rst", "python-api/generated/triton.autotune.rst", "python-api/generated/triton.heuristics.rst", "python-api/generated/triton.jit.rst", "python-api/generated/triton.language.abs.rst", "python-api/generated/triton.language.arange.rst", "python-api/generated/triton.language.argmax.rst", "python-api/generated/triton.language.argmin.rst", "python-api/generated/triton.language.associative_scan.rst", "python-api/generated/triton.language.atomic_add.rst", "python-api/generated/triton.language.atomic_cas.rst", "python-api/generated/triton.language.atomic_max.rst", "python-api/generated/triton.language.atomic_min.rst", "python-api/generated/triton.language.atomic_xchg.rst", "python-api/generated/triton.language.broadcast.rst", "python-api/generated/triton.language.broadcast_to.rst", "python-api/generated/triton.language.cat.rst", "python-api/generated/triton.language.cos.rst", "python-api/generated/triton.language.cumprod.rst", "python-api/generated/triton.language.cumsum.rst", "python-api/generated/triton.language.debug_barrier.rst", "python-api/generated/triton.language.device_assert.rst", "python-api/generated/triton.language.device_print.rst", "python-api/generated/triton.language.dot.rst", "python-api/generated/triton.language.exp.rst", "python-api/generated/triton.language.expand_dims.rst", "python-api/generated/triton.language.fdiv.rst", "python-api/generated/triton.language.full.rst", "python-api/generated/triton.language.load.rst", "python-api/generated/triton.language.log.rst", "python-api/generated/triton.language.max.rst", "python-api/generated/triton.language.max_contiguous.rst", "python-api/generated/triton.language.maximum.rst", "python-api/generated/triton.language.min.rst", "python-api/generated/triton.language.minimum.rst", "python-api/generated/triton.language.multiple_of.rst", "python-api/generated/triton.language.num_programs.rst", "python-api/generated/triton.language.program_id.rst", "python-api/generated/triton.language.rand.rst", "python-api/generated/triton.language.randint.rst", "python-api/generated/triton.language.randint4x.rst", "python-api/generated/triton.language.randn.rst", "python-api/generated/triton.language.ravel.rst", "python-api/generated/triton.language.reduce.rst", "python-api/generated/triton.language.reshape.rst", "python-api/generated/triton.language.sigmoid.rst", "python-api/generated/triton.language.sin.rst", "python-api/generated/triton.language.softmax.rst", "python-api/generated/triton.language.sqrt.rst", "python-api/generated/triton.language.static_assert.rst", "python-api/generated/triton.language.static_print.rst", "python-api/generated/triton.language.static_range.rst", "python-api/generated/triton.language.store.rst", "python-api/generated/triton.language.sum.rst", "python-api/generated/triton.language.trans.rst", "python-api/generated/triton.language.umulhi.rst", "python-api/generated/triton.language.view.rst", "python-api/generated/triton.language.where.rst", "python-api/generated/triton.language.xor_sum.rst", "python-api/generated/triton.language.zeros.rst", "python-api/generated/triton.testing.Benchmark.rst", "python-api/generated/triton.testing.do_bench.rst", "python-api/generated/triton.testing.perf_report.rst", "python-api/triton.rst", "python-api/triton.language.rst", "python-api/triton.testing.rst"], "titles": ["Installation", "Vector Addition", "Fused Softmax", "Matrix Multiplication", "Low-Memory Dropout", "Layer Normalization", "Fused Attention", "Libdevice (<cite>tl.math</cite>) function", "Block Pointer (Experimental)", "Tutorials", "Computation times", "Welcome to Triton\u2019s documentation!", "Introduction", "Related Work", "triton.Config", "triton.autotune", "triton.heuristics", "triton.jit", "triton.language.abs", "triton.language.arange", "triton.language.argmax", "triton.language.argmin", "triton.language.associative_scan", "triton.language.atomic_add", "triton.language.atomic_cas", "triton.language.atomic_max", "triton.language.atomic_min", "triton.language.atomic_xchg", "triton.language.broadcast", "triton.language.broadcast_to", "triton.language.cat", "triton.language.cos", "triton.language.cumprod", "triton.language.cumsum", "triton.language.debug_barrier", "triton.language.device_assert", "triton.language.device_print", "triton.language.dot", "triton.language.exp", "triton.language.expand_dims", "triton.language.fdiv", "triton.language.full", "triton.language.load", "triton.language.log", "triton.language.max", "triton.language.max_contiguous", "triton.language.maximum", "triton.language.min", "triton.language.minimum", "triton.language.multiple_of", "triton.language.num_programs", "triton.language.program_id", "triton.language.rand", "triton.language.randint", "triton.language.randint4x", "triton.language.randn", "triton.language.ravel", "triton.language.reduce", "triton.language.reshape", "triton.language.sigmoid", "triton.language.sin", "triton.language.softmax", "triton.language.sqrt", "triton.language.static_assert", "triton.language.static_print", "triton.language.static_range", "triton.language.store", "triton.language.sum", "triton.language.trans", "triton.language.umulhi", "triton.language.view", "triton.language.where", "triton.language.xor_sum", "triton.language.zeros", "triton.testing.Benchmark", "triton.testing.do_bench", "triton.testing.perf_report", "triton", "triton.language", "triton.testing"], "terms": {"you": [0, 1, 2, 3, 4, 5, 7, 8, 9, 12, 15, 36, 53, 71], "can": [0, 1, 2, 3, 4, 5, 7, 8, 12, 13, 15, 36, 42, 66, 76], "latest": 0, "stabl": 0, "releas": [0, 5, 12], "triton": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13], "pip": [0, 9], "wheel": 0, "ar": [0, 1, 2, 3, 4, 5, 8, 12, 13, 14, 15, 17, 39, 42, 45, 49, 64, 66, 71, 74], "avail": [0, 4, 7, 12, 13], "cpython": 0, "3": [0, 1, 2, 3, 4, 5, 6, 8, 13], "7": [0, 1, 3, 5, 13], "11": [0, 1, 3, 5, 8], "pypi": [0, 5], "8": [0, 1, 2, 3, 5, 6, 8, 13, 14, 15, 41, 73], "9": [0, 1, 2, 3, 4, 5], "And": [0, 3], "nightli": 0, "u": [0, 1, 2, 52], "index": [0, 1, 7, 8, 20, 21, 44, 47], "url": 0, "http": [0, 4, 5, 6, 7], "aiinfra": 0, "pkg": 0, "visualstudio": 0, "com": [0, 5, 7], "publicpackag": 0, "_packag": 0, "simpl": [0, 1, 2, 3, 4], "run": [0, 1, 2, 3, 4, 5, 6, 7, 8, 11, 13, 15, 17, 76], "follow": [0, 2, 3, 5, 8, 11, 12, 13, 36], "command": 0, "git": 0, "clone": [0, 5, 6], "github": [0, 5], "openai": 0, "cd": [0, 9], "cmake": 0, "build": [0, 3], "time": [0, 1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 15, 53, 63, 64], "depend": [0, 9, 13, 71], "e": [0, 2, 3, 4, 5, 8, 9, 12, 13, 30, 35, 41, 73], "note": [0, 1, 2, 3, 4, 6, 8, 13, 15, 17, 64, 65, 71], "llvm": [0, 13], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17, 30, 35, 36, 42, 53, 54, 63, 64, 65, 66, 71, 74], "present": 0, "your": [0, 1, 11], "system": [0, 3, 12, 13], "setup": [0, 5], "py": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10], "script": [0, 1, 2, 3, 4, 5, 6, 7, 8], "download": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], "offici": 0, "llvm11": 0, "static": [0, 12, 13], "librari": [0, 3, 12, 13], "link": 0, "against": [0, 1, 2, 3, 5, 8, 11], "test": [0, 1, 5, 6, 11], "unit": [0, 12], "pytest": [0, 6], "v": [0, 5, 6], "benchmark": [0, 6, 15, 76], "bench": [0, 15], "m": [0, 1, 2, 3, 5, 6, 8, 12, 15], "plot": [0, 1, 2, 3, 74], "result": [0, 1, 2, 12, 13, 30, 39], "dir": 0, "tmp": 0, "go": [1, 2, 3, 4, 5, 6, 7, 8, 13], "end": [1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 19, 64, 65], "full": [1, 2, 3, 4, 5, 6, 7, 8], "exampl": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14], "code": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13], "In": [1, 2, 3, 4, 5, 7, 8, 13, 65], "thi": [1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 14, 15, 16, 17, 35, 36, 54, 64, 65, 74], "tutori": [1, 2, 3, 4, 5, 8, 11], "write": [1, 2, 3, 4, 5, 6, 8, 9, 11, 13], "us": [1, 2, 3, 4, 5, 8, 12, 13, 14, 15, 16, 17, 30, 35, 53, 65, 71, 74, 76], "do": [1, 2, 3, 4, 5, 6, 8, 12, 13, 15, 42, 66], "so": [1, 2, 3, 4, 5, 8, 13, 36, 39], "learn": [1, 2, 3, 4, 5, 8, 11, 12, 13], "about": [1, 2, 3, 4, 5, 11], "The": [1, 2, 3, 4, 5, 7, 8, 12, 13, 23, 24, 25, 26, 27, 28, 29, 30, 35, 36, 37, 39, 50, 51, 52, 53, 54, 55, 64, 66, 70, 71, 76], "basic": [1, 9, 13], "program": [1, 2, 3, 4, 5, 8, 11, 12, 50, 51], "model": [1, 5, 12, 13, 15], "jit": [1, 2, 3, 4, 5, 6, 7, 8, 15, 16, 22, 57, 65], "decor": [1, 3, 15, 16, 17], "which": [1, 2, 3, 4, 8, 12, 13, 15, 20, 21, 22, 32, 33, 42, 44, 47, 57, 64, 66, 67, 72, 74], "defin": [1, 2, 3, 13, 42, 66], "best": [1, 12], "practic": [1, 2, 3, 12], "valid": 1, "custom": [1, 2, 3, 11], "op": [1, 2, 30], "nativ": [1, 2, 3, 8], "refer": [1, 6, 7, 8], "implement": [1, 2, 3, 4, 5, 6, 8, 12, 13, 65], "import": [1, 2, 3, 4, 5, 6, 7, 8, 12, 13], "torch": [1, 2, 3, 4, 5, 6, 7, 8], "languag": [1, 2, 3, 4, 5, 6, 7, 8, 11, 12], "tl": [1, 2, 3, 4, 5, 6, 8, 9, 10, 35, 36, 39, 41, 63, 64, 65, 73], "def": [1, 2, 3, 4, 5, 6, 7, 8, 15, 16, 65], "add_kernel": 1, "x_ptr": [1, 4, 7, 15, 16], "pointer": [1, 2, 4, 5, 6, 9, 10, 17, 23, 24, 25, 26, 27, 42, 66], "first": [1, 3, 4, 5, 8, 11, 13, 28, 30, 36, 37, 45, 46, 48], "input": [1, 2, 3, 4, 5, 7, 8, 13, 15, 16, 18, 20, 21, 22, 28, 29, 30, 31, 32, 33, 37, 38, 39, 43, 44, 45, 46, 47, 48, 49, 56, 57, 58, 59, 60, 61, 62, 67, 68, 70, 72], "y_ptr": [1, 7], "second": [1, 2, 3, 4, 5, 6, 7, 8, 13, 28, 30, 35, 37, 46, 48], "output_ptr": [1, 2, 4], "output": [1, 2, 3, 4, 5, 6, 7, 8], "n_element": [1, 4, 7], "size": [1, 2, 4, 5, 7, 13], "block_siz": [1, 2, 4, 5, 7, 13, 15, 16, 63, 64], "constexpr": [1, 2, 3, 4, 5, 6, 7, 8, 52, 53, 54, 55], "number": [1, 2, 3, 4, 5, 13, 14, 15, 50, 52, 53, 54, 55], "element": [1, 2, 3, 4, 5, 8, 18, 20, 21, 22, 30, 31, 32, 33, 38, 42, 43, 44, 46, 47, 48, 57, 59, 60, 61, 62, 66, 67, 70, 71, 72, 74], "each": [1, 2, 3, 4, 5, 8, 12, 13, 14, 16, 22, 39], "should": [1, 3, 5, 8, 12, 13, 14, 20, 21, 22, 32, 33, 36, 42, 44, 47, 57, 66, 67, 72, 74], "process": [1, 12, 13], "shape": [1, 2, 3, 4, 5, 6, 8, 13, 28, 29, 39, 41, 42, 58, 66, 70, 71, 73], "valu": [1, 2, 3, 4, 6, 7, 8, 15, 16, 18, 19, 20, 21, 23, 24, 25, 26, 27, 31, 32, 33, 35, 36, 38, 41, 42, 43, 44, 45, 47, 49, 59, 60, 61, 62, 64, 65, 66, 67, 71, 72, 73, 74, 76], "There": 1, "multipl": [1, 4, 5, 8, 9, 10, 12, 13, 14, 15, 49, 53], "differ": [1, 2, 3, 4, 7, 8, 12, 13, 15, 70, 74], "data": [1, 3, 4, 5, 6, 7, 8, 12, 13, 23, 24, 25, 26, 27, 41, 42, 66, 71, 73], "we": [1, 2, 3, 4, 5, 7, 8, 12, 13], "identifi": 1, "here": [1, 2, 3, 5, 6, 8], "pid": [1, 3, 4, 5, 7, 8, 35, 36], "program_id": [1, 2, 3, 4, 5, 6, 7, 8], "axi": [1, 2, 3, 4, 5, 6, 7, 8, 20, 21, 22, 32, 33, 39, 44, 47, 50, 51, 57, 67, 72, 74], "0": [1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 13, 32, 33, 35, 50, 51, 52, 55, 73], "1d": [1, 2, 3, 8], "launch": [1, 2, 3, 8, 50, 51], "grid": [1, 2, 3, 4, 5, 6, 7, 8, 50, 51], "offset": [1, 4, 5, 6, 7, 8, 52, 53, 54, 55], "from": [1, 2, 3, 4, 6, 7, 8, 12, 13, 35, 36, 42, 71], "initi": [1, 3, 6], "For": [1, 3, 5, 7, 8, 12, 13, 14], "instanc": [1, 2, 3, 4, 5, 12, 14, 50, 51], "had": 1, "length": [1, 6, 39], "256": [1, 2, 3, 5, 8, 14], "64": [1, 3, 5, 6, 8], "would": [1, 2, 4], "access": [1, 8, 12, 13, 17, 42, 66], "128": [1, 2, 3, 5, 6, 8, 15], "192": 1, "list": [1, 3, 15, 16, 74, 76], "block_start": [1, 4, 7], "arang": [1, 2, 3, 4, 5, 6, 7], "creat": [1, 2, 3, 5, 8, 12], "mask": [1, 2, 3, 4, 5, 7, 8, 23, 25, 26, 27, 42, 66, 71], "guard": [1, 2], "memori": [1, 2, 3, 8, 9, 10, 12, 13, 23, 24, 25, 26, 27, 42, 66, 71], "oper": [1, 2, 3, 4, 5, 7, 9, 12, 23, 24, 25, 26, 27, 71], "out": [1, 3, 6, 8, 11, 13, 42, 66], "bound": [1, 2, 3, 8, 13, 42, 66], "load": [1, 2, 3, 4, 5, 6, 7, 13, 71], "x": [1, 2, 3, 4, 5, 7, 8, 13, 18, 31, 38, 40, 43, 46, 48, 56, 59, 60, 61, 62, 69, 71, 74], "y": [1, 2, 3, 5, 13, 40, 46, 48, 69, 71, 74], "dram": [1, 2], "ani": [1, 2, 3, 8, 13, 15, 16, 35, 36, 74], "extra": [1, 3, 8], "case": [1, 2, 3, 12, 13, 16, 20, 21, 23, 24, 25, 26, 27, 42, 44, 47, 66], "block": [1, 2, 3, 4, 6, 9, 10, 12, 13, 18, 23, 24, 25, 26, 27, 28, 29, 30, 31, 34, 37, 38, 42, 43, 46, 48, 52, 53, 54, 55, 56, 59, 60, 61, 62, 66, 71], "back": [1, 2, 3, 4, 6, 8], "store": [1, 2, 3, 4, 5, 6, 7, 23, 24, 25, 26, 27, 71], "let": [1, 2, 4, 5, 8, 45, 49], "": [1, 2, 4, 5, 8, 13, 54, 65], "also": [1, 2, 3, 4, 5, 7, 12, 13, 65], "declar": 1, "helper": [1, 2], "function": [1, 2, 3, 4, 5, 6, 8, 9, 10, 13, 14, 15, 16, 17, 22, 35, 36, 57, 65, 74, 76], "1": [1, 2, 3, 4, 5, 6, 8, 11, 13, 16, 39, 50, 51, 52, 55], "alloc": [1, 2, 3, 5, 8, 12], "z": [1, 2, 6, 13], "tensor": [1, 2, 3, 4, 5, 7, 8, 12, 13, 15, 20, 21, 22, 28, 29, 30, 32, 33, 35, 36, 37, 39, 41, 42, 44, 46, 47, 48, 56, 57, 66, 67, 70, 71, 72, 73], "2": [1, 2, 3, 4, 5, 6, 7, 8, 11, 13, 14, 16, 50, 51], "enqueu": [1, 2, 5], "abov": [1, 2, 3, 4, 8, 13, 15], "appropri": 1, "add": [1, 4, 10, 23, 39], "need": [1, 2, 3, 4, 5, 8, 53], "prealloc": 1, "empty_lik": [1, 2, 4, 5, 6, 7], "assert": [1, 2, 3, 4, 5, 6, 7, 8, 35, 63], "is_cuda": [1, 7], "numel": [1, 4, 5, 7], "spmd": [1, 12, 13], "denot": [1, 5], "parallel": [1, 2, 3, 4, 5, 11, 12, 13, 14], "It": [1, 3, 4, 5, 9, 11, 13, 15, 17], "analog": 1, "cuda": [1, 2, 3, 4, 5, 6, 7, 8, 12], "either": [1, 50, 51, 71], "tupl": [1, 22, 29, 41, 42, 57, 66, 70, 73], "int": [1, 12, 13, 15, 16, 17, 29, 39, 41, 42, 50, 51, 66, 70, 73], "callabl": [1, 16, 17], "metaparamet": 1, "where": [1, 3, 4, 5, 6, 8, 13, 16, 66], "lambda": [1, 2, 3, 4, 5, 6, 7, 8, 16], "meta": [1, 2, 3, 4, 5, 7, 8, 14, 15, 16], "cdiv": [1, 3, 4, 5, 6, 7, 8], "object": [1, 3, 12, 14, 15, 23, 24, 25, 26, 27], "implicitli": [1, 17, 42, 66], "convert": [1, 3, 8, 17], "its": [1, 2, 3, 8, 13, 15], "ed": [1, 3], "obtain": 1, "gpu": [1, 2, 4, 6, 11, 12, 13, 14, 17], "don": [1, 2], "t": [1, 2, 3, 5, 6, 13, 17, 20, 21, 44, 47], "forget": 1, "pass": [1, 7, 8, 13, 14, 15], "paramet": [1, 3, 8, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 37, 38, 39, 41, 42, 43, 44, 46, 47, 48, 50, 51, 52, 53, 54, 55, 56, 57, 59, 60, 61, 62, 64, 65, 66, 67, 70, 71, 72, 73, 74, 76], "keyword": [1, 14], "argument": [1, 2, 3, 8, 14, 15, 16, 17, 35, 36, 64, 71, 74], "1024": [1, 3, 4, 5, 6, 7, 15, 63], "return": [1, 2, 3, 4, 5, 6, 8, 15, 19, 20, 21, 23, 24, 25, 26, 27, 32, 33, 37, 41, 42, 44, 47, 50, 51, 52, 53, 54, 55, 56, 67, 70, 71, 72, 73, 76], "handl": [1, 2, 3, 4, 13], "sinc": [1, 2, 3, 5, 8], "synchron": [1, 12, 34], "hasn": 1, "been": [1, 12, 13], "call": [1, 3, 7, 13, 14, 17, 35, 36, 53, 64], "still": [1, 2, 3, 8, 13], "asynchron": [1, 12], "point": [1, 13, 54], "now": [1, 3, 5, 6, 8], "wise": [1, 2, 5, 6, 18, 31, 38, 42, 43, 46, 48, 59, 60, 61, 62, 66], "sum": [1, 2, 5, 6, 72], "two": [1, 2, 3, 8, 13, 15, 16, 19, 22, 28, 37, 57], "correct": [1, 6, 7], "manual_se": [1, 2, 3, 6, 7, 8], "98432": [1, 7], "rand": [1, 4, 5, 7], "devic": [1, 2, 3, 5, 6, 7, 8, 35, 36], "output_torch": [1, 7], "output_triton": [1, 7], "print": [1, 3, 4, 6, 7, 8, 35, 36, 64], "f": [1, 2, 3, 6, 7, 8, 13, 35, 64], "maximum": [1, 2, 6, 7, 20, 44], "between": [1, 7, 12], "max": [1, 2, 5, 6, 7, 25], "ab": [1, 7], "3713": 1, "3076": 1, "4940": 1, "6724": 1, "2141": 1, "9733": 1, "seem": [1, 13], "like": [1, 4, 6, 8, 12, 13, 53], "re": [1, 3], "good": [1, 13], "our": [1, 2, 3, 5, 8, 12], "increas": [1, 2, 3, 4, 5, 8], "get": [1, 2, 3, 4, 8, 10], "sens": [1, 12, 13], "how": [1, 2, 3, 5, 8, 11, 12, 16], "doe": [1, 2, 3, 8, 13, 30, 36, 63], "rel": [1, 13], "pytorch": [1, 2, 4, 5], "To": [1, 4, 5, 8, 9, 12, 13, 15], "make": [1, 2, 12, 13], "thing": [1, 4], "easier": [1, 2, 12], "ha": [1, 3, 4, 8, 12, 13, 50, 51, 64], "set": [1, 3, 4, 5, 8, 13, 35, 63], "built": [1, 13], "util": [1, 5, 8], "allow": [1, 2, 8, 12, 13, 30], "concis": [1, 74], "perform": [1, 2, 4, 5, 8, 12, 13, 15, 23, 24, 25, 26, 27], "problem": [1, 8], "perf_report": [1, 2, 3, 5, 6, 74], "x_name": [1, 2, 3, 5, 6, 74], "name": [1, 2, 3, 15, 16, 74], "an": [1, 2, 3, 4, 7, 8, 12, 13, 14, 23, 24, 25, 26, 27, 52, 53, 54, 55], "x_val": [1, 2, 3, 5, 6, 74], "rang": [1, 2, 3, 5, 6, 8, 12, 13, 65], "12": [1, 3, 5], "28": [1, 3, 5, 8], "possibl": [1, 2, 3, 13, 14], "x_log": [1, 74], "true": [1, 2, 3, 5, 6, 20, 21, 30, 37, 44, 47, 71, 75], "logarithm": [1, 43], "line_arg": [1, 2, 3, 5, 6, 74], "provid": [1, 2, 3, 4, 5, 6, 11, 13, 15, 20, 21, 22, 32, 33, 35, 36, 44, 47, 57, 67, 72], "whose": [1, 2, 3, 4, 13, 15, 42], "correspond": [1, 2, 3, 44, 47, 74], "line": [1, 2, 3, 4, 13, 74], "line_v": [1, 2, 3, 5, 6, 74], "line_nam": [1, 2, 3, 5, 6, 74], "label": [1, 2, 3, 74], "style": [1, 2, 3, 5, 6, 74], "blue": [1, 2, 3, 5, 6], "green": [1, 2, 3, 5], "ylabel": [1, 2, 3, 5, 6, 74], "gb": [1, 2, 5], "plot_nam": [1, 2, 3, 5, 6, 74], "file": [1, 2, 3, 10, 64], "save": [1, 2, 3, 6], "arg": [1, 2, 3, 5, 6, 14, 16, 36, 74], "y_name": [1, 2], "dtype": [1, 2, 3, 5, 6, 8, 17, 23, 24, 25, 26, 27, 41, 42, 66, 73], "float32": [1, 2, 3, 4, 5, 6, 8, 37, 52, 55], "quantil": [1, 2, 3, 5, 75], "5": [1, 2, 3, 4, 5, 8, 13], "min_m": [1, 2, 3, 5], "max_m": [1, 2, 3, 5], "do_bench": [1, 2, 3, 5, 6], "gbp": [1, 2, 5], "1e": [1, 2, 3, 5, 6, 8], "6": [1, 3, 5, 8], "print_data": [1, 2, 3, 5, 6], "see": [1, 2, 3, 4, 6, 8, 13], "show_plot": [1, 2, 3], "them": [1, 8], "save_path": [1, 5, 6], "path": 1, "disk": 1, "along": [1, 3, 8, 20, 21, 22, 32, 33, 44, 47, 50, 51, 57, 67, 72], "raw": 1, "csv": 1, "4096": [1, 2, 3, 5, 6], "000000": 1, "8192": [1, 5, 6], "15": [1, 3, 5, 8], "999999": 1, "16384": 1, "31": 1, "32768": 1, "63": [1, 3], "999998": 1, "4": [1, 2, 3, 5, 6, 8, 13, 14, 15, 53], "65536": [1, 5], "127": 1, "999995": 1, "131072": [1, 19], "219": [1, 3], "428568": 1, "262144": 1, "384": [1, 2, 3], "000001": 1, "524288": 1, "614": 1, "400016": 1, "1048576": 1, "819": 1, "200021": 1, "2097152": 1, "1068": [1, 2], "521715": [1, 2], "1023": 1, "999964": 1, "10": [1, 3, 4, 5, 6, 7, 8, 52, 53, 54, 55, 65], "4194304": 1, "1228": 1, "800031": 1, "8388608": 1, "1424": 1, "695621": 1, "1404": 1, "342820": 1, "16777216": 1, "1560": 1, "380965": 1, "1548": 1, "094408": 1, "13": [1, 3, 5, 6, 8], "33554432": 1, "1631": 1, "601649": 1, "1624": 1, "859540": 1, "14": [1, 3, 5, 6], "67108864": 1, "1669": 1, "706983": 1, "1662": 1, "646960": 1, "134217728": 1, "1685": 1, "813499": 1, "1680": 1, "410210": 1, "total": [1, 2, 3, 4, 5, 6, 7, 8, 10], "minut": [1, 2, 3, 4, 5, 6, 7, 8], "041": [1, 10], "python": [1, 2, 3, 4, 5, 6, 7, 8, 9, 17, 35, 36, 64, 65], "sourc": [1, 2, 3, 4, 5, 6, 7, 8, 9, 13], "01": [1, 3, 10], "jupyt": [1, 2, 3, 4, 5, 6, 7, 8, 9], "notebook": [1, 2, 3, 4, 5, 6, 7, 8, 9], "ipynb": [1, 2, 3, 4, 5, 6, 7, 8], "galleri": [1, 2, 3, 4, 5, 6, 7, 8, 9], "gener": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 52, 53, 54, 55, 74], "sphinx": [1, 2, 3, 4, 5, 6, 7, 8, 9], "significantli": 2, "faster": [2, 5, 53], "than": [2, 3, 5, 12, 13, 19, 53, 74], "particular": [2, 3, 8], "class": [2, 5, 6, 12, 13, 14, 65, 74], "matric": [2, 3, 8], "those": 2, "row": [2, 3, 4, 5, 6, 8], "fit": 2, "sram": [2, 3, 5, 6], "benefit": [2, 12, 13], "fusion": [2, 13], "bandwidth": 2, "reduct": [2, 5, 20, 21, 22, 30, 44, 47, 57, 67, 72], "elementwis": 2, "addit": [2, 9, 10, 12, 65], "education": 2, "valuabl": 2, "won": 2, "veri": [2, 3, 4, 13], "far": 2, "consid": 2, "instead": [2, 64, 71], "numer": [2, 5, 12], "stabil": [2, 5], "naive_softmax": 2, "subtract": [2, 5], "order": [2, 3, 8, 9, 13, 30, 35, 70], "avoid": [2, 5, 15, 71], "overflow": 2, "invari": [2, 13], "shift": 2, "read": [2, 3, 9], "mn": 2, "x_max": 2, "dim": [2, 5, 6, 13], "none": [2, 3, 5, 6, 14, 15, 17, 23, 24, 25, 26, 27, 42, 44, 47, 64, 65, 66, 67, 72, 74, 75], "exp": [2, 6], "denomin": [2, 5], "ret": 2, "5mn": 2, "2m": 2, "wrote": 2, "3mn": 2, "when": [2, 3, 4, 5, 8, 12, 13, 14, 15, 17, 71], "naiv": [2, 4], "r": 2, "n": [2, 3, 5, 8, 12, 55, 64], "requir": [2, 4, 13, 35, 36, 63, 64], "obvious": 2, "wast": 2, "d": [2, 4, 6, 15, 17], "prefer": 2, "have": [2, 4, 5, 8, 12, 13, 17, 35, 37, 71, 74], "onli": [2, 3, 4, 5, 6, 8, 12, 13, 17, 30], "onc": [2, 12, 13], "all": [2, 3, 4, 5, 7, 9, 12, 13, 15, 20, 21, 32, 33, 34, 36, 44, 47, 49, 57, 67, 72, 74], "necessari": [2, 8], "chip": [2, 6], "byte": 2, "could": [2, 13, 42, 66], "expect": [2, 23, 24, 25, 26, 27], "theoret": 2, "speed": 2, "up": [2, 5, 8], "4x": 2, "8mn": 2, "4m": 2, "2mn": 2, "flag": 2, "aim": [2, 11], "kind": 2, "automat": [2, 3, 7, 12, 13, 14], "later": [2, 3, 13], "ideal": 2, "work": [2, 4, 6, 11, 12, 36], "matrix": [2, 4, 8, 9, 10, 12, 13, 14, 37], "normal": [2, 6, 9, 10, 36], "one": [2, 3, 4, 5, 8, 9, 12, 13, 42, 74], "limit": [2, 4, 8], "must": [2, 3, 8, 19, 22, 35, 36, 37, 42, 57, 66, 71], "power": [2, 4, 13, 16, 19], "intern": [2, 13], "pad": [2, 3, 42], "properli": 2, "want": [2, 4, 36, 71], "softmax_kernel": 2, "input_ptr": 2, "input_row_strid": 2, "output_row_strid": 2, "n_col": 2, "independ": [2, 5, 13], "across": [2, 4, 5, 12, 13], "row_idx": 2, "stride": [2, 3, 4, 5, 6, 8], "repres": [2, 3, 8, 13, 14], "much": [2, 3, 5, 8], "advanc": [2, 3, 12], "row_start_ptr": 2, "next": [2, 3, 8], "greater": 2, "singl": [2, 4, 12, 42, 53, 66], "col_offset": 2, "mai": [2, 8, 13, 16, 70], "other": [2, 3, 4, 5, 8, 11, 13, 17, 28, 30, 37, 42, 46, 48], "float": [2, 6, 7, 12, 13], "inf": [2, 6], "row_minus_max": 2, "exponenti": [2, 38], "fast": [2, 12, 13], "approxim": 2, "think": 2, "__expf": 2, "softmax_output": 2, "output_row_start_ptr": 2, "given": [2, 3, 4, 5, 28, 29, 30, 41, 50, 51, 52, 53, 54, 55, 73], "n_row": 2, "smallest": [2, 16], "column": [2, 3, 5], "next_power_of_2": [2, 5], "anoth": [2, 5, 13], "trick": 2, "ask": 2, "compil": [2, 3, 8, 11, 12, 14, 17, 30, 45, 49, 63, 64, 65], "more": [2, 3, 4, 5, 8, 11, 12, 13, 74], "thread": [2, 12, 14, 34], "per": [2, 4, 5], "warp": [2, 5, 14], "num_warp": [2, 3, 5, 6, 8, 14, 15], "over": [2, 4, 6, 12, 13], "distribut": [2, 4, 13], "auto": [2, 3, 13, 14, 15, 16], "tune": [2, 3, 13, 15, 16], "natur": [2, 12, 43], "wai": [2, 3, 4, 5, 8], "come": [2, 3, 13], "manual": [2, 8, 13], "heurist": [2, 5], "yourself": [2, 3], "2048": [2, 3, 5, 6], "16": [2, 3, 5, 6, 8, 13, 41, 73], "o": [2, 4, 6], "sure": 2, "irregular": [2, 13], "verifi": [2, 13], "mechan": [2, 13], "randn": [2, 3, 4, 5, 6, 8], "1823": 2, "781": 2, "y_triton": 2, "y_torch": 2, "allclos": [2, 3, 5, 6, 8], "As": [2, 3, 4, 12, 13], "ident": 2, "assum": [2, 74], "compar": [2, 3, 4, 5, 6, 11, 13, 23, 24, 25, 26, 27], "100": [2, 6, 15, 75], "nelement": 2, "element_s": [2, 5], "682": 2, "666643": 2, "744": 2, "727267": 2, "264": 2, "258068": 2, "877": 2, "714274": 2, "332": 2, "108094": 2, "512": [2, 3, 4, 5, 8], "910": 2, "222190": 2, "372": [2, 5], "363633": [2, 5], "640": [2, 3], "975": [2, 5], "238103": [2, 5], "409": [2, 5], "600010": 2, "768": [2, 3], "983": 2, "040025": 2, "431": 2, "157886": 2, "93": 2, "12160": 2, "1588": 2, "244879": 2, "1066": 2, "082150": 2, "590": 2, "470399": 2, "94": 2, "12288": [2, 5], "1598": 2, "438956": 2, "1013": 2, "443336": 2, "593": 2, "085987": 2, "95": 2, "12416": 2, "1576": 2, "634933": 2, "1026": 2, "645975": 2, "359582": 2, "96": [2, 5], "12544": 2, "1580": 2, "346374": 2, "1016": 2, "222759": 2, "589": 2, "872152": 2, "97": 2, "12672": 2, "1577": 2, "836533": 2, "1008": [2, 5], "716405": 2, "253282": 2, "98": 2, "confirm": 2, "suspicion": 2, "notic": [2, 13], "being": [2, 4], "understand": 2, "maintain": [2, 13], "howev": [2, 8, 13], "38": [2, 10], "304": [2, 10], "02": [2, 10], "short": 3, "high": [3, 5, 12, 13], "fp16": [3, 8], "achiev": [3, 12, 13], "cubla": [3, 8, 12], "specif": [3, 5, 8, 12], "level": [3, 12, 13], "multi": [3, 12, 13], "dimension": [3, 13, 37], "improv": [3, 4, 5], "hit": 3, "rate": 3, "kei": [3, 8, 12, 15], "most": [3, 13, 20, 21, 44, 47], "modern": [3, 11, 12, 13], "thei": [3, 12, 13, 17, 36], "notori": [3, 12], "hard": 3, "henc": 3, "done": [3, 8, 12, 20, 21, 22, 32, 33, 44, 47, 57, 67, 72], "hardwar": [3, 8, 11, 13], "vendor": 3, "themselv": 3, "part": [3, 4, 13], "g": [3, 4, 5, 8, 12, 13, 30, 35, 41, 73], "unfortun": [3, 13], "often": 3, "proprietari": 3, "cannot": [3, 12, 13], "easili": 3, "accommod": [3, 8], "deep": [3, 4, 12, 13], "workload": [3, 8, 14], "fuse": [3, 5, 9, 10], "activ": 3, "effici": [3, 4, 5, 12, 54], "easi": [3, 4], "extend": [3, 4], "roughli": 3, "speak": 3, "algorithm": [3, 4, 6, 8, 12, 13], "multipli": [3, 4, 8, 13, 37], "k": [3, 4, 6, 7, 8, 12, 13], "block_size_m": [3, 5, 8], "block_size_n": [3, 5, 8], "acc": [3, 6, 12, 13], "zero": [3, 4, 5, 6, 7, 8, 15, 42], "block_size_k": [3, 8], "A": [3, 4, 8, 12, 13, 41], "b": [3, 5, 8, 12, 13], "dot": [3, 5, 6, 8], "c": [3, 8, 12, 13], "iter": [3, 5, 8, 12, 13, 17, 65], "doubli": 3, "nest": [3, 13], "loop": [3, 6, 8, 13, 14, 65], "dedic": 3, "actual": [3, 5, 12, 13], "fairli": 3, "straightforward": [3, 5], "main": [3, 12, 13], "difficulti": [3, 12], "locat": [3, 23, 24, 25, 26, 27, 42, 66], "inner": [3, 8, 37], "major": [3, 8, 13], "2d": [3, 5, 8, 37], "j": [3, 13], "stride_xi": 3, "stride_xj": 3, "therefor": 3, "pseudo": [3, 4, 54], "a_ptr": [3, 8], "b_ptr": [3, 8], "mean": [3, 5, 6, 8, 13, 15, 75], "modulo": 3, "some": [3, 8], "useless": 3, "contribut": 3, "dimens": [3, 8, 20, 21, 22, 32, 33, 37, 39, 42, 44, 47, 57, 66, 67, 72], "semant": [3, 7, 8, 13, 65], "offs_am": 3, "pid_m": [3, 8], "offs_bn": 3, "pid_n": [3, 8], "offs_k": [3, 6], "stride_am": [3, 8], "stride_ak": [3, 8], "stride_bk": [3, 8], "stride_bn": [3, 8], "updat": [3, 6, 13, 15, 22], "mention": 3, "rememb": 3, "matter": [3, 12, 13, 30], "affect": 3, "grid_m": 3, "grid_n": 3, "just": [3, 13, 16], "cut": 3, "One": 3, "solut": 3, "promot": [3, 8, 13], "reus": [3, 8], "super": 3, "group": [3, 8, 22, 57], "group_m": 3, "befor": [3, 5, 14, 15, 23, 24, 25, 26, 27, 36], "switch": 3, "id": [3, 5, 8, 51], "num_pid_m": [3, 8], "num_pid_n": [3, 8], "num_pid_in_group": [3, 8], "group_size_m": [3, 5, 8], "group_id": [3, 8], "first_pid_m": [3, 8], "If": [3, 4, 13, 30, 53, 66, 71, 74], "isn": 3, "divis": [3, 5], "last": 3, "smaller": [3, 4], "min": [3, 5, 8, 26], "within": [3, 17, 19], "col": [3, 5, 6, 13], "matmul": [3, 6, 8, 13], "90": 3, "54": 3, "architectur": [3, 12], "220": 3, "245": 3, "tflop": 3, "a100": [3, 13], "autotun": [3, 8, 13], "consum": 3, "config": [3, 6, 8, 15], "configur": [3, 14, 15, 76], "option": [3, 15, 42, 66, 74], "try": [3, 5, 6, 7, 14], "chang": [3, 4, 8, 15, 42, 66], "trigger": [3, 15], "evalu": [3, 4, 15, 71], "num_stag": [3, 6, 8, 14, 15], "32": [3, 5, 6, 8, 14], "matmul_kernel": 3, "c_ptr": [3, 8], "variabl": [3, 8, 14, 35, 63], "ptr": [3, 8], "move": [3, 5, 8], "down": [3, 8, 13], "stride_cm": [3, 8], "stride_cn": [3, 8], "map": [3, 5, 8, 64], "section": [3, 8, 13], "detail": [3, 8, 13], "direct": [3, 8], "accumul": [3, 5, 6, 8, 13], "fp32": [3, 8, 37], "higher": [3, 8], "accuraci": [3, 8, 12], "after": [3, 5, 8], "check": [3, 8, 11, 42, 66], "arbitrari": 3, "while": [3, 5, 12, 30, 42], "leaky_relu": 3, "float16": [3, 5, 6, 8, 37, 41, 73], "offs_cm": 3, "offs_cn": 3, "c_mask": 3, "_matmul": 3, "conveni": [3, 8], "wrapper": [3, 8], "take": [3, 4, 5, 8, 11, 15, 16], "constraint": [3, 6, 8, 13], "incompat": [3, 8, 13], "is_contigu": [3, 4, 8], "contigu": [3, 6, 8, 19, 45, 56], "empti": [3, 5, 6, 8, 42, 66], "own": [3, 8], "triton_output": [3, 8], "torch_output": [3, 8], "atol": [3, 5, 6, 8], "rtol": [3, 5, 6, 8], "match": [3, 8, 23, 24, 25, 26, 27, 36], "els": [3, 5, 6, 8], "9531": [3, 8], "7109": [3, 8], "6953": [3, 8], "4062": [3, 8], "3320": [3, 8], "26": [3, 5, 8], "4219": [3, 8], "8438": [3, 8], "0469": [3, 8], "4297": [3, 8], "2969": [3, 8], "5312": [3, 8], "30": [3, 8], "7500": [3, 8], "2578": [3, 8], "8516": [3, 8], "18": [3, 5, 8], "0781": [3, 8], "21": [3, 5, 8], "7656": [3, 8], "6406": [3, 8], "2031": [3, 8], "40": [3, 8], "2812": [3, 8], "6094": [3, 8], "25": [3, 5, 6, 8, 15, 75], "7598": [3, 8], "2441": [3, 8], "41": [3, 8, 10], "0000": [3, 8], "1211": [3, 8], "8281": [3, 8], "4844": [3, 8], "0312": [3, 8], "24": [3, 5, 8], "7031": [3, 8], "0234": [3, 8], "17": [3, 5, 8], "0938": [3, 8], "19": [3, 5, 8], "3831": [3, 8], "5469": [3, 8], "2344": [3, 8], "2188": [3, 8], "focu": [3, 5, 13], "feel": 3, "free": 3, "arrang": 3, "wish": [3, 13], "33": 3, "perf": 3, "096000": 3, "059200": 3, "288000": 3, "214401": 3, "23": [3, 5], "831273": 3, "42": 3, "666665": 3, "39": 3, "384616": 3, "195428": 3, "58": 3, "982401": 3, "896": 3, "78": 3, "051553": 3, "82": 3, "642822": 3, "110": 3, "376426": 3, "99": 3, "864382": 3, "1152": 3, "135": [3, 5], "726544": 3, "129": 3, "825388": 3, "1280": 3, "163": 3, "840004": 3, "1408": 3, "155": 3, "765024": 3, "136": 3, "294403": 3, "1536": [3, 5], "181": 3, "484314": 3, "157": 3, "286398": 3, "1664": 3, "183": 3, "651271": 3, "179": 3, "978245": 3, "1792": 3, "172": 3, "914215": 3, "208": 3, "137481": 3, "1920": 3, "206": 3, "328356": 3, "168": 3, "585369": 3, "199": 3, "728763": 3, "190": 3, "650180": 3, "2176": 3, "193": 3, "496618": 3, "211": 3, "827867": 3, "2304": 3, "231": 3, "921091": 3, "227": 3, "503545": 3, "2432": 3, "203": 3, "583068": 3, "200": 3, "674737": 3, "2560": [3, 5], "221": 3, "405396": 3, "217": 3, "006622": 3, "2688": 3, "196": 3, "544332": 3, "195": 3, "531224": 3, "20": [3, 5, 6], "2816": 3, "680416": 3, "2944": 3, "218": 3, "579083": 3, "225": 3, "502413": 3, "22": [3, 5], "3072": [3, 5], "209": 3, "715208": 3, "207": 3, "410628": 3, "3200": 3, "214": 3, "046818": 3, "178074": 3, "3328": 3, "202": 3, "792385": 3, "871539": 3, "3456": 3, "216": 3, "143621": 3, "212": 3, "721813": 3, "3584": [3, 5], "772251": 3, "889773": 3, "27": [3, 5], "3712": 3, "210": 3, "089046": 3, "554602": 3, "3840": 3, "101127": 3, "651436": 3, "29": [3, 5, 10], "3968": 3, "386099": 3, "511464": 3, "310012": 3, "748370": 3, "184": [3, 10], "03": [3, 10], "state": [4, 12, 13], "compos": [4, 12], "int32": [4, 5, 6, 19, 53, 54], "tradit": [4, 12, 13], "bit": [4, 5], "same": [4, 5, 7, 8, 12, 35, 36, 64, 70, 71, 74], "random": [4, 52, 53, 54, 55], "wa": [4, 5], "introduc": [4, 5], "srivastava2014": 4, "neural": [4, 5, 12, 13], "network": [4, 5, 12, 13], "regim": 4, "regular": [4, 13], "vector": [4, 5, 9, 10, 12, 13], "produc": [4, 5], "scalar": [4, 12, 22, 36, 37, 41, 42, 52, 53, 54, 55, 57, 66, 73], "probabl": [4, 13], "p": [4, 6, 13], "otherwis": [4, 71], "copi": [4, 12, 23, 24, 25, 26, 27], "forc": 4, "well": [4, 12, 13], "even": [4, 13], "At": [4, 13], "norm": [4, 5, 10], "bad": 4, "lead": [4, 12, 13], "artifici": 4, "decreas": 4, "softmax": [4, 6, 9, 10], "temperatur": 4, "prevent": [4, 13], "frac": [4, 5], "keep": 4, "consist": 4, "regardless": [4, 71], "look": [4, 5, 8, 11, 12], "tabul": 4, "_dropout": 4, "x_keep_ptr": 4, "x_keep": 4, "below": [4, 9, 13], "crucial": 4, "describ": [4, 13], "paragraph": 4, "tolist": 4, "541": 4, "293429": 4, "17879": 4, "568431": 4, "08452": 4, "3986": 4, "403347": 4, "838026": 4, "719258": 4, "403344": 4, "08199": 4, "586858": 4, "13686": 4, "79719": 4, "806694": 4, "fine": 4, "awkward": 4, "deal": 4, "firstli": 4, "backpropag": 4, "secondli": 4, "manag": [4, 8, 12], "tricki": 4, "recomput": [4, 6, 12], "checkpoint": 4, "preserve_rng_st": 4, "org": [4, 6], "doc": [4, 7], "html": [4, 7], "ll": 4, "altern": 4, "footprint": 4, "less": [4, 5, 12, 13, 19], "movement": 4, "simplifi": 4, "persist": 4, "invoc": 4, "kernel": [4, 5, 8, 11, 12, 14, 15, 16, 65], "uniformli": 4, "But": 4, "strategi": [4, 5, 13], "prng": 4, "base": [4, 7, 8, 11, 12, 13], "philox": [4, 54], "salmon2011": 4, "put": 4, "togeth": [4, 7], "_seeded_dropout": 4, "comput": [4, 5, 6, 7, 8, 11, 12, 13, 16, 18, 31, 38, 43, 46, 48, 59, 60, 61, 62], "randomli": 4, "prune": [4, 15], "seeded_dropout": 4, "never": 4, "instanti": 4, "123": 4, "output2": 4, "output3": 4, "952835": 4, "371721": 4, "408716": 4, "42142": 4, "149397": 4, "67086": 4, "214186": 4, "431969": 4, "707878": 4, "106434": 4, "743443": 4, "34172": 4, "41576": 4, "212868": 4, "817432": 4, "84284": 4, "428372": 4, "et": [4, 6, 12, 13], "voil\u00e0": 4, "appli": [4, 5, 6, 7, 12, 13, 22, 57], "explor": [4, 12], "further": [4, 5, 13], "applic": [4, 13, 16], "pseudorandom": 4, "encourag": 4, "folder": 4, "support": [4, 5, 8, 13], "challeng": 4, "spars": [4, 12, 13], "johnson": 4, "lindenstrauss": 4, "transform": [4, 5, 13], "project": [4, 12], "fly": 4, "john": 4, "salmon": 4, "mark": [4, 6, 22, 57, 76], "mora": 4, "ron": 4, "dror": 4, "david": 4, "shaw": 4, "2011": 4, "nitish": 4, "srivastava": 4, "geoffrei": [4, 5], "hinton": [4, 5], "alex": 4, "krizhevski": 4, "ilya": 4, "sutskev": [4, 12], "ruslan": 4, "salakhutdinov": 4, "overfit": 4, "jmlr": 4, "2014": [4, 12], "663": [4, 10], "04": [4, 10], "layernorm": 5, "ba2016": 5, "sequenti": 5, "small": 5, "batch": [5, 6], "divid": [5, 6], "standard": [5, 13], "deviat": 5, "learnabl": 5, "linear": [5, 12, 13], "weight": [5, 6], "w": [5, 13], "bias": 5, "forward": [5, 6], "express": [5, 12, 13], "text": [5, 13], "sqrt": 5, "var": [5, 13], "epsilon": 5, "constant": 5, "ad": 5, "nvidia": [5, 7, 12, 42, 66], "apex": 5, "NOT": 5, "extras_requir": 5, "has_apex": 5, "except": [5, 6, 35], "modulenotfounderror": 5, "fals": [5, 6, 30, 40, 42, 44, 47, 61, 64, 66, 71, 74], "_layer_norm_fwd_fus": 5, "rstd": 5, "std": [5, 6], "ep": 5, "_mean": 5, "off": [5, 8], "varianc": 5, "_var": 5, "x_hat": 5, "involv": [5, 8], "hat": 5, "jacobian": 5, "product": [5, 11, 13, 37], "vjp": 5, "nabla_": 5, "sigma": 5, "big": 5, "odot": 5, "underbrac": 5, "cdot": 5, "_": 5, "c_1": 5, "c_2": 5, "intermedi": [5, 13], "readabl": 5, "quad": 5, "gradient": 5, "step": [5, 13, 65], "partial": 5, "certain": [5, 16], "buffer": 5, "These": [5, 8, 13], "stai": [5, 6], "l2": [5, 8], "cach": [5, 8, 12, 13, 42, 66], "reduc": 5, "diagram": 5, "omit": 5, "breviti": 5, "stage": [5, 14], "color": [5, 74], "share": [5, 12], "thu": 5, "lock": 5, "ensur": [5, 13], "final": 5, "_layer_norm_bwd_dx_fus": 5, "_layer_norm_bwd_dwdb": 5, "dx": 5, "dy": 5, "dw": 5, "db": 5, "lock_id": 5, "count": [5, 65], "xhat": 5, "wdy": 5, "c1": 5, "c2": 5, "partial_dw": 5, "partial_db": 5, "atomic_ca": 5, "doesn": [5, 13], "atomic_xchg": 5, "final_dw": 5, "final_db": 5, "through": [5, 8, 9, 13], "sum_dw": 5, "sum_db": 5, "64kb": 5, "featur": [5, 8], "mode": [5, 6, 8], "autograd": [5, 6], "staticmethod": [5, 6], "ctx": [5, 6], "normalized_shap": 5, "bia": 5, "reshap": 5, "x_arg": 5, "max_fused_s": 5, "rais": 5, "runtimeerror": 5, "save_for_backward": [5, 6], "saved_tensor": [5, 6], "amount": [5, 8, 12], "stream": [5, 53], "_dw": 5, "_db": 5, "separ": [5, 13], "layer_norm": 5, "test_layer_norm": 5, "x_shape": 5, "w_shape": 5, "requires_grad": [5, 6], "randn_lik": [5, 6], "requires_grad_": [5, 6], "y_tri": 5, "y_ref": 5, "nn": 5, "retain_graph": [5, 6], "dx_tri": 5, "dw_tri": 5, "db_tri": 5, "grad": [5, 6], "dx_ref": 5, "dw_ref": 5, "db_ref": 5, "orang": 5, "bench_layer_norm": 5, "y_fwd": 5, "apex_layer_norm": 5, "fusedlayernorm": 5, "rep": [5, 6, 15, 75], "500": 5, "grad_to_non": [5, 75], "1151": 5, "032965": 5, "204": 5, "799997": 5, "438": 5, "857146": 5, "274": 5, "592186": 5, "496": 5, "484863": 5, "341": 5, "333328": 5, "534": 5, "260858": 5, "599994": 5, "538": 5, "160602": 5, "477": 5, "866659": 5, "470": 5, "032796": 5, "552": 5, "269657": 5, "474": 5, "898540": 5, "4608": 5, "582": 5, "063139": 5, "478": 5, "753251": 5, "5120": 5, "650": 5, "158735": 5, "483": 5, "779502": 5, "5632": 5, "718": 5, "978703": 5, "489": 5, "739120": 5, "6144": 5, "772": 5, "020946": 5, "494": 5, "818794": 5, "6656": 5, "836": 5, "356025": 5, "764869": 5, "7168": 5, "900": 5, "691103": 5, "7680": 5, "479": 5, "999983": 5, "246151": 5, "487": 5, "861027": 5, "8704": 5, "673": 5, "858058": 5, "485": 5, "804668": 5, "9216": 5, "699": 5, "949388": 5, "345125": 5, "9728": 5, "725": 5, "068307": 5, "644053": 5, "10240": 5, "751": 5, "559663": 5, "495": 5, "483878": 5, "10752": 5, "779": 5, "601236": 5, "486": 5, "883001": 5, "11264": 5, "806": 5, "973159": 5, "488": 5, "853509": 5, "11776": 5, "826": 5, "385931": 5, "491": 5, "519989": 5, "837": 5, "818175": 5, "12800": 5, "846": 5, "280994": 5, "498": 5, "701318": 5, "13312": 5, "863": 5, "481094": 5, "499": 5, "981239": 5, "13824": 5, "857": 5, "302309": 5, "911279": 5, "14336": 5, "873": 5, "258878": 5, "492": 5, "223158": 5, "14848": 5, "875": 5, "557709": 5, "933326": 5, "15360": 5, "894": 5, "757295": 5, "189943": 5, "15872": 5, "197155": 5, "501": 5, "881412": 5, "jimmi": 5, "lei": 5, "ba": 5, "jami": 5, "ryan": 5, "kiro": 5, "arxiv": [5, 6, 12, 13], "2016": [5, 12, 13], "936": [5, 10], "05": [5, 10], "flash": 6, "dao": 6, "al": [6, 12, 13], "pdf": 6, "2205": 6, "14135v2": 6, "rabe": 6, "staat": 6, "2112": 6, "05682v2": 6, "batch4": 6, "head48": 6, "d64": 6, "fwd": 6, "n_ctx": 6, "292421": 6, "004988": 6, "650402": 6, "941321": 6, "bwd": 6, "216088": 6, "912149": 6, "796937": 6, "51": 6, "840000": 6, "_fwd_kernel": 6, "q": 6, "sm_scale": 6, "l": 6, "stride_qz": 6, "stride_qh": 6, "stride_qm": 6, "stride_qk": 6, "stride_kz": 6, "stride_kh": 6, "stride_kn": 6, "stride_kk": 6, "stride_vz": 6, "stride_vh": 6, "stride_vk": 6, "stride_vn": 6, "stride_oz": 6, "stride_oh": 6, "stride_om": 6, "stride_on": 6, "h": 6, "block_m": 6, "block_dmodel": 6, "block_n": 6, "start_m": 6, "off_hz": 6, "offs_m": 6, "offs_n": 6, "offs_d": 6, "off_q": 6, "off_k": 6, "off_v": 6, "q_ptr": 6, "k_ptr": 6, "v_ptr": 6, "m_prev": 6, "l_prev": 6, "throughout": [6, 13, 74], "start_n": 6, "qk": 6, "new": [6, 8, 29, 39, 41, 73], "m_curr": 6, "old": 6, "l_curr": 6, "rescal": 6, "operand": 6, "l_rcp": 6, "element_ti": [6, 23, 24, 25, 26, 27, 42, 66], "m_i": 6, "l_i": 6, "remateri": 6, "regist": 6, "l_ptr": 6, "m_ptr": 6, "off_o": 6, "out_ptr": 6, "_bwd_preprocess": 6, "newdo": 6, "delta": 6, "d_head": 6, "off_m": 6, "off_n": 6, "denom": 6, "_bwd_kernel": 6, "dq": 6, "dk": 6, "dv": 6, "num_block": 6, "off_z": 6, "off_h": 6, "head": 6, "lo": 6, "offs_qm": 6, "do_ptr": 6, "dq_ptr": 6, "quantiti": 6, "d_ptr": 6, "amd": [6, 12], "offs_m_curr": 6, "pre": [6, 12], "tran": 6, "dp": 6, "di": 6, "increment": [6, 8, 13], "dv_ptr": 6, "dk_ptr": 6, "_attent": 6, "lq": 6, "lk": 6, "lv": 6, "asm": 6, "ttgir": 6, "backward": 6, "zeros_lik": 6, "do_scal": 6, "parametr": [6, 12], "48": 6, "test_op": 6, "normal_": 6, "dout": 6, "tril": 6, "ones": 6, "transpos": 6, "half": 6, "ref_out": 6, "ref_dv": 6, "ref_dk": 6, "ref_dq": 6, "tri_out": 6, "tri_dv": 6, "tri_dk": 6, "tri_dq": 6, "flash_attn": 6, "flash_attn_interfac": 6, "flash_attn_func": 6, "has_flash": 6, "baseexcept": 6, "n_head": 6, "vari": 6, "seq": 6, "fix": [6, 74], "red": 6, "bench_flash_attent": 6, "warmup": [6, 15, 75], "fn": [6, 17, 75], "fill_valu": 6, "cu_seqlen": 6, "cumsum": 6, "qkv": 6, "causal": 6, "post": 6, "amper": 6, "right": [6, 13, 19], "876": [6, 10], "06": [6, 10], "invok": 7, "extern": 7, "pleas": 7, "user": 7, "guid": [7, 8, 12, 65], "regard": 7, "aggreg": 7, "type": [7, 37, 41, 71, 73], "both": [7, 13, 71], "__nv_asin": 7, "__nvasinf": 7, "calcul": [7, 8], "princip": 7, "arc": 7, "sine": [7, 60], "doubl": 7, "__nv_asinf": 7, "simpli": [7, 8, 13], "select": [7, 12, 13, 71], "underli": 7, "asin_kernel": 7, "encod": [7, 13], "4105": 7, "5430": 7, "0249": 7, "0424": 7, "5351": 7, "8149": 7, "384185791015625e": 7, "07": [7, 10], "extern_lib": 7, "usr": 7, "local": [7, 12, 13], "nvvm": 7, "bc": 7, "249": [7, 10], "friendli": 8, "optim": [8, 12, 13], "better": 8, "futur": 8, "previou": 8, "construct": [8, 12], "de": 8, "referenc": 8, "pointer_typ": 8, "element_typ": 8, "approach": [8, 12, 13], "flexibl": [8, 12], "complex": [8, 13], "structur": [8, 12, 13], "tree": 8, "unstructur": 8, "tabl": 8, "drawback": 8, "reli": [8, 13], "heavili": 8, "pattern": [8, 12], "brittl": 8, "suffer": [8, 13], "degrad": 8, "fail": [8, 35], "adequ": 8, "addition": [8, 13], "control": [8, 12, 13, 42, 66], "special": [8, 12, 64, 65], "dens": [8, 13], "spatial": [8, 13], "commonli": [8, 13], "machin": [8, 12, 13], "worsen": 8, "address": [8, 12, 42], "issu": [8, 12, 13], "give": [8, 12], "start": [8, 9, 19, 65], "demonstr": 8, "rewrit": 8, "parent": 8, "make_block_ptr": [8, 42, 66], "inform": [8, 13], "block_shap": 8, "laid": 8, "exactli": 8, "a_block_ptr": 8, "term": 8, "storag": 8, "outer": 8, "sound": 8, "redund": 8, "backend": 8, "boundary_check": [8, 42, 66], "specifi": [8, 13, 16, 23, 24, 25, 26, 27, 42, 66], "whether": [8, 12, 74], "boundari": [8, 42, 66], "With": 8, "accord": 8, "padding_opt": [8, 42, 66], "nan": [8, 20, 21, 42, 44, 47], "temporarili": 8, "due": 8, "legaci": 8, "cost": [8, 13], "guarante": 8, "alwai": [8, 13, 71], "turn": 8, "know": [8, 45, 49], "replac": 8, "origin": [8, 13], "matmul_kernel_with_block_point": 8, "b_block_ptr": 8, "remov": 8, "c_block_ptr": 8, "897": [8, 10], "08": [8, 10], "variou": 9, "recommend": 9, "simplest": 9, "instal": [9, 11], "low": [9, 10, 13], "dropout": [9, 10], "layer": [9, 10, 12, 13], "attent": [9, 10], "libdevic": [9, 10], "math": [9, 10, 16], "experiment": [9, 10], "tutorials_python": 9, "zip": 9, "tutorials_jupyt": 9, "149": 10, "execut": [10, 12, 13, 14, 76], "started_tutori": 10, "00": 10, "mb": [10, 12], "environ": [11, 35, 63], "dnn": [11, 12, 13], "capabl": [11, 12], "maxim": [11, 13, 54], "throughput": 11, "instruct": [11, 12], "platform": [11, 13], "choic": 11, "dsl": [11, 12, 13], "chapter": 11, "introduct": 11, "relat": 11, "past": [12, 13], "decad": 12, "emerg": 12, "ml": 12, "art": [12, 13], "mani": [12, 13], "domain": [12, 13], "sutskever2014": 12, "vision": 12, "redmon2016": 12, "neurosci": 12, "lee2017": 12, "strength": 12, "li": 12, "hierarch": 12, "sequenc": [12, 39], "convolut": 12, "non": 12, "rectifi": 12, "though": [12, 13], "computation": [12, 13], "expens": [12, 13, 16], "larg": [12, 13], "highli": 12, "paralleliz": 12, "particularli": [12, 13], "suit": 12, "core": [12, 13], "processor": 12, "consequ": 12, "graphic": 12, "becom": 12, "cheap": 12, "resourc": 12, "deploi": 12, "novel": 12, "research": [12, 13], "idea": 12, "field": [12, 15], "trend": 12, "acceler": 12, "sever": [12, 13], "framework": [12, 13], "purpos": [12, 13], "gpgpu": 12, "opencl": 12, "made": 12, "develop": [12, 13], "yet": [12, 13], "remain": [12, 74], "incredibli": 12, "especi": 12, "combin": [12, 22, 57], "exist": [12, 13], "primit": [12, 17], "wors": [12, 13], "rapidli": [12, 13], "evolv": 12, "evidenc": 12, "recent": 12, "micro": 12, "tension": 12, "opportun": 12, "offer": 12, "substanti": 12, "academ": 12, "industri": 12, "interest": [12, 13], "regrett": 12, "polyhedr": 12, "machineri": [12, 13], "tiramisu": [12, 13], "baghdadi2021": [12, 13], "comprehens": [12, 13], "vasilache2018": [12, 13], "schedul": 12, "halid": [12, 13], "jrk2013": 12, "tvm": [12, 13], "chen2018": 12, "markedli": 12, "slower": [12, 13], "handwritten": 12, "cudnn": 12, "tensorrt": 12, "premis": 12, "paradigm": [12, 13], "lam1991": 12, "facilit": [12, 13], "revisit": 12, "auguin1983": 12, "propos": 12, "variant": 12, "rather": 12, "pragma": 12, "nb": 12, "kb": 12, "space": [12, 13], "programm": [12, 13], "aggress": [12, 13, 65], "pose": 12, "partit": 12, "heavi": 12, "flow": [12, 13], "analysi": [12, 13], "techniqu": [12, 13], "target": 12, "surprisingli": 12, "broad": 12, "coalesc": 12, "swizzl": 12, "fetch": 12, "awar": 12, "Of": 12, "cours": 12, "trivial": 12, "nip": 12, "redmon": 12, "unifi": 12, "real": 12, "detect": 12, "cvpr": 12, "lee": 12, "superhuman": 12, "snemi3d": 12, "connectom": 12, "2017": 12, "baghdadi": [12, 13], "portabl": [12, 13], "cgo": [12, 13], "2021": [12, 13], "vasilach": [12, 13], "agnost": [12, 13], "abstract": [12, 13], "2018": [12, 13], "ragan": 12, "kellei": 12, "imag": [12, 13], "pipelin": [12, 13, 14], "pldi": 12, "2013": 12, "chen": 12, "autom": 12, "osdi": 12, "lam": 12, "asplo": 12, "1991": [12, 13], "auguin": 12, "opsila": 12, "simd": 12, "signal": 12, "euromicro": 12, "1983": 12, "sight": 13, "contextu": 13, "highlight": 13, "typic": 13, "ir": 13, "lattner2004": 13, "un": 13, "condit": [13, 35, 63, 71], "branch": 13, "format": [13, 36], "difficult": 13, "analyz": 13, "runtim": [13, 35, 36], "behavior": [13, 15, 42, 66], "miss": 13, "accordingli": 13, "tile": 13, "wolfe1989": 13, "darte1999": 13, "interchang": 13, "allen1984": 13, "solv": 13, "ancourt1991": 13, "predict": 13, "therebi": 13, "enabl": 13, "adopt": 13, "diesel": 13, "elango2018": 13, "affin": 13, "dialect": 13, "mlir": 13, "lattner2019": 13, "vast": 13, "area": 13, "outlin": 13, "aspect": 13, "topic": 13, "reader": 13, "solid": 13, "mathemat": 13, "foundat": 13, "underneath": 13, "ampl": 13, "literatur": 13, "integ": [13, 42, 66], "known": 13, "scop": 13, "consecut": 13, "statement": [13, 35], "surround": 13, "indic": [13, 20, 21, 39, 42, 44, 47, 66, 71], "global": 13, "shown": 13, "inequ": 13, "polyhedra": 13, "algebra": 13, "mathcal": [13, 55], "mathbb": 13, "begin": 13, "pmatrix": 13, "geq": 13, "induc": 13, "side": 13, "effect": [13, 35], "break": 13, "contain": [13, 23, 24, 25, 26, 27, 74], "arrai": [13, 41, 73], "alia": 13, "word": 13, "shall": 13, "fact": 13, "travers": 13, "legal": 13, "formal": 13, "theta": 13, "mathbf": 13, "theta_": 13, "t_": 13, "vec": 13, "qquad": 13, "slowest": 13, "fastest": 13, "grow": 13, "left": [13, 19, 20, 21, 44, 47], "retriev": 13, "respect": [13, 39], "resp": 13, "said": 13, "amen": 13, "boil": 13, "tempor": 13, "verif": 13, "preserv": [13, 70], "phase": 13, "uncommon": 13, "ahead": 13, "grosser2012": 13, "extrem": 13, "common": [13, 28], "inde": 13, "fulli": 13, "hint": [13, 30], "apart": 13, "univers": 13, "method": [13, 14, 17, 65, 74, 76], "omega": 13, "resolut": 13, "properti": 13, "sm": 13, "characterist": 13, "taken": 13, "account": 13, "procedur": 13, "sato2019": 13, "girbal2006": 13, "subscript": 13, "occur": 13, "reason": 13, "successfulli": 13, "rise": 13, "few": 13, "year": 13, "On": 13, "hand": 13, "advoc": 13, "dissert": 13, "restrict": 13, "scope": 13, "close": [13, 19], "peak": 13, "dataflow": 13, "concern": 13, "dijkstra82": 13, "design": 13, "principl": 13, "scienc": 13, "decompos": 13, "modular": 13, "push": 13, "philosophi": 13, "enforc": 13, "grammat": 13, "methodologi": 13, "visibl": 13, "definit": 13, "complet": 13, "disjoint": 13, "func": 13, "rdom": 13, "matrix_s": 13, "rvar": 13, "ki": 13, "0f": 13, "xi": 13, "xo": 13, "yo": 13, "yi": 13, "yii": 13, "xii": 13, "split": 13, "reorder": [13, 30], "unrol": [13, 65], "sometim": 13, "intrins": 13, "wide": 13, "mitig": 13, "mullapudi2016": 13, "wouldn": 13, "abl": 13, "figur": 13, "without": 13, "doubt": 13, "popular": 13, "eas": 13, "tend": 13, "v100": 13, "equal": [13, 19], "believ": 13, "fundament": 13, "effort": 13, "harder": 13, "engin": 13, "importantli": 13, "least": 13, "impos": 13, "entir": 13, "problemat": 13, "balanc": 13, "lattner": 13, "lifelong": 13, "2004": 13, "wolf": 13, "sc": 13, "1989": 13, "dart": 13, "pact": 13, "1999": 13, "allen": 13, "sigplan": 13, "1984": 13, "ancourt": 13, "scan": [13, 32, 33], "ppopp": 13, "elango": 13, "net": 13, "mapl": 13, "primer": 13, "infrastructur": 13, "moor": 13, "law": 13, "2019": 13, "grosser": 13, "polli": 13, "letter": 13, "2012": 13, "sato": 13, "scalabl": 13, "via": 13, "taco": 13, "girbal": 13, "semi": 13, "composit": 13, "hierarchi": 13, "journal": 13, "2006": 13, "dijkstra": 13, "role": 13, "scientif": 13, "thought": 13, "person": 13, "perspect": 13, "1982": 13, "mullapudi": 13, "tog": 13, "self": [14, 65, 74], "kwarg": 14, "pre_hook": 14, "tuner": 14, "dictionari": [14, 16], "cooper": 14, "softwar": 14, "mostli": 14, "sm80": 14, "__init__": [14, 65, 74], "prune_configs_bi": 15, "reset_to_zero": 15, "x_size": [15, 16], "anytim": 15, "whatev": 15, "undesir": 15, "reset": 15, "str": [15, 16, 42, 64, 66, 74], "dict": [15, 16], "perf_model": 15, "predic": 15, "top_k": 15, "early_config_prun": 15, "earli": 15, "eg": 15, "default": 15, "repetit": 15, "prohibitev": 16, "ceil": 16, "log2": 16, "posit": 16, "jitfunct": 17, "version": 17, "do_not_speci": 17, "debug": 17, "bool": [17, 42, 71, 74], "noinlin": 17, "data_ptr": 17, "attribut": 17, "builtin": [17, 36, 64], "packag": 17, "absolut": 18, "open": 19, "interv": 19, "triton_max_tensor_numel": 19, "tie_break_left": [20, 21], "ti": [20, 21, 44, 47], "aren": [20, 21, 44, 47], "minimum": [21, 47], "combine_fn": [22, 57], "carri": 22, "val": [23, 24, 25, 26, 27], "sem": [23, 24, 25, 26, 27], "atom": [23, 24, 25, 26, 27], "pointerdtyp": [23, 24, 25, 26, 27], "swap": [23, 24, 25, 26, 27], "cmp": [23, 24, 25, 26, 27], "found": [23, 24, 25, 26, 27], "exchang": 27, "tri": [28, 29], "compat": [28, 37], "broadcast": [29, 42, 66, 71], "desir": [29, 70], "can_reord": 30, "concaten": 30, "cosin": 31, "insert": [34, 39], "barrier": 34, "cond": [35, 63], "msg": [35, 63], "triton_debug": [35, 63], "besid": 35, "string": [35, 36], "boolean": 35, "messag": 35, "liter": [35, 36], "prefix": 36, "allow_tf32": 37, "out_dtyp": 37, "bfloat16": 37, "expand": 39, "ax": 39, "ieee_round": [40, 61], "fill": [41, 73], "cache_modifi": [42, 66], "eviction_polici": [42, 66], "volatil": 42, "too": [42, 66], "typecast": [42, 66], "pointertyp": [42, 66], "int1": [42, 66], "idx": [42, 66], "ptx": [42, 66], "evict": [42, 66], "polici": [42, 66], "return_indic": [44, 47], "return_indices_tie_break_left": [44, 47], "3d": [50, 51], "current": 51, "seed": [52, 53, 54, 55], "n_round": [52, 53, 54, 55], "randint4x": 53, "four": 54, "entri": 54, "flatten": 56, "view": 56, "squar": 62, "root": 62, "sep": 64, "flush": 64, "device_print": 64, "arg1": 65, "arg2": 65, "upward": 65, "forev": 65, "similar": 65, "context": 65, "unintend": 71, "nonzero": 71, "yield": 71, "xor": 72, "xlabel": 74, "y_log": 74, "api": 74, "constructor": 74, "appear": 74, "log": 74, "scale": 74, "fast_flush": 75, "return_mod": 75}, "objects": {"triton": [[14, 0, 1, "", "Config"], [15, 2, 1, "", "autotune"], [16, 2, 1, "", "heuristics"], [17, 2, 1, "", "jit"]], "triton.Config": [[14, 1, 1, "", "__init__"]], "triton.language": [[18, 2, 1, "", "abs"], [19, 2, 1, "", "arange"], [20, 2, 1, "", "argmax"], [21, 2, 1, "", "argmin"], [22, 2, 1, "", "associative_scan"], [23, 2, 1, "", "atomic_add"], [24, 2, 1, "", "atomic_cas"], [25, 2, 1, "", "atomic_max"], [26, 2, 1, "", "atomic_min"], [27, 2, 1, "", "atomic_xchg"], [28, 2, 1, "", "broadcast"], [29, 2, 1, "", "broadcast_to"], [30, 2, 1, "", "cat"], [31, 2, 1, "", "cos"], [32, 2, 1, "", "cumprod"], [33, 2, 1, "", "cumsum"], [34, 2, 1, "", "debug_barrier"], [35, 2, 1, "", "device_assert"], [36, 2, 1, "", "device_print"], [37, 2, 1, "", "dot"], [38, 2, 1, "", "exp"], [39, 2, 1, "", "expand_dims"], [40, 2, 1, "", "fdiv"], [41, 2, 1, "", "full"], [42, 2, 1, "", "load"], [43, 2, 1, "", "log"], [44, 2, 1, "", "max"], [45, 2, 1, "", "max_contiguous"], [46, 2, 1, "", "maximum"], [47, 2, 1, "", "min"], [48, 2, 1, "", "minimum"], [49, 2, 1, "", "multiple_of"], [50, 2, 1, "", "num_programs"], [51, 2, 1, "", "program_id"], [52, 2, 1, "", "rand"], [53, 2, 1, "", "randint"], [54, 2, 1, "", "randint4x"], [55, 2, 1, "", "randn"], [56, 2, 1, "", "ravel"], [57, 2, 1, "", "reduce"], [58, 2, 1, "", "reshape"], [59, 2, 1, "", "sigmoid"], [60, 2, 1, "", "sin"], [61, 2, 1, "", "softmax"], [62, 2, 1, "", "sqrt"], [63, 2, 1, "", "static_assert"], [64, 2, 1, "", "static_print"], [65, 0, 1, "", "static_range"], [66, 2, 1, "", "store"], [67, 2, 1, "", "sum"], [68, 2, 1, "", "trans"], [69, 2, 1, "", "umulhi"], [70, 2, 1, "", "view"], [71, 2, 1, "", "where"], [72, 2, 1, "", "xor_sum"], [73, 2, 1, "", "zeros"]], "triton.language.static_range": [[65, 1, 1, "", "__init__"]], "triton.testing": [[74, 0, 1, "", "Benchmark"], [75, 2, 1, "", "do_bench"], [76, 2, 1, "", "perf_report"]], "triton.testing.Benchmark": [[74, 1, 1, "", "__init__"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:function"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "function", "Python function"]}, "titleterms": {"instal": 0, "binari": 0, "distribut": 0, "from": 0, "sourc": 0, "python": [0, 11], "packag": 0, "vector": 1, "addit": 1, "comput": [1, 2, 3, 10], "kernel": [1, 2, 3, 7], "benchmark": [1, 2, 3, 5, 74], "fuse": [2, 6], "softmax": [2, 61], "motiv": [2, 3, 5, 8, 12], "unit": [2, 3, 8], "test": [2, 3, 8, 74, 75, 76, 79], "matrix": 3, "multipl": 3, "pointer": [3, 8], "arithmet": 3, "l2": 3, "cach": 3, "optim": 3, "final": [3, 8], "result": [3, 8], "squar": 3, "perform": 3, "low": 4, "memori": [4, 78], "dropout": 4, "baselin": 4, "seed": 4, "exercis": 4, "refer": [4, 5, 12, 13], "layer": 5, "normal": 5, "backward": 5, "pass": 5, "attent": 6, "libdevic": 7, "tl": 7, "math": [7, 78], "function": 7, "asin": 7, "us": 7, "default": 7, "librari": 7, "path": 7, "custom": 7, "block": 8, "experiment": 8, "make": 8, "load": [8, 42], "store": [8, 66], "advanc": 8, "tutori": 9, "time": 10, "welcom": 11, "triton": [11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79], "": 11, "document": 11, "get": 11, "start": 11, "api": 11, "go": 11, "further": 11, "introduct": 12, "challeng": 12, "relat": 13, "work": 13, "polyhedr": 13, "compil": [13, 78], "program": [13, 78], "represent": 13, "advantag": 13, "limit": 13, "schedul": 13, "languag": [13, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 78], "config": 14, "autotun": 15, "heurist": 16, "jit": 17, "ab": 18, "arang": 19, "argmax": 20, "argmin": 21, "associative_scan": 22, "atomic_add": 23, "atomic_ca": 24, "atomic_max": 25, "atomic_min": 26, "atomic_xchg": 27, "broadcast": 28, "broadcast_to": 29, "cat": 30, "co": 31, "cumprod": 32, "cumsum": 33, "debug_barri": 34, "device_assert": 35, "device_print": 36, "dot": 37, "exp": 38, "expand_dim": 39, "fdiv": 40, "full": 41, "log": 43, "max": 44, "max_contigu": 45, "maximum": 46, "min": 47, "minimum": 48, "multiple_of": 49, "num_program": 50, "program_id": 51, "rand": 52, "randint": 53, "randint4x": 54, "randn": 55, "ravel": 56, "reduc": 57, "reshap": 58, "sigmoid": 59, "sin": 60, "sqrt": 62, "static_assert": 63, "static_print": 64, "static_rang": 65, "sum": 67, "tran": 68, "umulhi": 69, "view": 70, "where": 71, "xor_sum": 72, "zero": 73, "do_bench": 75, "perf_report": 76, "model": 78, "creation": 78, "op": 78, "shape": 78, "manipul": 78, "linear": 78, "algebra": 78, "index": 78, "reduct": 78, "scan": 78, "atom": 78, "comparison": 78, "random": 78, "number": 78, "gener": 78, "hint": 78, "debug": 78, "iter": 78}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"Installation": [[0, "installation"]], "Binary Distributions": [[0, "binary-distributions"]], "From Source": [[0, "from-source"]], "Python Package": [[0, "python-package"]], "Vector Addition": [[1, "vector-addition"]], "Compute Kernel": [[1, "compute-kernel"], [2, "compute-kernel"], [3, "compute-kernel"]], "Benchmark": [[1, "benchmark"], [2, "benchmark"], [3, "benchmark"], [5, "benchmark"]], "Fused Softmax": [[2, "fused-softmax"]], "Motivations": [[2, "motivations"], [3, "motivations"], [5, "motivations"], [8, "motivations"], [12, "motivations"]], "Unit Test": [[2, "unit-test"], [3, "unit-test"], [8, "unit-test"]], "Matrix Multiplication": [[3, "matrix-multiplication"]], "Pointer Arithmetics": [[3, "pointer-arithmetics"]], "L2 Cache Optimizations": [[3, "l2-cache-optimizations"]], "Final Result": [[3, "final-result"], [8, "final-result"]], "Square Matrix Performance": [[3, "square-matrix-performance"]], "Low-Memory Dropout": [[4, "low-memory-dropout"]], "Baseline": [[4, "baseline"]], "Seeded dropout": [[4, "seeded-dropout"]], "Exercises": [[4, "exercises"]], "References": [[4, "references"], [5, "references"], [12, "references"], [13, "references"]], "Layer Normalization": [[5, "layer-normalization"]], "Backward pass": [[5, "backward-pass"]], "Fused Attention": [[6, "fused-attention"]], "Libdevice (tl.math) function": [[7, "libdevice-tl-math-function"]], "asin Kernel": [[7, "asin-kernel"]], "Using the default libdevice library path": [[7, "using-the-default-libdevice-library-path"]], "Customize the libdevice library path": [[7, "customize-the-libdevice-library-path"]], "Block Pointer (Experimental)": [[8, "block-pointer-experimental"]], "Make a Block Pointer": [[8, "make-a-block-pointer"]], "Load/Store a Block Pointer": [[8, "load-store-a-block-pointer"]], "Advance a Block Pointer": [[8, "advance-a-block-pointer"]], "Tutorials": [[9, "tutorials"]], "Computation times": [[10, "computation-times"]], "Welcome to Triton\u2019s documentation!": [[11, "welcome-to-triton-s-documentation"]], "Getting Started": [[11, "getting-started"]], "Python API": [[11, "python-api"]], "Going Further": [[11, "going-further"]], "Introduction": [[12, "introduction"]], "Challenges": [[12, "challenges"]], "Related Work": [[13, "related-work"]], "Polyhedral Compilation": [[13, "polyhedral-compilation"]], "Program Representation": [[13, "program-representation"]], "Advantages": [[13, "advantages"], [13, "id16"]], "Limitations": [[13, "limitations"], [13, "id17"]], "Scheduling Languages": [[13, "scheduling-languages"]], "triton.Config": [[14, "triton-config"]], "triton.autotune": [[15, "triton-autotune"]], "triton.heuristics": [[16, "triton-heuristics"]], "triton.jit": [[17, "triton-jit"]], "triton.language.abs": [[18, "triton-language-abs"]], "triton.language.arange": [[19, "triton-language-arange"]], "triton.language.argmax": [[20, "triton-language-argmax"]], "triton.language.argmin": [[21, "triton-language-argmin"]], "triton.language.associative_scan": [[22, "triton-language-associative-scan"]], "triton.language.atomic_add": [[23, "triton-language-atomic-add"]], "triton.language.atomic_cas": [[24, "triton-language-atomic-cas"]], "triton.language.atomic_max": [[25, "triton-language-atomic-max"]], "triton.language.atomic_min": [[26, "triton-language-atomic-min"]], "triton.language.atomic_xchg": [[27, "triton-language-atomic-xchg"]], "triton.language.broadcast": [[28, "triton-language-broadcast"]], "triton.language.broadcast_to": [[29, "triton-language-broadcast-to"]], "triton.language.cat": [[30, "triton-language-cat"]], "triton.language.cos": [[31, "triton-language-cos"]], "triton.language.cumprod": [[32, "triton-language-cumprod"]], "triton.language.cumsum": [[33, "triton-language-cumsum"]], "triton.language.debug_barrier": [[34, "triton-language-debug-barrier"]], "triton.language.device_assert": [[35, "triton-language-device-assert"]], "triton.language.device_print": [[36, "triton-language-device-print"]], "triton.language.dot": [[37, "triton-language-dot"]], "triton.language.exp": [[38, "triton-language-exp"]], "triton.language.expand_dims": [[39, "triton-language-expand-dims"]], "triton.language.fdiv": [[40, "triton-language-fdiv"]], "triton.language.full": [[41, "triton-language-full"]], "triton.language.load": [[42, "triton-language-load"]], "triton.language.log": [[43, "triton-language-log"]], "triton.language.max": [[44, "triton-language-max"]], "triton.language.max_contiguous": [[45, "triton-language-max-contiguous"]], "triton.language.maximum": [[46, "triton-language-maximum"]], "triton.language.min": [[47, "triton-language-min"]], "triton.language.minimum": [[48, "triton-language-minimum"]], "triton.language.multiple_of": [[49, "triton-language-multiple-of"]], "triton.language.num_programs": [[50, "triton-language-num-programs"]], "triton.language.program_id": [[51, "triton-language-program-id"]], "triton.language.rand": [[52, "triton-language-rand"]], "triton.language.randint": [[53, "triton-language-randint"]], "triton.language.randint4x": [[54, "triton-language-randint4x"]], "triton.language.randn": [[55, "triton-language-randn"]], "triton.language.ravel": [[56, "triton-language-ravel"]], "triton.language.reduce": [[57, "triton-language-reduce"]], "triton.language.reshape": [[58, "triton-language-reshape"]], "triton.language.sigmoid": [[59, "triton-language-sigmoid"]], "triton.language.sin": [[60, "triton-language-sin"]], "triton.language.softmax": [[61, "triton-language-softmax"]], "triton.language.sqrt": [[62, "triton-language-sqrt"]], "triton.language.static_assert": [[63, "triton-language-static-assert"]], "triton.language.static_print": [[64, "triton-language-static-print"]], "triton.language.static_range": [[65, "triton-language-static-range"]], "triton.language.store": [[66, "triton-language-store"]], "triton.language.sum": [[67, "triton-language-sum"]], "triton.language.trans": [[68, "triton-language-trans"]], "triton.language.umulhi": [[69, "triton-language-umulhi"]], "triton.language.view": [[70, "triton-language-view"]], "triton.language.where": [[71, "triton-language-where"]], "triton.language.xor_sum": [[72, "triton-language-xor-sum"]], "triton.language.zeros": [[73, "triton-language-zeros"]], "triton.testing.Benchmark": [[74, "triton-testing-benchmark"]], "triton.testing.do_bench": [[75, "triton-testing-do-bench"]], "triton.testing.perf_report": [[76, "triton-testing-perf-report"]], "triton": [[77, "triton"]], "triton.language": [[78, "triton-language"]], "Programming Model": [[78, "programming-model"]], "Creation Ops": [[78, "creation-ops"]], "Shape Manipulation Ops": [[78, "shape-manipulation-ops"]], "Linear Algebra Ops": [[78, "linear-algebra-ops"]], "Memory Ops": [[78, "memory-ops"]], "Indexing Ops": [[78, "indexing-ops"]], "Math Ops": [[78, "math-ops"]], "Reduction Ops": [[78, "reduction-ops"]], "Scan Ops": [[78, "scan-ops"]], "Atomic Ops": [[78, "atomic-ops"]], "Comparison ops": [[78, "comparison-ops"]], "Random Number Generation": [[78, "random-number-generation"]], "Compiler Hint Ops": [[78, "compiler-hint-ops"]], "Debug Ops": [[78, "debug-ops"]], "Iterators": [[78, "iterators"]], "triton.testing": [[79, "triton-testing"]]}, "indexentries": {"config (class in triton)": [[14, "triton.Config"]], "__init__() (triton.config method)": [[14, "triton.Config.__init__"]], "autotune() (in module triton)": [[15, "triton.autotune"]], "heuristics() (in module triton)": [[16, "triton.heuristics"]], "jit() (in module triton)": [[17, "triton.jit"]], "abs() (in module triton.language)": [[18, "triton.language.abs"]], "arange() (in module triton.language)": [[19, "triton.language.arange"]], "argmax() (in module triton.language)": [[20, "triton.language.argmax"]], "argmin() (in module triton.language)": [[21, "triton.language.argmin"]], "associative_scan() (in module triton.language)": [[22, "triton.language.associative_scan"]], "atomic_add() (in module triton.language)": [[23, "triton.language.atomic_add"]], "atomic_cas() (in module triton.language)": [[24, "triton.language.atomic_cas"]], "atomic_max() (in module triton.language)": [[25, "triton.language.atomic_max"]], "atomic_min() (in module triton.language)": [[26, "triton.language.atomic_min"]], "atomic_xchg() (in module triton.language)": [[27, "triton.language.atomic_xchg"]], "broadcast() (in module triton.language)": [[28, "triton.language.broadcast"]], "broadcast_to() (in module triton.language)": [[29, "triton.language.broadcast_to"]], "cat() (in module triton.language)": [[30, "triton.language.cat"]], "cos() (in module triton.language)": [[31, "triton.language.cos"]], "cumprod() (in module triton.language)": [[32, "triton.language.cumprod"]], "cumsum() (in module triton.language)": [[33, "triton.language.cumsum"]], "debug_barrier() (in module triton.language)": [[34, "triton.language.debug_barrier"]], "device_assert() (in module triton.language)": [[35, "triton.language.device_assert"]], "device_print() (in module triton.language)": [[36, "triton.language.device_print"]], "dot() (in module triton.language)": [[37, "triton.language.dot"]], "exp() (in module triton.language)": [[38, "triton.language.exp"]], "expand_dims() (in module triton.language)": [[39, "triton.language.expand_dims"]], "fdiv() (in module triton.language)": [[40, "triton.language.fdiv"]], "full() (in module triton.language)": [[41, "triton.language.full"]], "load() (in module triton.language)": [[42, "triton.language.load"]], "log() (in module triton.language)": [[43, "triton.language.log"]], "max() (in module triton.language)": [[44, "triton.language.max"]], "max_contiguous() (in module triton.language)": [[45, "triton.language.max_contiguous"]], "maximum() (in module triton.language)": [[46, "triton.language.maximum"]], "min() (in module triton.language)": [[47, "triton.language.min"]], "minimum() (in module triton.language)": [[48, "triton.language.minimum"]], "multiple_of() (in module triton.language)": [[49, "triton.language.multiple_of"]], "num_programs() (in module triton.language)": [[50, "triton.language.num_programs"]], "program_id() (in module triton.language)": [[51, "triton.language.program_id"]], "rand() (in module triton.language)": [[52, "triton.language.rand"]], "randint() (in module triton.language)": [[53, "triton.language.randint"]], "randint4x() (in module triton.language)": [[54, "triton.language.randint4x"]], "randn() (in module triton.language)": [[55, "triton.language.randn"]], "ravel() (in module triton.language)": [[56, "triton.language.ravel"]], "reduce() (in module triton.language)": [[57, "triton.language.reduce"]], "reshape() (in module triton.language)": [[58, "triton.language.reshape"]], "sigmoid() (in module triton.language)": [[59, "triton.language.sigmoid"]], "sin() (in module triton.language)": [[60, "triton.language.sin"]], "softmax() (in module triton.language)": [[61, "triton.language.softmax"]], "sqrt() (in module triton.language)": [[62, "triton.language.sqrt"]], "static_assert() (in module triton.language)": [[63, "triton.language.static_assert"]], "static_print() (in module triton.language)": [[64, "triton.language.static_print"]], "__init__() (triton.language.static_range method)": [[65, "triton.language.static_range.__init__"]], "static_range (class in triton.language)": [[65, "triton.language.static_range"]], "store() (in module triton.language)": [[66, "triton.language.store"]], "sum() (in module triton.language)": [[67, "triton.language.sum"]], "trans() (in module triton.language)": [[68, "triton.language.trans"]], "umulhi() (in module triton.language)": [[69, "triton.language.umulhi"]], "view() (in module triton.language)": [[70, "triton.language.view"]], "where() (in module triton.language)": [[71, "triton.language.where"]], "xor_sum() (in module triton.language)": [[72, "triton.language.xor_sum"]], "zeros() (in module triton.language)": [[73, "triton.language.zeros"]], "benchmark (class in triton.testing)": [[74, "triton.testing.Benchmark"]], "__init__() (triton.testing.benchmark method)": [[74, "triton.testing.Benchmark.__init__"]], "do_bench() (in module triton.testing)": [[75, "triton.testing.do_bench"]], "perf_report() (in module triton.testing)": [[76, "triton.testing.perf_report"]]}})