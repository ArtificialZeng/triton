import torch

import triton

src = """
--[----->+<]>--.+.+.[--->+<]>--.+[----->+<]>.------------.--[--->+<]>-.-------.++++++++.---------.-------------.++++++++
++++.------.+++++++++++++.----.---------.+++++++.[--->+<]>++++.[---->+<]>.[->+++<]>++....+++.---.[-->+++++<]>.[--->+<]>-
.------.+++++.++++++.+++[->+++<]>.+++++++++++++.+.+[---->+<]>+++.---[->++++<]>.-----.[--->+<]>-----.+[----->+<]>.-------
-----.--[--->+<]>-.--.---------.------.++.[--->+<]>----.>++++++++++.[->+++<]>++....[->+++<]>+.--.---[->++++<]>.++++.--.[
++>---<]>+.------------.[->+++<]>++.---.---[->++++<]>.++++.--.[++>---<]>+.------------.+[->+++<]>.----.---[->++++<]>.+++
+.--.[++>---<]>+.>++++++++++.[->+++<]>++....+++.---.++++++[->++<]>+.-[------>+<]>-.--[--->+<]>-.--.---------.-[--->+<]>.
[---->+<]>++.+[->+++<]>+.+++++.++++.--------.+++++++++.+++++.----------.++++++.-.+++++.>++++++++++.[->+++<]>++....++++++
[->++<]>+.--[->++++<]>.------------.[-->+++++<]>--.[-->+<]>+++++.------------.--[-->+++++<]>.[->++++<]>.>++++++++++.[->+
++<]>++....+++.---.>-[--->+<]>-.[---->+++++<]>-.---.--[--->+<]>-.---[->++++<]>-.+.--.---------.-----.+.--[--->+<]>-.--[-
>++++<]>--.[->+++<]>-.--[--->+<]>---.---------.--------.+.++++++++++.-------.[--->+<]>----.+[---->+<]>+++.---[----->++<]
>.-------------.+++++++++++.++.-------------.[--->+<]>----.++++[->+++<]>.+++++++++.++++++.[---->+<]>+++.-[--->++<]>--.++
+++++.++++++++.+[---->+<]>++.+[----->+<]>.++++++++.+[->+++<]>+.+++++.--[--->+<]>--.---[->++++<]>.-----.[--->+<]>-----.-[
--->++<]>-.+++++.-----------.-[--->+<]>----.-------------.----.--[--->+<]>--.++++[->+++<]>.--[--->+<]>-.---[->++++<]>.--
----------.---.--[--->+<]>-.[-->+++++++<]>.++++.--.[-->+++++<]>+++.[->+++<]>++.[--->+<]>+++.-[---->+<]>++.--[->++++<]>-.
+[->+++<]>.---.+++++++++.-[->+++++<]>-.+[----->+<]>.++.+++++++.[------>+<]>.+++++.-------.-[--->+<]>--.[->+++<]>++.[--->
+<]>+++.-[---->+<]>++.[-->+++<]>+.>++++++++++.[->+++<]>++....+++.---.+[->+++<]>++.+++++++.-------.++++++++.--------.++++
+++++.++++++.[---->+<]>+++.-[--->++<]>-.+++++.-[->+++++<]>-.[->+++<]>+.-[->+++<]>.[-->+++++++<]>.[----->++<]>+.--[--->+<
]>---.++.-----------.------.-[--->+<]>-.---------.-----------.--[--->+<]>---.[-->+++++<]>+++.+[->+++<]>+.+++++.++++.----
----.+++++++++.+++++.----------.++++++.-.[----->++<]>++.++[--->++<]>.++[->++<]>+.[--->++<]>.+[--->+<]>++.--[->+++<]>-.++
[--->++<]>.---[->++++<]>-.+.--.---------.-----.+.------.++.++++++++++++.[->+++++<]>-.-[--->++<]>-.++++++++++.+[---->+<]>
+++.-[--->++<]>--.+++++++.++++++++.+[---->+<]>++.+[----->+<]>.++++++++.+[->+++<]>+.+++++.--[--->+<]>--.---[->++++<]>.---
--.[--->+<]>-----.-[--->++<]>-.+++++.-----------.-[--->+<]>----.-------------.----.--[--->+<]>--.++++[->+++<]>.--[--->+<
]>-.[->+++<]>+.--.---[->++++<]>.++++.--.>++++++++++.[->+++<]>++....+++.---.[->+++<]>++.[--->+<]>+++.-[---->+<]>++.---[->
++++<]>.-----.[--->+<]>-----.++[->+++<]>+.--.[--->+<]>---.[---->+<]>+++.---[->++++<]>.------------.---.--[--->+<]>-.+[->
+++<]>++.+++++++.-------.++++++++.--------.+++++++++.++++++.[---->+<]>+++.+++++[->+++<]>.-.---------.--[--->+<]>-.---[--
--->++<]>.---.++++++++.+[---->+<]>++.+[->+++<]>+.+++++++++++.++++++++.---------.-[->+++++<]>-.++++++++.-[--->+++++<]>.-[
-->+<]>.-[--->++<]>--.-------.--[--->+<]>--.+[---->+<]>+++.++++++[->++<]>+.-----[->++++<]>.---[----->++<]>.---.++++++++.
----.-[--->+<]>+++.>++++++++++.[->+++<]>++....---[->++++<]>-.+.--.---------.-----.+.------.++.++++++++++++.+[----->++<]>
.------------.---[->++++<]>-.+.--.---------.-----.+.------.++.++++++++++.+++[----->++<]>.>++++++++++.[->+++<]>++....---[
->++++<]>-.+.--.---------.-----.+.------.+++.+++++++++.+++[----->++<]>.------------.---[->++++<]>-.+.--.---------.-----.
+.------.+++.++++++++++++.[----->++<]>.>++++++++++.[->+++<]>++....---[->++++<]>-.+.--.---------.-----.+.------.++++.++++
++++++.+[----->++<]>.------------.---[->++++<]>-.+.--.---------.-----.+.------.++++.+++++++++++.[----->++<]>.>++++++++++
.[->+++<]>++....+++.---.++++++[->++<]>+.>--[----->+<]>-.[--->+<]>---.+[->+++<]>++.-[-->+<]>---.--[----->+<]>+.[----->++<
]>+.--[--->+<]>---.+++[->+++<]>++.++++++++++++.--------.[--->+<]>---.+++[->+++<]>.+++++++++++++.+.>++++++++++.[->+++<]>+
+....+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>.
+[->+++++<]>+.[----->++++<]>+.+[->++++<]>++.[-->+<]>+++.---[->++++<]>.--------.[-->+<]>--------.--[--->+<]>-.+++++++++++
+.-.+++++.+.+++[->+++<]>.[--->+<]>+.--------.++.[++>---<]>+.------------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.-
-[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[--------->++<]>.[->++++<]>++.[-->+<]>
+++.---[->++++<]>.--------.[-->+<]>--------.--[--->+<]>-.++++++++++++.-.+++++.+.+++[->+++<]>.[--->+<]>+.--------.++.[++>
---<]>+.------------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<
]>.-[----->+<]>.+[->+++++<]>+.[--->+++++<]>++.[------->++<]>.[-->+<]>+++.---[->++++<]>.--------.[-->+<]>--------.--[--->
+<]>-.++++++++++++.-.+++++.+.+++[->+++<]>.[--->+<]>+.--------.++.[++>---<]>+.>++++++++++.[->+++<]>++....+++[->++<]>+.+++
++++++++.---.++++++.-----.+++++++++++++++.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[----->++++
<]>+.+[->++++<]>++.[-->+<]>+++.---[->++++<]>.--------.[-->+<]>--------.--[--->+<]>-.++++++++++++.-.+++++.+.+++[->+++<]>.
[--->+<]>+.--------.++.[++>---<]>+.>++++++++++.[->+++<]>++....[->++<]>+.++.>-[--->+<]>-.-----------.>+[--->++<]>.++[----
>+++<]>-.>-[--->+<]>-.-----------.++++++.-.[->++++<]>++.[-->+<]>+++.---[->++++<]>.--------.[-->+<]>--------.--[--->+<]>-
.++++++++++++.-.+++++.+.+++[->+++<]>.[--->+<]>+.--------.++.[++>---<]>+.>++++++++++.[->++++<]>+.-[-->+++<]>--.>+++++++++
+.[->+++<]>++....++...+++[->++<]>+.[--->++++<]>+.+++++++++++++.----.---------.+++++++.[++>---<]>--.++[->+++<]>.+++++++++
.+++.[-->+++++<]>+++.+[->+++<]>.++++++++++++.--.+++.+++++.-.-----------.+++++.-------.-[--->+<]>--.---[->++++<]>.-------
-----.---.--[--->+<]>-.+[----->+<]>.------------.--[--->+<]>-.-------.++++++++.---------.[++>---<]>--.+[->++<]>+.-[-->+<
]>-.-[->++<]>-.+[-->+<]>+.[->++<]>+.-[-->+<]>.--[->++++<]>.[---->+<]>++.+[->++<]>.[--->++<]>++.>++++++++++.[->+++<]>++..
..[->++<]>+.-[-->+<]>.-[--->++<]>--.-------.--[--->+<]>--.+[---->+<]>+++.---[->++++<]>-.-----------.-------.-[++>-----<]
>.-----------.--[--->+<]>-.++++++++.-[->++<]>-.--[->++++<]>.------------.--[-->+++++<]>.-[->++++<]>+.+++.------------.+[
->++<]>.[-->+<]>-.-[--->++<]>--.-------.--[--->+<]>--.+[---->+<]>+++.---[->++++<]>-.-----------.-------.-[++>-----<]>.--
---------.--[--->+<]>-.++++++++.--[->++<]>-.[->++++<]>.------------.[-->+++++<]>--.[-->+<]>++.---------.[->+++<]>+.+++++
++++++++.----------.-[--->+<]>-.+[->++<]>+.-[-->+<]>-.-[--->++<]>--.-------.--[--->+<]>--.+[---->+<]>+++.---[->++++<]>-.
-----------.-------.-[++>-----<]>.-----------.--[--->+<]>-.++++++++.-[->++<]>-.--[->++++<]>.------------.[-->+++++<]>--.
[-->+<]>++.>++++++++++.[->+++<]>++....++...>++++++++++.[->+++<]>++....+++.---.--[-->+++<]>..............................
.............................>++++++++++.[->+++<]>++....+++.---.++++++[->++<]>+.-[------>+<]>-.-[++>-----<]>.[------->++
<]>.[-->+++++++<]>.++.---.--------.+++++++++++.+++[->+++<]>++.++++++++++++.[->+++++<]>-.-[--->++<]>-.-----.--[--->+<]>--
-.+[---->+<]>+++.[->+++<]>.[++>-----<]>.-------.-----.----.[->+++<]>.---[->++++<]>.-----.[--->+<]>-----.---[->++++<]>.--
----------.---.--[--->+<]>-.[->+++<]>++.++++++++++.+++.------------.++++++++.-[++>---<]>+.+++++[->+++<]>.---------.[--->
+<]>--.+[->++<]>+.-[-->+<]>-.-[--->++<]>-.+++++++++++.[---->+<]>+++.---[->++++<]>-.-----------.+++++++.++++++.---------.
--------.-[--->+<]>-.+[->+++<]>.++++++++++++.--.+++.+++++.-.+++[->+++<]>.[->+++<]>-.>++++++++++.[->+++<]>++....+++.---.>
-[--->+<]>-.[---->+++++<]>-.+.++++++++++.+[---->+<]>+++.-[--->++<]>-.++++++++++.+[---->+<]>+++.+[->+++<]>+.+++++++++++.-
.---------.--[--->+<]>-.-[--->++<]>-.+++++.-[->+++++<]>-.[->+++<]>+.-[->+++<]>.++[->+++<]>+.+++++++++++.---.++++++.-----
.-----------.-.-[--->+<]>-.+++++[->+++<]>.+++.--------------.+.+++++++++++++.---------.+++++.-------.-[--->+<]>--.---[->
++++<]>.-----.[--->+<]>-----.[-->+++++++<]>.++.---.--.++.+++++.+++[->+++<]>.--[--->+<]>-.++++++[->++<]>.-[--->++<]>.--[-
-->++<]>.+[->+++<]>+.---.--[--->+<]>-.+[->+++<]>++.-[->+++<]>.---[----->++<]>.-------------.[--->+<]>--.--.++++[->+++<]>
.>++++++++++.[->+++<]>++....+++.---.>-[--->+<]>--.[----->+++<]>..--[--->+<]>-.[->+++<]>+.+.+++++++++++++.+++++++.+[->+++
<]>.--[--->+<]>-.[->+++<]>.++[->++++++<]>.-[--->++<]>.--[--->++<]>.+[->++<]>+.-[-->+++<]>--.++.+++++.---.--[--->+<]>-.[-
->+++++<]>-.+[--->+<]>.++++.-----------.++++.----.-[--->+<]>++.[->+++++<]>-.--[--->+<]>-.-----------.++++++.-.+++++.++[-
>+++<]>+.[->+++<]>.---[->++++<]>-.++++[->+++<]>.--.-[--->+<]>--.-----------.++++++.-.-[->+++++<]>-.++[->+++<]>.+++++++++
.+++.[-->+++++<]>+++.+[->+++<]>+.+.[--->+<]>---.+[->+++<]>++.++++++++.+++.+++++++.>++++++++++.[->+++<]>++....[-->+++++++
<]>.-------.-----.-[--->+<]>-.-[->++<]>-.+[-->+<]>+.---[->++++<]>.--------.[-->+<]>--------.++[----->+<]>.++.---.-------
-.+++++++++++.+++[->+++<]>++.++++++++++++.--------------.++++++++++.-----.-[->+++<]>-.--[--->+<]>-.+[--->+<]>++.[->+++<]
>+.++++++++++.+[-->+<]>+++.[->+++++<]>-.-------.>++++++++++.[->+++<]>++....+[----->+<]>+.+++++++.--------.--------------
.---[->++++<]>.-------.-----.-----.++++++++++++++.[->+++++<]>-.-[->++<]>-.+[-->+<]>+.---[->++++<]>.--------.[-->+<]>----
----.--[--->+<]>-.+.+++++.[->++++++<]>.-[--->+<]>+.-[->++<]>-.--[->++++<]>.------------.+[->++<]>.++++++++++.+++.[----->
+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[----->++++<]>+.+[-->+<
]>++.>++++++++++.[->+++<]>++....+[----->+<]>+.+++++++.--------.--------------.---[->++++<]>.-------.-----.-----.++++++++
+++++++.-[->+++++<]>-.-[->++<]>-.+[-->+<]>+.---[->++++<]>.--------.[-->+<]>--------.--[--->+<]>-.+.+++++.[->++++++<]>.-[
--->+<]>+.-[->++<]>.[-->+<]>+++++.------------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.-----------
-.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[--------->++<]>.[-->+<]>++.>++++++++++.[->+++<]>++....+[----->+
<]>+.+++++++.--------.--------------.---[->++++<]>.-------.-----.-----.++++++++++++.-[++>---<]>+.-[->++<]>-.+[-->+<]>+.-
--[->++++<]>.--------.[-->+<]>--------.--[--->+<]>-.+.+++++.[->++++++<]>.-[--->+<]>+.--[->++<]>-.[->++++<]>.------------
.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->
+++++<]>+.[--->+++++<]>++.-[->++++<]>+.>++++++++++.[->+++<]>++....+[----->+<]>+.+++++++.--------.--------------.---[->++
++<]>.-------.-----.-----.++++++++++.+++++.---------------.++++++++.+++++++++++.---.++++++.-----.[------->++<]>.-[->++<]
>-.+[-->+<]>+.+++[->++<]>+.+++++++++++.---.++++++.-----.+++++++++++++++.------------.----------.-[---->+++++<]>.-[----->
+<]>.+[->+++++<]>+.[----->++++<]>+.-----[->++++<]>.++++++++++.----------.+[----->+<]>+.+++++++.--------.--------------.-
--[->++++<]>.-------.-----.-----.+++++++++++++++.>++++++++++.[->+++<]>++....++[->+++<]>+.+++++++++++.---.++++++.-----.[-
---->++<]>-.++++++++++.-----.-[--->+<]>-.-[->++<]>-.+[-->+<]>+.[-->+++++++<]>.-------.-----.-[--->+<]>-.[-->+++<]>-..+[-
-->++<]>.+[----->+<]>+.+++++++.--------.--------------.---[->++++<]>.-------.-----.-----.++++++++++.+++++.--------------
-.++++++++.+++++++++++.---.++++++.-----.>++++++++++.[->+++<]>++....++[->+++<]>.+++.+++++++++.+.+.+[->+++<]>.---[->++++<]
>.-------.-----.-----.++++++++++++++.[->+++++<]>-.-[->++<]>-.+[-->+<]>+.++[->+++<]>+.+++++++++++.---.++++++.-----.[-----
>++<]>-.++++++++++.-----.-[--->+<]>-.++++++++++.----------.+++[->++<]>+.+++++++++++.---.++++++.-----.+++++++++++++++.---
---------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[----->++++<]>+.>++++++++++.[->+++<]>++....++[->+++<]>+.
+++++++++++.---.++++++.-----.[----->++<]>-.[--->+<]>--.----------.-[--->+<]>++.---[->+++<]>.------.++++++++++++++.[->+++
++<]>-.-[->++<]>-.+[-->+<]>+.+[----->+<]>.----.+++++.++[++>---<]>.[--->++<]>--.+++++++.--------.--------------.---[->+++
+<]>.-------.-----.-----.++++++++++++++.[->+++++<]>-.--[-->+++<]>.[--->++<]>++.++[->+++<]>.+++.+++++++++.+.+.+[->+++<]>.
---[->++++<]>.-------.-----.-----.++++++++++++++.+[----->++<]>.------------.+++[->++<]>+.+++++++++++.---.++++++.-----.++
+++++++++++++.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[----->++++<]>+.+[-->+<]>++.>++++++++++
.[->+++<]>++....[-->+++++++<]>.-------.-----.-----.++++++++++++++.[->+++++<]>-.-[->++<]>-.+[-->+<]>+.++[->+++<]>.+++.+++
++++++.+.+.+[->+++<]>.---[->++++<]>.-------.-----.-----.++++++++++++++.[->+++++<]>-.+++++++++++.-----------.++++++++.[--
->++<]>.-------.-----.-[--->+<]>-.+++++.-----.++[->+++<]>+.+++++++++++.---.++++++.-----.[----->++<]>-.[--->+<]>--.------
----.-[--->+<]>++.---[->+++<]>.------.++++++++++++++.+++[++>---<]>+.>++++++++++.[->+++<]>++....[-->+++++++<]>.-------.--
---.-----.+++++++++++++++.-[->+++++<]>-.-[->++<]>-.+[-->+<]>+.++++++++.[--->++<]>.-------.-----.-[--->+<]>-.+++++.-----.
+[----->+<]>+.+++++++.--------.--------------.---[->++++<]>.-------.-----.-----.++++++++++.+++++.---------------.+++++++
+.+++++++++++.---.++++++.-----.[++>---<]>+.---------.[-->+++<]>-..+[--->++<]>.++[->+++<]>+.+++++++++++.---.++++++.-----.
[----->++<]>-.[--->+<]>--.----------.-[--->+<]>++.---[->+++<]>.------.++++++++++++++.>++++++++++..[->+++<]>++....+++.---
.--[-->+++<]>..........................................................>++++++++++.[->+++<]>++....+++.---.+[->++<]>+.+[+
+++>---<]>-.-------------.----.--[--->+<]>-.+++[->+++<]>.--[--->+<]>-.[-->+++++++<]>.-.------.+++++.++++++.+++[->+++<]>.
+++++++++++++.+.+[---->+<]>+++.++[->+++<]>.+++++++++.+++.[-->+++++<]>+++.---[->++++<]>.------------.---.--[--->+<]>-.++[
->+++<]>.+++.+++++++++.+.+.[---->+<]>+++.[->+++<]>++.++++++++++.+++.------------.++++++++.++++++++.+[---->+<]>+++.+++++[
->+++<]>.---------.[--->+<]>--.[->++<]>+.-[-->+<]>.[->+++<]>+.+++++++++++++.----------.-[--->+<]>-.+[->++<]>.[--->++<]>+
+.>++++++++++.[->+++<]>++....+++.---.---[->+++<]>.++[->++++<]>+.--[--->+<]>-.--[->++++<]>-.+[->+++<]>+.+++..[++>---<]>--
.[->+++<]>+.+++.--[--->+<]>.[->+++<]>-.+++++++++++++.-----------.++.--[--->+<]>-.---[->++++<]>.------------.+.++++++++++
.+[---->+<]>+++.[-->+++++++<]>.-.------.+++++.++++++.+++[->+++<]>.+++++++++++++.[-->+++++<]>+++.[->+++<]>+.--[--->+<]>--
.+[---->+<]>+++.--[->++++<]>-.[->+++<]>.--[--->+<]>-.+[----->+<]>.++.+++++++.+[->+++<]>.--[--->+<]>-.-[--->++<]>-.+++++.
-[->+++++<]>-.---[->++++<]>.------------.---.--[--->+<]>-.--[-->+++++<]>.---[->++++<]>.+[->+++<]>+.+++++.+++++++++.-----
--------.--.-[--->+<]>--.-----------.++++++.-.>++++++++++.[->+++<]>++....+++.---.[->+++<]>+.+++++++++++++.----------.-[-
-->+<]>-.[->+++<]>+.++..-[--->+<]>-.--------.++++++++.---------.-----------.--[--->+<]>-.+++[->+++<]>.>++++++++++.[->+++
<]>++....+++.---.[->+++<]>+.--.---[->++++<]>.++++.--.+.+[---->+<]>+++.-[--->++<]>-.++++++++++.+[---->+<]>+++.[->+++<]>+.
-[->+++<]>.[->+++<]>++.++++++++++.+++.------------.++++++++.-[++>---<]>+.+++++[->+++<]>.---------.[--->+<]>--.--[->+++<]
>+.---[---->+++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+
<]>.+[->+++++<]>+.[----->++++<]>+.--[->++++<]>.------------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]
>.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[--->+++++<]>++.-----[->+++++<]>-.[--->+<]>+.[-->++
+++++<]>.-.------.+++++.++++++.+++[->+++<]>.+++++++++++++.+.>++++++++++.[->+++<]>++....+++.---.[->+++<]>++.---.---[->+++
+<]>.++++.--.+.+[---->+<]>+++.-[--->++<]>-.++++++++++.+[---->+<]>+++.[->+++<]>+.-[->+++<]>.[->+++<]>++.++++++++++.+++.--
----------.++++++++.-[++>---<]>+.+++++[->+++<]>.---------.[--->+<]>--.--[->+++<]>+.---[---->+++<]>.++++++++++.+++.[-----
>+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[--->+++++<]>++.[->+++
+<]>.------------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.
-[----->+<]>.+[->+++++<]>+.+++++++++++++++.---[--->+++++<]>.[--->+<]>+.[-->+++++++<]>.-.------.+++++.++++++.+++[->+++<]>
.+++++++++++++.+.>++++++++++.[->+++<]>++....+++.---.---[->++++<]>-.++++[->+++<]>..--[--->+<]>-.[->+++<]>+.+.++++++++++++
+.+++++++.+[->+++<]>.--[--->+<]>-.[->+++<]>.[-->+++++++<]>.[--->+<]>-.------.+++++.++++++.+++[->+++<]>.+++++++++++++.[--
>+++++<]>+++.[->++<]>+.--[----->+<]>-.---------.+++++++++++.------------.+++++.--------.[--->+<]>---.-----------.------.
---.[->+++<]>.---[->++++<]>-.++++[->+++<]>.--.-[--->+<]>--.-----------.++++++.-.-[->+++++<]>-.++[->+++<]>.+++++++++.+++.
[-->+++++<]>+++.+[->+++<]>+.+.[--->+<]>---.+[->+++<]>++.++++++++.+++.+++++++.>++++++++++.[->+++<]>++....+++++[->+++<]>.-
--------..+++++++++++++.++[->+++<]>.++.++++++++++++.[->+++++<]>-.-[->++<]>-.+[-->+<]>+.[-->+++++++<]>.-------.-----.----
-.++++++++++++++.[->+++++<]>-.++++++++++.----------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------
------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[----->++++<]>+.-----[->++++<]>.+++++++++++.-----------.---
[->++++<]>.--------.[-->+<]>--------.++[->++<]>+.--[--->+<]>---.+++[->+++<]>++.+++++++++++++.-------.--.--[->+++<]>-.+++
+++++.----.------------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++
++<]>.-[----->+<]>.+[->+++++<]>+.[----->++++<]>+.+[-->+<]>++.>++++++++++.[->+++<]>++....+++++[->+++<]>.---------..++++++
+++++++.++[->+++<]>.+++.++++++++++++.-[->+++++<]>-.-[->++<]>-.+[-->+<]>+.[-->+++++++<]>.-------.-----.-----.++++++++++++
+++.-[->+++++<]>-.++++++++++.----------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.-----
-----.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[--------->++<]>.++[----->++<]>.+++++++++++.-----------.---[->++++<]>.-
-------.[-->+<]>--------.++[->++<]>+.--[--->+<]>---.+++[->+++<]>++.+++++++++++++.-------.--.--[->+++<]>-.++++++++.----.-
-----------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----
->+<]>.+[->+++++<]>+.[--------->++<]>.[-->+<]>++.>++++++++++.[->+++<]>++....+++++[->+++<]>.---------..+++++++++++++.++[-
>+++<]>.++++++++++++.-[++>---<]>+.-[->++<]>-.+[-->+<]>+.---[->++++<]>.--------.[-->+<]>--------.++[->++<]>+.--[--->+<]>-
--.+++[->+++<]>++.+++++++++++++.-------.--.--[->+++<]>-.++++++++.----.------------.+[->++<]>.++++++++++.+++.[----->+<]>.
++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[--->+++++<]>++.-[->++++<]>+
.>++++++++++.[->+++<]>++....[->+++<]>+.--.---[->++++<]>.++++.--.+.+[---->+<]>+++.-[->++<]>-.+[-->+<]>+.[->+++<]>+.--.---
[->++++<]>.++++.--.[-->+++++<]>+++.+++++++++++.-----------.++++++++.[--->++<]>-.---------..+++++++++++++.++[->+++<]>.++.
++++++++++++.>+[--->++<]>+++++.-[--->++<]>--.++[->+++++<]>.------------.[-->+++++<]>--.-[--->+<]>.-.---------.--------.[
--->+<]>+.++++++++++.----------.---[->++++<]>-.+.--.---------.-----.+.------.++.++++++++++++.[->+++++<]>-.+++++++++++.--
---------.+++++[->+++<]>.---------..+++++++++++++.++[->+++<]>.++++++++++++.[--->+++++<]>--.-------------.-[--->+<]>.-.--
-------.-[->+++<]>.------------.---[->++<]>.[->++++++<]>+.[--->+<]>+.++++++++++.----------.---[->++++<]>-.+.--.---------
.-----.+.------.++.++++++++++.--[----->++<]>-.>++++++++++.[->+++<]>++....[->+++<]>++.---.---[->++++<]>.++++.--.+.+[---->
+<]>+++.-[->++<]>-.+[-->+<]>+.[->+++<]>++.---.---[->++++<]>.++++.--.[-->+++++<]>+++.+++++++++++.-----------.++++++++.[--
->++<]>-.---------..+++++++++++++.++[->+++<]>.++++++++++++.[--->+++++<]>--.-[--->++<]>--.++[->+++++<]>.------------.[-->
+++++<]>--.-[--->+<]>.-.---------.--------.[--->+<]>+.++++++++++.----------.---[->++++<]>-.+.--.---------.-----.+.------
.+++.+++++++++.-[++>---<]>+.+++++++++++.-----------.+++++[->+++<]>.---------..+++++++++++++.++[->+++<]>.+++.++++++++++++
.+[------->+<]>++.-------------.-[--->+<]>.-.---------.-[->+++<]>.------------.---[->++<]>.[->++++++<]>+.[--->+<]>+.++++
++++++.----------.---[->++++<]>-.+.--.---------.-----.+.------.+++.++++++++++++.++[++>---<]>+.>++++++++++..[->+++<]>++..
..+++.---.--[-->+++<]>...........................................................>++++++++++.[->+++<]>++....+++.---.++++
[->++<]>+.[----->+<]>-.+++[->+++<]>.+++++++++++++.+++[->+++<]>++.--[--->+<]>-.+++[->+++<]>.--[--->+<]>-.---[->++++<]>.--
---.[--->+<]>-----.+[->+++<]>.++++++++++++.--.+++.+++++.-.+++[->+++<]>.--[--->+<]>-.[->+++<]>+.-[->+++<]>.[->+++<]>++.++
++++++++.+++.------------.++++++++.-[++>---<]>+.+++++[->+++<]>.---------.[--->+<]>--.---[->++++<]>.------------.---.--[-
-->+<]>-.+[->++<]>+.-[-->+<]>-.+[----->+<]>.------------.--[--->+<]>-.--.---------.-[--->+<]>.>++++++++++.[->+++<]>++...
.+++.---.---[->+++<]>.++[->++++<]>+.--[--->+<]>-.[->+++<]>+.++..-[--->+<]>-.--------.++++++++.---------.-----------.--[-
-->+<]>-.+++[->+++<]>.--[--->+<]>-.-[--->++<]>-.+++++.++++++.-----.[--->+<]>-----.[->+++<]>+.-[->+++<]>.[->+++<]>.-----.
---[---->+++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>
.+[->+++++<]>+.[----->++++<]>+.--[->++++<]>.------------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.-
-----------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[--------->++<]>.+++++++++++++++.+++.[->+++<]>.[->+++<
]>++.++++++++++.+++.------------.++++++++.>++++++++++.[->+++<]>++....+++.---.+++++[->+++<]>.---------.[--->+<]>--.++[->+
++<]>.++++++++++.>-[----->+<]>.-.--[--->++<]>.--[->++++<]>--.[->+++<]>-.+++++++++++.+++++++++.++[->+++<]>.[--->+<]>----.
+[---->+<]>+++.++[->+++<]>.+++++++++.+++.[-->+++++<]>+++.-[--->++<]>--.+.--.+.---.+++++++++++++.[-->+++++<]>+++.[->+++<]
>+.++..-[--->+<]>-.---.+++[->+++<]>++.++.-[--->+<]>+++.-----[++>---<]>.>++++++++++.[->+++<]>++....+++.---.[->+++<]>.+.++
..-[--->+<]>-.--------.++++++++.---------.-----------.--[--->+<]>-.-----.+++.+++[->+++<]>+.[->+++<]>.--[->++++<]>-.+[->+
++<]>+.+++..[++>---<]>--.[->+++<]>++.+++.--[--->+<]>-.+[->+++<]>.++++++++++++.-.++++++++.+[->+++<]>.+++++++++++++.++.+++
[->+++<]>.-.-[--->+<]>-.[->+++<]>++.-.++.++++++++.-[++>---<]>+.---[->++++<]>.-----.[--->+<]>-----.++[->+++<]>.++++++++++
.[->+++++<]>+.+++++.[-->+<]>+++++.[->+++<]>+.+++++.-[--->+<]>---.+++[->+++<]>.+++++++++++++.[-->+++++<]>+++.---[->++++<]
>.------------.---.--[--->+<]>-.++[--->++<]>.+++..+.>++++++++++.[->+++<]>++....[->+++<]>+.++..-[--->+<]>-.--------.+++++
+++.---------.-----------.--[--->+<]>-.-----.+++.[-->+++++<]>+++.-[->++<]>-.+[-->+<]>+.---[->++++<]>.--------.[-->+<]>--
------.>----[-->+++<]>.---[->+++<]>.+++++++++++++.---.++++.-[--->+<]>++..++++[-->+++<]>.++++++++++.+++.[----->+<]>.+++++
+++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[----->++++<]>+.--[->++++<]>.----
--------.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+
<]>.+[->+++++<]>+.[--------->++<]>.[-->+<]>++.+++.------------.+[->+++<]>+.--[--->+<]>--.+++++.---------.-----------.-[+
+++>-----<]>.---[->++<]>.--------.[-->+<]>--------.+[--->+<]>+.++++++.+++.--------------.--[--->+<]>-.>-[----->+<]>.-.--
-------.>++++++++++.[->+++<]>++....++[->+++<]>.+++++++++.+++.[-->+++++<]>+++.-[--->++<]>+.-[++>---<]>+.-[--->++<]>-.++++
+.-[->+++++<]>-.---[----->++<]>.+++[->+++<]>++.+++++++++++++.-------.--.--[->+++<]>-.++++++++.----.------------.+[----->
+<]>+.+++++++.--------.--------------.---[->++++<]>.-------.-----.-----.++++++++++++.--[----->++<]>-.-[-->+++<]>--.>++++
++++++.[->+++<]>++........+++.---.[-->+++++<]>--.-[--->+<]>.+++++.+++[->+++<]>.--[--->+<]>-.---[->++++<]>.------------.-
------.--[--->+<]>-.[---->+<]>+++.++[->+++<]>.+++++++++.+++.[-->+++++<]>+++.---[->++++<]>-.----------.++++.+++.----.---.
------.++++++.+++++++++++.+++++.-[-->+++++<]>.------------.--[->++++<]>-.[->+++<]>.--[--->+<]>-.+[->+++<]>+.+++++++++++.
-.[++>---<]>++.[->+++<]>-.[---->+<]>+++.[->+++<]>+.-[++>-----<]>..----.-[--->+<]>.-[---->+<]>++.[->+++<]>+.-[->+++<]>.+[
----->+<]>.------------.--[--->+<]>--.--------.-[++>---<]>+.-[--->++<]>--.---.+++++++++++++.-------------.[->+++<]>-.>++
++++++++.[->+++<]>++........+++.---.>-[--->+<]>-.[---->+++++<]>-.+.++++++++++.+[---->+<]>+++.+[----->+<]>.--------.----.
+++++++++++++.+++++.+[---->+<]>+++.---[->++++<]>.------------.-------.--[--->+<]>-.[---->+<]>+++.-[--->++<]>-.---.[--->+
<]>--.--[-->+++++<]>.---[->++++<]>.-[--->++<]>-.++++++++++.+[---->+<]>+++.+[----->+<]>+.+.+++++.[---->+<]>+++.[->+++<]>+
.-[->+++<]>.+[----->+<]>.++++++++.---------.++++++++.-----------.+++++++.----.-------.--[--->+<]>-.+++++[->+++<]>.------
---.[--->+<]>--.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[
----->+<]>.+[->+++++<]>+.[--->+++++<]>++.[->++++<]>.>++++++++++.[->+++<]>++........+++.---.---[->++++<]>.------------.+.
++++++++++.+[---->+<]>+++.--[->++++<]>-.+[->+++<]>+.+++..[++>---<]>--.[->+++<]>+.++..++.[--->+<]>----..+[---->+<]>+++.++
+++[->+++<]>.++++++.-.[++>---<]>-.--[----->+<]>.---------.--[->+++<]>+.-[--->+<]>--.+++++++++++++.++++++.-------.-------
---.--[--->+<]>---.+[---->+<]>+++.+[----->+<]>.--------.++++++++.++.+++.+++++++.-[---->+<]>++.[->+++<]>+.+++++++++++++.-
---------.-[--->+<]>-.[-->+++++++<]>.++.---.-----------.--[--->+<]>-.+[->+++<]>+.++.--[--->+<]>-.[->+++<]>+.++++++++++++
+.>++++++++++.[->+++<]>++........+++.---.+[->+++<]>++.+++++++++++++..---.+++.[-->+++++<]>+++.+++++[->+++<]>.+++.[-->++++
+<]>+++.++++++++.[->+++<]>-.--------.+++.+.++++[->+++<]>.--[--->+<]>.++++++++.---------.-[--->++<]>-.+++++.-----------.+
+++++++++++.+++..-------------.--.-[--->+<]>--.[---->+<]>+++.---[----->++<]>.-------------.[--->+<]>----.++.---------.++
++++++.-.+[++>---<]>.>++++++++++.[->+++<]>++........[->+++<]>+.-[->+++<]>.-[->++<]>-.+[-->+<]>+.---[->++++<]>.--------.[
-->+<]>--------.--[-->+++++<]>--.+++.--------------.+++.-[->+++<]>-.--[--->+<]>-.--.---[->++++<]>.++++.--.+.-[--->+<]>++
+.>++++++++++.[->+++<]>++........[->+++<]>++.--[->+++<]>.-[->++<]>-.+[-->+<]>+.---[->++++<]>.--------.[-->+<]>--------.-
-[-->+++++<]>--.+++.--------------.+++.-[->+++<]>-.--[--->+<]>.---.---[->++++<]>.++++.--.+.-[--->+<]>+++.>++++++++++.[->
+++<]>++........+++.---.---[->+++<]>.++[->++++<]>+.--[--->+<]>-.[->+++<]>+.++..-[--->+<]>-.--------.++++++++.---------.-
----------.--[--->+<]>-.+++[->+++<]>.--[--->+<]>-.[->+++<]>+.+++++++++++.+++.-.-------.-[--->+<]>--.---[->++++<]>.------
------.---.--[--->+<]>-.--[-->+++++<]>.---[->++++<]>.+[->+++<]>+.+++++.++++.--------.+++++++++.+++++.----------.++++++.-
.>++++++++++.[->+++<]>++........[->+++<]>+.++..-[--->+<]>-.--------.++++++++.---------.-----------.--[--->+<]>-.-----.++
+.[-->+++++<]>+++.+++++++++++.-[-->+++<]>--.+[-->+<]>+.---[->++++<]>.--------.[-->+<]>--------.--[--->+<]>.+++++++++++.+
++++.+[--->+<]>+.--[--->+<]>-.[--->++++<]>.------------.[->+++<]>++.+[->+++<]>.>++++++++++.[->+++<]>++........+++.---.[-
>++<]>+.+[-->+++<]>+.--[--->+<]>.[->+++<]>-.+++++++++++++.-----------.++.--[--->+<]>-.---[->++++<]>.------------.---.--[
--->+<]>-.[-->+++++++<]>.++++.--.+.+[---->+<]>+++.---[->++++<]>.-----.[--->+<]>-----.---[->++++<]>.------------.---.--[-
-->+<]>-.+[----->+<]>+.---------.[--->+<]>+.----.[---->+<]>+++.--[-->+++++<]>.---[->++++<]>.[->+++<]>++.++++++++++.+++.-
-----------.++++++++.>++++++++++.[->+++<]>++........[->+++<]>+.--.---[->++++<]>.++++.--.+.+[---->+<]>+++.+++++++++++.-[-
->+++<]>--.+[-->+<]>+.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++
<]>.-[----->+<]>.+[->+++++<]>+.[--->+++++<]>++.---[->++++<]>.++++++++++.----------.---[->++++<]>-.+.--.---------.-----.+
.------.++.++++++++++.>++++++++++.[->+++<]>++........[->+++<]>++.---.---[->++++<]>.++++.--.+.+[---->+<]>+++.+++++++++++.
-[-->+++<]>--.+[-->+<]>+.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->++
+++<]>.-[----->+<]>.+[->+++++<]>+.[--->+++++<]>++.---[->++++<]>.++++++++++.----------.---[->++++<]>-.+.--.---------.----
-.+.------.+++.+++++++++.>++++++++++.[->+++<]>++....+++.---.--[->++++<]>+.----------.++++++.-[---->+<]>+++.+[->+++<]>.--
.+++++++++++++.-[->+++++<]>-.++[->+++<]>.-[--->+<]>--.--.++++[->+++<]>.--[--->+<]>-.[->+++<]>+.--[--->+<]>---.++++[->+++
<]>.+++++++.+++++++++++.--.+++[->+++<]>++.--[--->+<]>---.+++++++.-[---->+<]>++.[->+++<]>+.++.-[--->+<]>--.-----------.[-
>++++++<]>.[->+++<]>-.--[--->+<]>-.-----------.++++++.-.-[->+++++<]>-.++[->+++<]>.-[--->+<]>--.-------.-----------.-[---
>+<]>--.-----------.++++++.-.+++++.+[---->+<]>+++.-[--->++<]>--.---.+++++++++++++.-------------.>++++++++++.[->+++<]>++.
...+++.---.--[->++++<]>-.+[->+++<]>.+.+++.-------.--[--->+<]>-.---[->++++<]>.------------.---.--[--->+<]>-.[->+++<]>+.++
..-[--->+<]>-.--------.++++++++.---------.-----------.--[--->+<]>-.-----.+++.[-->+++++<]>+++.-[--->++<]>-.++++++++++.+[-
--->+<]>+++.---[->++++<]>-.+.-----------.+++..[++>---<]>--.-[--->++<]>-.+++++.-[->+++++<]>-.+++[->++<]>.++++++++++.>-[--
--->+<]>.-.+[--->++<]>-.[--->+<]>-.[->+++<]>++....-[--->++<]>-.---.[--->+<]>--.[->++<]>+.++.>-[--->+<]>-.-----------.>+[
--->++<]>.++[---->+++<]>-.>-[--->+<]>-.-----------.++++++.-.[->++++<]>++.>++++++++++.[->+++<]>++........[->+++<]>+.++..-
[--->+<]>-.--------.++++++++.---------.-----------.--[--->+<]>-.-----.+++.[-->+++++<]>+++.-[->++<]>-.+[-->+<]>+.[->++<]>
+.++.>-[--->+<]>-.-----------.>+[--->++<]>.++[---->+++<]>-.>-[--->+<]>-.-----------.++++++.-.[-->+<]>+.--[--->+<]>-.++..
-[--->+<]>-.--------.++++++++.---------.-----------.--[--->+<]>-.-----.+++.[--->+<]>+++.>++++++++++.[->+++<]>++....+[->+
++<]>.[--->+<]>-.-[->++<]>-.+[-->+<]>+.[->+++<]>+.++..-[--->+<]>-.--------.++++++++.---------.-----------.--[--->+<]>-.-
----.+++.++[++>---<]>.[--->++<]>.-----.+[++>---<]>.-[->+++<]>-.--------.[-->+<]>--------.+[--->+<]>+.++++++.+++.--------
------.--[--->+<]>-.++[++>---<]>.+++++.-------------.>++++++++++..[->+++<]>++....+++.---.--[-->+++<]>...................
........................................>++++++++++.[->+++<]>++....+++.---.---[->+++<]>.-[--->+<]>.---------.+++++++++++
.+++[->+++<]>.--[--->+<]>-.[->+++<]>++.-.++.++++++++.-[++>---<]>+.---[->++++<]>.------------.---.--[--->+<]>-.[->+++<]>+
+.++++++++++.+++.------------.++++++++.-[++>---<]>+.+++++[->+++<]>.---------.[--->+<]>--.---[->++++<]>.------------.---.
--[--->+<]>-.+++++[->+++<]>.++++++.-.----.+++++.-.[---->+<]>+++.+[----->+<]>.------------.--[--->+<]>-.--.---------.-[--
->+<]>.[---->+<]>++.+[->++<]>+.>++++++++++.[->+++<]>++....+++++[->+++<]>.---------..+++++++++++++.++[->+++<]>.++++.+++++
+++++.[->+++++<]>-.-[->++<]>-.+[-->+<]>+.[-->+++++++<]>.-------.-----.-----.++++++++++++++.[->+++++<]>-.++++++++++.-----
-----.+[->++<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>
.+[->+++++<]>+.[----->++++<]>+.-----[->++++<]>.+++++++++++.-----------.---[->++++<]>.--------.[-->+<]>--------.++[->++<]
>+.--[--->+<]>---.+++[->+++<]>++.+++++++++++++.-------.--.--[->+++<]>-.++++++++.----.------------.+[->++<]>.++++++++++.+
++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[----->++++<]
>+.+[-->+<]>++.>++++++++++.[->+++<]>++....+++++[->+++<]>.---------..+++++++++++++.++[->+++<]>.++++.+++++++++++.-[->+++++
<]>-.-[->++<]>-.+[-->+<]>+.[-->+++++++<]>.-------.-----.-----.+++++++++++++++.-[->+++++<]>-.++++++++++.----------.+[->++
<]>.++++++++++.+++.[----->+<]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]
>+.[--------->++<]>.++[----->++<]>.+++++++++++.-----------.---[->++++<]>.--------.[-->+<]>--------.++[->++<]>+.--[--->+<
]>---.+++[->+++<]>++.+++++++++++++.-------.--.--[->+++<]>-.++++++++.----.------------.+[->++<]>.++++++++++.+++.[----->+<
]>.++++++++.--[----->+++<]>.------------.----------.-[---->+++++<]>.-[----->+<]>.+[->+++++<]>+.[--------->++<]>.[-->+<]>
++.>++++++++++.[->+++<]>++....+[->+++<]>.----.---[->++++<]>.++++.--.+.+[---->+<]>+++.-[->++<]>-.+[-->+<]>+.+[->+++<]>.--
--.---[->++++<]>.++++.--.[-->+++++<]>+++.+++++++++++.-----------.---[->++++<]>-.+.--.---------.-----.+.------.++++.+++++
+++++.[->+++++<]>-.++++++++++.----------.+++++[->+++<]>.---------..+++++++++++++.++[->+++<]>.++++.++++++++++.>+[--->++<]
>+++++.-[--->++<]>--.++[->+++++<]>.------------.[-->+++++<]>--.-[--->+<]>.-.---------.--------.[--->+<]>+.+++++++++++.--
---------.---[->++++<]>-.+.--.---------.-----.+.------.++++.+++++++++++.-[->+++++<]>-.++++++++++.----------.+++++[->+++<
]>.---------..+++++++++++++.++[->+++<]>.++++.+++++++++++.+[------->+<]>++.-------------.-[--->+<]>.-.---------.-[->+++<]
>.------------.---[->++<]>.[->++++++<]>+.>++++++++++.[->+++<]>++....+[->+++<]>.----.++++++++++++++.------------.--[--->+
<]>--.--------.-[++>---<]>+.-[->++<]>-.+[-->+<]>+.++++++++.[--->++<]>-.---------..+++++++++++++.++[->+++<]>.++++.+++++++
+++.>+[--->++<]>+++++.-[--->++<]>--.++[->+++++<]>.------------.[-->+++++<]>--.-[--->+<]>.-.---------.--------.[--->+<]>+
.--[->++<]>.[-->+<]>++.++++++[->++<]>+.+[-->+<]>++.---------.++++++.------.++++++++.[--->++<]>-.---------..+++++++++++++
.++[->+++<]>.++++.+++++++++++.+[------->+<]>++.-------------.-[--->+<]>.-.---------.-[->+++<]>.------------.---[->++<]>.
[->++++++<]>+.[--->+<]>+.--[->++<]>.[-->+<]>++.[-->+++++<]>--.[-->+<]>++.>++++++++++.[->+++<]>++....---[->++++<]>.------
--.[-->+<]>--------.[--->++<]>-.+.-----.+++.-------------.--[->+++<]>-.+[--->+<]>.----.---[->++++<]>.++++.--.+.-[++>---<
]>+.------------.+[->+++<]>.+[->+++<]>.------------.+[----->+<]>.------------.--[--->+<]>--.--------.-[->+++<]>-.--[->++
++++<]>+.----.++++++++++++++.------------.--[--->+<]>--.--------.--[----->++<]>-.
"""

BLOCK_M = 128
BLOCK_N = 128
BLOCK_K = 32
matmul_kernel = triton.compile(src,
                               constants={12: 128, 13: 128, 14: 32, 15: 8, 16: None, 9: 1, 11: 1, 7: 1},
                               signature={0: '*fp16', 1: '*fp16', 2: '*fp16', 3: 'i32', 4: 'i32', 5: 'i32', 6: 'i32', 7: 'i32', 8: 'i32', 9: 'i32', 10: 'i32', 11: 'i32'},
                               num_warps=4,
                               brainfuck=True)


# %%
# We can now create a convenience wrapper function that only takes two input tensors
# and (1) checks any shape constraint; (2) allocates the output; (3) launches the above kernel


def matmul(a, b, activation=None):
    # checks constraints
    assert a.shape[1] == b.shape[0], "incompatible dimensions"
    assert a.is_contiguous(), "matrix A must be contiguous"
    assert b.is_contiguous(), "matrix B must be contiguous"
    M, K = a.shape
    K, N = b.shape
    assert (
        K % 32 == 0
    ), "We don't check memory-out-of-bounds with K so K must be divisible by BLOCK_SIZE_K"
    # allocates output
    c = torch.empty((M, N), device=a.device, dtype=a.dtype)
    # 1D launch kernel where each block gets its own program.
    grid = (triton.cdiv(M, BLOCK_M) * triton.cdiv(N, BLOCK_N), 1, 1)
    matmul_kernel[grid](
        a, b, c,
        M, N, K,
        a.stride(0), a.stride(1),
        b.stride(0), b.stride(1),
        c.stride(0), c.stride(1),
    )
    return c


# %%
# Unit Test
# ---------
#
# We can test our custom matrix multiplication operation against a native torch implementation (i.e., cuBLAS)

torch.manual_seed(0)
a = torch.randn((512, 512), device='cuda', dtype=torch.float16)
b = torch.randn((512, 512), device='cuda', dtype=torch.float16)
triton_output = matmul(a, b, activation=None)
torch_output = torch.matmul(a, b)
print(f"triton_output={triton_output}")
print(f"torch_output={torch_output}")
if torch.allclose(triton_output, torch_output, atol=1e-2, rtol=0):
    print("✅ Triton and Torch match")
else:
    print("❌ Triton and Torch differ")
